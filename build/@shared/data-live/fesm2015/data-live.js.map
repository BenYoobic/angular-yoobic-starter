{"version":3,"file":"data-live.js.map","sources":["ng://data-live/lib/interfaces/channel/channel.interface.ts","ng://data-live/lib/services/pubnub/pubnub.service.ts","ng://data-live/lib/services/channel/channel.service.ts","ng://data-live/lib/services/intercom/web-intercom.service.ts","ng://data-live/lib/services/intercom/intercom.service.ts","ng://data-live/lib/services/messages/messages.service.ts","ng://data-live/lib/services/track/track.service.ts","ng://data-live/lib/services/twilio-token/twilio-token.service.ts","ng://data-live/lib/services/video-call/video-call.service.ts","ng://data-live/lib/services/sentry-error-handler/sentry-error-handler.service.ts","ng://data-live/lib/data-live.module.ts","ng://data-live/lib/interfaces/channels/channels.interface.ts","ng://data-live/lib/interfaces/message/message.model.ts"],"sourcesContent":["import { Entity, IAcl, User, Model, Editable } from '@shared/data-core';\nimport { FormFieldType } from '@shared/stencil';\n\n@Model({\n  className: 'Channel',\n  collectionName: 'channel',\n  fields: null,\n  include: ['users'],\n  searchSubquery: { collectionName: 'user', field: 'usersRef', values: '_id' }\n})\nexport class Channel extends Entity {\n  // export class Channel implements IEntity {\n  _id: string;\n  _acl: IAcl;\n  _lmt?: string;\n  _ect?: string;\n\n  channel: string;\n  isSupport: boolean;\n  isFavorite: boolean;\n  isOnline: boolean;\n  //All Users in the Channel\n  @Editable('Channel', {\n    type: FormFieldType.autocomplete,\n    collectionName: 'user',\n    multiple: true,\n    subQuery: { field: 'usersRef', values: '_id', collectionName: 'user' },\n    subQueryOverride: { field: 'usersRef', values: '_id', collectionName: 'user' }\n  })\n  users: Array<User>;\n  //other Users than the logged in user\n  others: Array<User>;\n\n  lastMessage: any;\n  lastMessageAlternate: boolean;\n  lastMessageDate?: any;\n\n  deleteMessages: Array<any>;\n}\n","import { Injectable } from '@angular/core';\nimport { Log, CoreConfig } from '@shared/common';\nimport { Translate } from '@shared/translate';\nimport { User, Authentication, Session, Push } from '@shared/data-core';\n\nimport { ChatMessage as Message } from '../../interfaces/message/message.interface';\nimport { Channels } from '../../interfaces/channels/channels.interface';\nimport { IPubNub, PresenceEvent, MessageEvent, StatusEvent, ChannelState, HereNowResponse, UUIDState, GlobalState } from '../../interfaces/pubnub/pubnub.interface';\n\nimport { includes, isObject, pick, forEach, each, merge } from 'lodash-es';\n\nimport { Subscription, Observable, Subject, from, of } from 'rxjs';\nimport { filter, map } from 'rxjs/operators';\nimport Big from 'big.js';\n\ndeclare const PubNub: any;\n\n//import * as pubnubLib from 'pubnub/dist/web/pubnub';\n\nexport class PubnubSender {\n  id: string;\n  username: string;\n  image: string;\n  appTitle: string;\n\n  constructor(id, username, image, appTitle = 'YOOBIC') {\n    this.id = id;\n    this.username = username;\n    this.image = image;\n    this.appTitle = appTitle;\n  }\n}\n\n@Injectable()\nexport class Pubnub {\n  //private static _pubnub: any = null;\n\n  protected sender: PubnubSender;\n  protected onlineUsers = new Map<string, any>();\n\n  private _supportId = '53fb03c6546847ee0536386a';\n  private _mainChannel = 'yoobicchannel';\n  private _supportPrefix = 'support_';\n  private _groupPrefix = 'group_';\n  private _channels: {\n    [channel: string]: {\n      messages: Subject<Message>;\n      subscription: Subscription;\n      typing?: Subject<[string, boolean]>;\n    };\n  } = {};\n  private _presenceSubject = new Subject<PresenceEvent>();\n  private _messageSubject = new Subject<MessageEvent>();\n  private _statusSubject = new Subject<StatusEvent>();\n\n  private _parentSubscription = new Subscription();\n\n  private pubnub: IPubNub;\n\n  constructor(private authentication: Authentication, private session: Session, private translate: Translate, private log: Log, protected push: Push, private coreConfig: CoreConfig) {}\n\n  get supportId() {\n    return this._supportId;\n  }\n\n  changeState(channels: string[], state: ChannelState): Promise<ChannelState> {\n    return this.pubnub.setState({ uuid: this.sender.id, channels, state }).then(r => r.state);\n  }\n\n  setIsTyping(channel: string, isTyping: boolean): Promise<ChannelState> {\n    return this.changeState([channel], { isTyping: isTyping.toString() });\n  }\n\n  isOnline(userId: string): boolean {\n    return this.onlineUsers.has(userId);\n  }\n\n  isPresent(userId: string, channel = this._mainChannel): Promise<boolean> {\n    return this.pubnub\n      .whereNow({ uuid: userId })\n      .then(res => {\n        return includes(res.channels, channel);\n      })\n      .catch(err => {\n        // if we get an error, don't reject, just return false;\n        return false;\n      });\n  }\n\n  getChannelId(user1Id: string, user2Id: string) {\n    return user1Id < user2Id ? user1Id + '_' + user2Id : user2Id + '_' + user1Id;\n  }\n\n  getSupportChannelId(userId: string) {\n    return this._supportPrefix + this.supportId + '_' + userId;\n  }\n\n  isSupportChannel(channel) {\n    return channel.indexOf(this._supportPrefix) >= 0;\n  }\n\n  parseSupportChannel(channel) {\n    return channel.replace(this._supportPrefix, '').replace(this._supportId + '_', '');\n  }\n\n  getGroupChannelId(channelId) {\n    return this._groupPrefix + channelId;\n  }\n\n  isGroupChannel(channel) {\n    return channel.indexOf(this._groupPrefix) === 0;\n  }\n\n  parseGroupChannel(channel) {\n    return channel.replace(this._groupPrefix, '');\n  }\n\n  getHistory(channel: string, count = 10, start?: number): Observable<[Array<Message>, number, number]> {\n    if (!this.pubnub) {\n      return of(<any>[]);\n    }\n    return from(this.pubnub.history({ channel: channel, count: count, reverse: false, start: start })).pipe(\n      map(\n        ({ messages, startTimeToken, endTimeToken }): [Array<Message>, number, number] => {\n          return [messages.map(item => merge(item.entry, { timetoken: item.timetoken })), startTimeToken, endTimeToken];\n        }\n      )\n    );\n  }\n\n  deleteMessages(channel: string, timetokens: Array<number>) {\n    let promises = timetokens.map(timetoken => this.pubnub.deleteMessages({ channel: channel, start: Number(new Big(timetoken).minus(2)), end: Number(new Big(timetoken).plus(2)) }));\n    return Promise.all(promises).then((ret: any) => {\n      return ret;\n    });\n  }\n\n  getChannelTyping(channel: string): Subject<[string, boolean]> {\n    if (channel && this._channels[channel] && this._channels[channel].typing) {\n      return this._channels[channel].typing;\n    } else {\n      return null;\n    }\n  }\n\n  initChannelTyping(channel: string, parent: Subscription): Subject<[string, boolean]> {\n    let typing = new Subject<[string, boolean]>();\n    let typingSubscription = this._presenceSubject\n      .pipe(\n        filter(m => m.channel === channel && m.uuid !== this.sender.id),\n        map(({ uuid, action, state }) => {\n          switch (action) {\n            case 'leave':\n            case 'timeout':\n              return [uuid, false];\n            case 'join':\n            case 'state-change':\n              return [uuid, isObject(state) && state.isTyping === 'true'];\n          }\n        })\n      )\n      .subscribe(typing);\n    parent.add(typing);\n    parent.add(typingSubscription);\n    return typing;\n  }\n\n  join(channel: string, withPresence = false, withTyping = false): Observable<Message> {\n    if (!this._channels[channel] || this._channels[channel].subscription.closed) {\n      let messages = new Subject<Message>();\n      if (this._messageSubject) {\n        let subscription = this._messageSubject\n          .pipe(\n            filter(m => m.channel === channel),\n            map(m => merge(m.message, { timetoken: m.timetoken }))\n          )\n          .subscribe(messages);\n        subscription.add(messages);\n        let typing;\n        if (withTyping) {\n          typing = this.initChannelTyping(channel, subscription);\n        }\n        this._parentSubscription.add(subscription);\n        this._channels[channel] = { messages, subscription, typing };\n      }\n      if (this.pubnub) {\n        this.pubnub.subscribe({ channels: [channel], withPresence: withPresence || withTyping });\n      }\n    }\n    if (this._channels && this._channels[channel] && this._channels[channel].messages) {\n      return this._channels[channel].messages;\n    } else {\n      return new Subject<Message>();\n    }\n  }\n\n  leave(channel: string) {\n    if (channel && this._channels[channel] && this.pubnub) {\n      this._channels[channel].subscription.unsubscribe();\n      this.pubnub.unsubscribe({ channels: [channel] });\n    }\n  }\n\n  publish(channel: string, message: Message) {\n    this.pubnub.publish({ channel: channel, message: message });\n  }\n\n  sendChatMessage(channel: string, text: string, receiverId: string, receiverUsername: string, channels?: Channels, photo?: any, type = 'chat', options = {}) {\n    let isGroup = this.isGroupChannel(channel);\n    let alertText = ''; //this.sender.username;\n    if (text.indexOf('ionic-chat-image') >= 0) {\n      alertText += '' + this.translate.get('SENDANEWPHOTO'); //': '\n    } else {\n      alertText += '' + text.substr(0, 50) + '...';\n    }\n    let message: Message = {\n      channel: channel,\n      message: text,\n      type: type,\n      options: options,\n      //entityId: entityId,\n      sender_id: this.sender.id,\n      sender_username: this.sender.username,\n      sender_photo: this.sender.image,\n      receiver_id: receiverId,\n      receiver_username: receiverUsername,\n      isGroup: isGroup,\n      groupName: !isGroup ? null : channels.name,\n      date_sent: new Date(),\n      photo: photo ? <any>pick(photo, ['_id', 'value', 'edit', 'texts', 'title', 'name', 'missiondescriptionRef', 'missionRef', 'missiondataRef', 'userRef', 'userDisplayname', 'address']) : null\n    };\n    // let offlineMessage = Object.assign({}, message, {\n    //     pn_apns: { aps: { alert: alertText, badge: 1 }, sender_username: this.sender.username, channel: channel }, //type: type || chatEvent.newMessage,\n    //     pn_gcm: { data: { message: alertText, title: 'Yoobic', sender_username: this.sender.username, channel: channel } }, //type: type || chatEvent.newMessage,\n    //     pn_debug: false\n    // });\n\n    let otherIds = [];\n    if (!isGroup) {\n      otherIds = [receiverId];\n    } else {\n      otherIds = channels.others.map(u => u._id);\n    }\n\n    otherIds.forEach(otherId => {\n      let promise = !this.isOnline(otherId) ? Promise.resolve(false) : this.isPresent(otherId, channel);\n      promise.then(\n        present => {\n          if (!present) {\n            if (this.isOnline(otherId)) {\n              this.publish(otherId, message);\n              this.push\n                .notifyUserById(otherId, {\n                  title: 'SILENTNOTIFICATION',\n                  mode: 'notification',\n                  pendingBadgePath: 'pendingBadges._communicate' + (isGroup ? '.team' : '.direct'),\n                  notificationOptions: {\n                    content_available: true\n                  }\n                })\n                .subscribe(() => {});\n            } else {\n              this.push\n                .notifyUserById(otherId, {\n                  title: (isGroup ? channels.name + ' - ' : '') + this.sender.username,\n                  body: alertText,\n                  mode: 'notification',\n                  pendingBadgePath: 'pendingBadges._communicate' + (isGroup ? '.team' : '.direct'),\n                  data: message\n                })\n                .subscribe(() => {});\n            }\n          }\n        },\n        err => {}\n      );\n    });\n    this.publish(channel, message);\n  }\n\n  safeMultiplexMessageObservable(channels: string[]): Observable<Message> {\n    return new Observable<Message>(observer => {\n      forEach(channels, (channel: string) => {\n        this._parentSubscription.add(this._channels[channel].messages.subscribe(m => observer.next(m)));\n      });\n    });\n  }\n\n  isAvailable() {\n    let available: boolean = true;\n    try {\n      if (!PubNub) {\n        available = false;\n      }\n    } catch (e) {\n      if (e instanceof ReferenceError) {\n        available = false;\n      }\n    }\n    return available;\n  }\n\n  init(user: User): Observable<Message> {\n    //return from(this.getPubnub()).pipe(mergeMap(pubnub => {\n    if (!this.isAvailable()) {\n      return;\n    }\n\n    this._presenceSubject = !this._presenceSubject || this._presenceSubject.closed ? new Subject<PresenceEvent>() : this._presenceSubject;\n    this._messageSubject = !this._messageSubject || this._messageSubject.closed ? new Subject<MessageEvent>() : this._messageSubject;\n    this._statusSubject = !this._statusSubject || this._statusSubject.closed ? new Subject<StatusEvent>() : this._statusSubject;\n    this._parentSubscription = !this._parentSubscription || this._parentSubscription.closed ? new Subscription() : this._parentSubscription;\n\n    this.sender = new PubnubSender(user._id, User.getDisplayName(user), user.imageData);\n    this.pubnub = new PubNub({\n      ssl: true,\n      keepAlive: true,\n      announceFailedHeartbeats: false,\n      heartbeatInterval: 600,\n      presenceTimeout: 300,\n      // setPresenceTimeout: 0,\n      // setPresenceTimeoutWithCustomInterval: 0,\n      publishKey: this.coreConfig.getKey('pubnubPublishKey'),\n      subscribeKey: this.coreConfig.getKey('pubnubSubscribeKey'),\n      uuid: this.sender.id\n    });\n\n    this._parentSubscription.add(this._presenceSubject);\n    this._parentSubscription.add(this._messageSubject);\n    this._parentSubscription.add(this._statusSubject);\n    // connect listener to subjects\n    this.pubnub.addListener({\n      presence: (p: PresenceEvent) => {\n        if (this._presenceSubject && this._presenceSubject.next) {\n          this._presenceSubject.next(p);\n        }\n      },\n      message: (m: MessageEvent) => {\n        if (this._messageSubject && this._messageSubject.next) {\n          this._messageSubject.next(m);\n        }\n      },\n      status: (s: StatusEvent) => {\n        if (this._statusSubject && this._statusSubject.next) {\n          if (s.error) {\n            this._statusSubject.error(s.error);\n          } else {\n            this._statusSubject.next(s);\n          }\n        }\n      }\n    });\n\n    // subscribe to _presenceSubject on the main channel to manage online user, ignore own events.\n    let onlineUsersSubscription = this._presenceSubject.pipe(filter(({ uuid, channel }) => uuid !== this.sender.id && channel === this._mainChannel)).subscribe((presence: PresenceEvent) => {\n      switch (presence.action) {\n        case 'leave':\n          this.onlineUsers.delete(presence.uuid);\n          break;\n        case 'join':\n        case 'state-change':\n          this.onlineUsers.set(presence.uuid, presence.state || {});\n          break;\n        case 'timeout':\n          this.onlineUsers.set(presence.uuid, null);\n          break;\n        case 'interval':\n          each(presence.join, userId => {\n            this.onlineUsers.set(userId, {});\n          });\n          // each(presence.timedout, userId => {\n          //     this.onlineUsers.set(userId, null);\n          // });\n          each(presence.leave, userId => {\n            this.onlineUsers.delete(userId);\n          });\n\n          if (presence.here_now_refresh && presence.channel === this._mainChannel) {\n            this.updateOnlineUsers();\n          }\n          break;\n      }\n    });\n    this._parentSubscription.add(onlineUsersSubscription);\n\n    let initMessageChannels: string[] = [];\n    //we use the main channel for online/presence detection, subscribe to the presence channel as well.\n    this.join(this._mainChannel, true);\n    this.updateOnlineUsers();\n    initMessageChannels.push(this._mainChannel);\n\n    //we use a specific user channel for notification\n    this.join(this.sender.id);\n    initMessageChannels.push(this.sender.id);\n\n    //we subscribe to each group of the current user for feed notification for example\n    if (!this.authentication.isAdmin() && this.session.groups) {\n      this.session.groups.forEach(group => {\n        this.join(group);\n        initMessageChannels.push(group);\n      });\n    }\n\n    return this.safeMultiplexMessageObservable(initMessageChannels);\n    //}));\n  }\n\n  updateOnlineUsers() {\n    this.pubnub.hereNow({ channels: [this._mainChannel], includeUUIDs: true }).then((response: HereNowResponse<UUIDState<GlobalState>>) => {\n      this.onlineUsers.clear();\n      response.channels[this._mainChannel].occupants.forEach(occupant => {\n        this.onlineUsers.set(occupant.uuid, occupant.state || {});\n      });\n    });\n  }\n\n  disconnect() {\n    if (this.sender && this.sender.id && this.pubnub) {\n      this.pubnub.unsubscribeAll();\n      this.pubnub.removeAllListeners();\n      this._channels = {};\n      this.pubnub.stop();\n    }\n    if (this._parentSubscription) {\n      this._parentSubscription.unsubscribe();\n    }\n    delete this._presenceSubject;\n    delete this._messageSubject;\n    delete this._statusSubject;\n    delete this._parentSubscription;\n  }\n\n  registerDevice(token, channel, type) {\n    this.pubnub.push.addChannels({ device: token, channels: [channel], pushGateway: type }, error => {\n      if (error) {\n        this.log.log('pubnub registered error ' + token, error);\n      } else {\n        this.log.log('pubnub registered success ' + token);\n      }\n    });\n  }\n\n  unregisterDevice(token, channel, type) {\n    this.pubnub.push.removeChannels({ device: token, channels: [channel], pushGateway: type }, error => {\n      if (error) {\n        this.log.log('pubnub unregistered error ' + token, error);\n      } else {\n        this.log.log('pubnub unregistered success ' + token);\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Broker, ResponseObject, Session, User, Users } from '@shared/data-core';\nimport { Filter } from '@shared/stencil';\n\nimport { Channel as ChannelInterface } from '../../interfaces/channel/channel.interface';\nimport { Channels } from '../../interfaces/channels/channels.interface';\nimport { Pubnub } from '../pubnub/pubnub.service';\n\nimport { Observable, Observer, forkJoin } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { uniqBy, orderBy } from 'lodash-es';\nimport { Translate } from '@shared/translate';\n\nexport { ChannelInterface };\n\n@Injectable()\nexport class Channel {\n  constructor(private broker: Broker, private pubnub: Pubnub, private session: Session, protected translate: Translate) {}\n\n  createChannels(channels: Channels) {\n    return new Observable<Channels>((observer: Observer<Channels>) => {\n      this.broker.save('channels', channels).subscribe(c => {\n        this.hydrateOthers(c, true);\n        this.updateChannels(c).subscribe(ret => {\n          observer.next(c);\n          observer.complete();\n        });\n      });\n    });\n  }\n\n  getChannelsById(channelsId: string) {\n    return this.broker.getAll('channels', null, null, null, [[{ field: 'channel', operator: { _id: 'eq' }, value: channelsId }]]).pipe(\n      map(retVal => {\n        if (retVal && retVal.data && retVal.data.length > 0) {\n          let channels = retVal.data[0];\n          this.hydrateOthers(channels, true);\n          return channels;\n        }\n        return null;\n      })\n    );\n  }\n\n  getChannelById(channelId: string) {\n    return this.broker.getAll('channel', null, null, null, [[{ field: 'channel', operator: { _id: 'eq' }, value: channelId }]]).pipe(\n      map(retVal => {\n        if (retVal && retVal.data && retVal.data.length > 0) {\n          let channel = retVal.data[0];\n          this.hydrateOthers(channel, false);\n          return channel;\n        }\n        return null;\n      })\n    );\n  }\n\n  //update the channel itself when we publish a new message\n  update(channel: ChannelInterface) {\n    channel = Object.assign({}, channel);\n    delete channel.others;\n    return this.broker.save('channel', channel);\n  }\n\n  // delete a channel\n  deleteChannel(channel: ChannelInterface) {\n    // TODO: implement pubnub.deleteChannels\n    return this.broker.delete('channel', channel._id);\n  }\n\n  updateChannels(channel: Channels) {\n    channel = Object.assign({}, channel);\n    delete channel.others;\n    return this.broker.save('channels', channel);\n  }\n\n  // delete a group channel\n  deleteChannels(channels: Channels) {\n    // TODO: implement pubnub.deleteChannels\n    return this.broker.delete('channels', channels._id);\n  }\n\n  //Get the channel filter for a specific user\n  getFilter(user1: User, user2?: User, isSupport?: boolean): Filter {\n    let usersRef = [{ field: 'usersRef', operator: { _id: 'inq' }, value: [{ _id: user1._id }] }];\n    if (user2) {\n      usersRef.push({ field: 'usersRef', operator: { _id: 'inq' }, value: [{ _id: user2._id }] });\n    }\n    if (!isSupport) {\n      usersRef.push({ field: 'usersRef', operator: { _id: 'nin' }, value: Users.adminIds });\n    }\n    return [...usersRef, { field: 'channel', operator: { _id: 'like' }, value: '_' }, { field: 'isSupport', operator: { _id: 'eq' }, value: isSupport === true }];\n  }\n\n  getChannelsFilter(user: User): Filter {\n    return [{ field: 'usersRef', operator: { _id: 'inq' }, value: [{ _id: user._id }] }];\n  }\n\n  hydrateOthers(channel: ChannelInterface | Channels, isGroup = false): ChannelInterface | Channels {\n    if (channel && channel.users) {\n      channel.others = channel.users.filter(u => u._id !== this.session.userId);\n    }\n    if (isGroup && (!channel.channel || !channel.channel.startsWith('group_'))) {\n      channel.channel = 'group_' + channel._id;\n    }\n    return channel;\n  }\n\n  //return the channel beetween 2 users\n  getByUsers(user1: User, user2?: User, isSupport?: boolean) {\n    return new Observable<ChannelInterface>((observer: Observer<ChannelInterface>) => {\n      this.broker.getAll('channel', null, null, null, [this.getFilter(user1, user2, isSupport)]).subscribe(retVal => {\n        let channel;\n        if (retVal.data.length > 0) {\n          channel = retVal.data[0];\n          this.hydrateOthers(channel);\n          observer.next(channel);\n          observer.complete();\n        } else {\n          channel = {\n            usersRef: isSupport ? [this.pubnub.supportId, user1._id] : [user1._id, user2._id],\n            channel: isSupport ? this.pubnub.getSupportChannelId(user1._id) : this.pubnub.getChannelId(user1._id, user2._id),\n            isSupport: isSupport === true,\n            isFavorite: false,\n            _tenantRef: user2 ? user2._tenantRef : user1._tenantRef,\n            users: isSupport\n              ? [\n                  {\n                    _id: this.pubnub.supportId,\n                    username: 'smartin@yoobic.com',\n                    firstName: 'Sarah',\n                    lastName: 'Martin',\n                    imageData: 'http://res.cloudinary.com/www-yoobic-com/image/upload/a_exif/v1466421996/jv0vc0yizwqefj22iirh.png'\n                  },\n                  user1\n                ]\n              : [user1, user2]\n          };\n          this.broker.setAcl(channel, null, null, null, user2 ? [user1._id, user2._id] : [user1._id]);\n          this.update(<any>channel).subscribe(c => {\n            this.hydrateOthers(c);\n            observer.next(c);\n            observer.complete();\n          });\n        }\n      });\n    });\n  }\n\n  //Return the support channel for a specific user\n  getSupportByUser(user: User): Observable<ChannelInterface> {\n    return this.getByUsers(user, null, true);\n  }\n\n  getTransform(userId: string, isGroup = false) {\n    return (res: ResponseObject) => {\n      let channels = [];\n      return new Observable<ResponseObject>((observer: Observer<ResponseObject>) => {\n        if (res.data && res.data.map) {\n          if (!isGroup) {\n            res.data = uniqBy(res.data, 'channel');\n          }\n          channels = res.data\n            .map((channel: any) => {\n              this.hydrateOthers(channel, isGroup);\n              if (channel.others && channel.others.length > 0) {\n                if (!isGroup) {\n                  channel.isOnline = this.pubnub.isOnline(channel.others[0]._id);\n                }\n                return channel;\n              } else {\n                return undefined;\n              }\n            })\n            .filter(x => x !== undefined);\n        }\n        if (channels.length === 0) {\n          observer.next({ count: 0, data: [] });\n          observer.complete();\n        } else {\n          forkJoin(\n            channels.map((channel: ChannelInterface) => {\n              return this.pubnub.getHistory(channel.channel, 1).pipe(\n                map((retVal: any) => {\n                  if (retVal.length > 0) {\n                    channel.lastMessage = null;\n                    channel.lastMessageAlternate = null;\n                    channel.lastMessageDate = '';\n\n                    let messages = retVal[0];\n                    if (messages.length > 0) {\n                      let lastMessage = messages[0];\n                      if (!channel.deleteMessages || channel.deleteMessages.indexOf(lastMessage.date_sent) < 0) {\n                        channel.lastMessage = lastMessage.message;\n                        channel.lastMessageDate = lastMessage.date_sent;\n                        if (channel.lastMessage && channel.lastMessage.indexOf('ionic-chat-image') > 0) {\n                          channel.lastMessage = this.translate.get('PHOTO');\n                        }\n                        channel.lastMessageAlternate = lastMessage.sender_id !== this.session.userId;\n                      }\n                    }\n                  }\n                  return channel;\n                })\n              );\n            })\n          ).subscribe(c => {\n            c = orderBy(c, ['lastMessageDate'], ['desc']);\n            observer.next({ count: res.count, data: <any>c });\n            observer.complete();\n          });\n        }\n      });\n    };\n  }\n\n  //Remove the current user from the users list and assign the others attribute\n  getTransformChannel(userId: string) {\n    return this.getTransform(userId, false);\n  }\n\n  //Remove the current user from the users list and assign the others attribute\n  getTransformChannels(userId: string) {\n    return this.getTransform(userId, true);\n  }\n}\n","import { Inject, Injectable, PLATFORM_ID, /*Optional, Injector, isDevMode, */ Renderer2, RendererFactory2, ViewEncapsulation } from '@angular/core';\n// import { Router } from '@angular/router';\nimport { isPlatformBrowser, DOCUMENT } from '@angular/common';\n\nimport { IntercomConfig, Any, BootInput } from '../../interfaces/intercom/intercom.interface';\n\n/**\n * A provider with every Intercom.JS method\n */\n@Injectable()\nexport class WebIntercom {\n  private id: string;\n\n  private renderer2: Renderer2;\n  private config: IntercomConfig;\n  private isInitialized: boolean = false;\n\n  // private router: Router;\n\n  constructor(\n    // private injector: Injector,\n    @Inject(PLATFORM_ID) protected platformId: Object,\n    // private router: Router,\n    private rendererFactory: RendererFactory2,\n    @Inject(DOCUMENT) private document\n  ) {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n\n    // this.router = this.injector.get(Router);\n\n    this.renderer2 = this.rendererFactory.createRenderer(this.document, {\n      id: '-1',\n      encapsulation: ViewEncapsulation.None,\n      styles: [],\n      data: {}\n    });\n\n    // Subscribe to router changes\n  }\n  public init(config: IntercomConfig = { appId: '' }) {\n    this.config = config;\n    if (this.isInitialized) {\n      return;\n    }\n    this.isInitialized = false;\n    // if (config && config.updateOnRouterChange) {\n    //   this.router.events.subscribe(event => {\n    //     this.update();\n    //   });\n    // } else if (isDevMode()) {\n    //   console.warn(`\n    //   Common practice in single page applications is to update whenever the route changes.\n    //   ng-intercom supports this functionality out of the box just set 'updateOnRouterChange' to true in your Intercom Module config.\n    //   This warning will not appear in production, if you choose not to use router updating.\n    //   `);\n    // }\n  }\n\n  /**\n   * If you'd like to control when Intercom is loaded, you can use the 'boot' method.\n   * This is useful in situations like a one-page Javascript based application where the user may not be logged in\n   * when the page loads. You call this method with the standard intercomSettings object.\n   */\n  public boot({ app_id, ...intercomData }: BootInput = {}): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (app_id !== this.config.appId) {\n      this.config.appId = app_id || this.config.appId;\n      if ((<any>window).Intercom) {\n        this.shutdown();\n      }\n    }\n    // Run load and attach to window\n    this.loadIntercom(this.config, (event: Event) => {\n      // then boot the intercom js\n      const data = {\n        ...intercomData,\n        app_id: this.config.appId\n      };\n\n      return (<any>window).Intercom('boot', data);\n    });\n  }\n\n  /**\n   * If you have the Respond product (combined with another product like Engage)\n   * you should call the Intercom shutdown method to clear your usersâ conversations anytime they logout\n   * of your application. Otherwise, the cookie we use to track who was most recently logged in on a given device\n   * or computer will keep these conversations in the Messenger for one week.\n   * This method will effectively clear out any user data that you have been passing through the JS API.\n   */\n  public shutdown(): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('shutdown');\n  }\n\n  /**\n   * Calling the update method without any other arguments will trigger the JavaScript to look for new messages\n   * that should be displayed to the current user (the one whose details are in the window.intercomSettings variable)\n   * and show them if they exist.\n   *\n   * Calling the update method with a JSON object of user details will update those fields on the current user\n   * in addition to logging an impression at the current URL and looking for new messages for the user.\n   */\n  public update(data?: Any): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    if (data) {\n      return (<any>window).Intercom('update', data);\n    } else {\n      return (<any>window).Intercom('update');\n    }\n  }\n\n  /**\n   * This will hide the main Messenger panel if it is open. It will not hide the Messenger Launcher.\n   */\n  public hide(): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('hide');\n  }\n\n  /**\n   * This will show the Messenger. If there are no conversations it will open with the new message view,\n   * if there are it will open with the message list.\n   *\n   * If a `message` parameter is supplied, it will automatically open a new message window, aliasing showNewMessage().\n   *\n   */\n  public show(message?: string): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    if (message) {\n      return (<any>window).Intercom('show');\n    } else {\n      return this.showNewMessage(message);\n    }\n  }\n\n  /**\n   * To open the message window with the message list you can call `showMessages()`.\n   */\n  public showMessages(): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('showMessages');\n  }\n\n  /**\n   * To open the message window with the new message view you can call showNewMessage().\n   *\n   * This function takes an optional parameter that can be used to pre-populate the message composer as shown below.\n   */\n  public showNewMessage(message?: string): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    if (message) {\n      return (<any>window).Intercom('showNewMessage', message);\n    } else {\n      return (<any>window).Intercom('showNewMessage');\n    }\n  }\n\n  /**\n   * You can submit an event using the trackEvent method.\n   * This will associate the event with the currently logged in user and send it to Intercom.\n   * The final parameter is a map that can be used to send optional metadata about the event.\n   *\n   * You can also add custom information to events in the form of event metadata.\n   */\n  public trackEvent(eventName: string, metadata?: any): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    if (metadata) {\n      return (<any>window).Intercom('trackEvent', eventName, metadata);\n    } else {\n      return (<any>window).Intercom('trackEvent', eventName);\n    }\n  }\n\n  /**\n   * A visitor is someone who goes to your site but does not use the messenger.\n   * You can track these visitors via the visitor user_id.\n   * This user_id can be used to retrieve the visitor or lead through the REST API.\n   */\n  public getVisitorId(): string {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('getVisitorId');\n  }\n\n  /**\n   * Alias for getVisitorId()\n   * @alias getVisitorId()\n   * @readonly\n   */\n  get visitorId(): string {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('getVisitorId');\n  }\n\n  /**\n   * Gives you the ability to hook into the show event. Requires a function argument.\n   */\n  public onShow(handler: () => void): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('onShow', handler);\n  }\n\n  /**\n   * Gives you the ability to hook into the hide event. Requires a function argument.\n   */\n  public onHide(handler: () => void): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('onHide', handler);\n  }\n\n  /**\n   * This method allows you to register a function that will be called when the current number of unread messages changes.\n   */\n  public onUnreadCountChange(handler: (unreadCount?: number) => void): void {\n    if (!isPlatformBrowser(this.platformId)) {\n      return;\n    }\n    if (!(<any>window).Intercom) {\n      return;\n    }\n    return (<any>window).Intercom('onUnreadCountChange', handler);\n  }\n\n  injectIntercomScript(conf: IntercomConfig, afterInjectCallback: (ev: Event) => any): void {\n    // if (!isPlatformBrowser(this.platformId)) {\n    //   return\n    // }\n\n    const s = this.document.createElement('script');\n    s.type = 'text/javascript';\n    s.async = true;\n    s.src = `https://widget.intercom.io/widget/${this.id}`;\n\n    if (s.attachEvent) {\n      s.attachEvent('onload', afterInjectCallback);\n    } else {\n      s.addEventListener('load', afterInjectCallback, false);\n    }\n\n    if (this.renderer2 && this.renderer2.appendChild) {\n      this.renderer2.appendChild(this.document.head, s);\n    }\n\n    (<any>window).Intercom('update', conf);\n  }\n\n  loadIntercom(config: IntercomConfig, afterLoadCallback: (ev: Event) => any): void {\n    this.id = config.appId;\n    const w = <any>window;\n    const ic = w.Intercom;\n    if (typeof ic === 'function') {\n      ic('reattach_activator');\n      ic('update', config);\n    } else {\n      const i: any = function() {\n        i.c(arguments);\n      };\n      i.q = [];\n      i.c = function(args: any) {\n        i.q.push(args);\n      };\n      w.Intercom = i;\n      this.injectIntercomScript(config, afterLoadCallback);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CoreConfig } from '@shared/common';\nimport { Authentication, User, Config, Session } from '@shared/data-core';\nimport { Subject } from 'rxjs';\nimport { Intercom as IntercomNative } from '@ionic-native/intercom/ngx';\nimport { toDate, unix } from '@shared/stencil';\n\nimport { WebIntercom } from './web-intercom.service';\n\n@Injectable()\nexport class Intercom {\n  public unreadCount$ = new Subject<number>();\n\n  protected get app_id() {\n    return this.config.serverName === 'Production' ? this.coreConfig.getKey('intercomIdProd') : this.coreConfig.getKey('intercomIdDev');\n  }\n\n  constructor(protected coreConfig: CoreConfig, protected config: Config, protected intercomNative: IntercomNative, protected authentication: Authentication, protected session: Session, protected webIntercom: WebIntercom) {\n    this.authentication.login$.subscribe(() => this.init());\n    this.authentication.logout$.subscribe(() => this.logout());\n    this.authentication.profileUpdated$.subscribe(user => this.identify(user));\n  }\n\n  isEnabled() {\n    if (this.config.isE2E) {\n      return false;\n    }\n    if (this.coreConfig.isLocalhost() && !this.coreConfig.isCordova()) {\n      return false;\n    }\n    return true;\n  }\n\n  init() {\n    // initialize intercom when lauching the app or log in\n    if (!this.isEnabled()) {\n      return;\n    }\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.init({ appId: this.app_id });\n      this.webIntercom.boot({\n        app_id: this.app_id,\n        hide_default_launcher: true\n      });\n      // if (window.Intercom) {\n      //     window.Intercom('boot', {\n      //         app_id: this.app_id,\n      //         hide_default_launcher: true\n      //     });\n      // }\n    } else {\n      // register identified user only if the app is loggedin\n      if (this.authentication.isLoggedIn() && this.session.userId) {\n        this.intercomNative.setLauncherVisibility('GONE');\n        this.intercomNative.registerIdentifiedUser({ userId: this.session.userId });\n      }\n    }\n  }\n\n  registerForPush() {\n    if (this.coreConfig.isCordova()) {\n      this.intercomNative.registerForPush();\n    }\n  }\n\n  logout() {\n    if (!this.isEnabled()) {\n      return;\n    }\n    // This resets the Intercom integration's cache of your user's identity and wipes the slate clean and also hide the launcher.\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.shutdown();\n      // if (window.Intercom) {\n      //     window.Intercom('shutdown');\n      // }\n    } else {\n      this.intercomNative.reset();\n      //this.ionicIntercom.setLauncherVisibility('HIDE');\n    }\n  }\n\n  identify(user: User) {\n    if (!this.isEnabled() || !user) {\n      return;\n    }\n    let traits = {\n      user_id: user._id,\n      language_override: user.language,\n      avatar: {\n        type: 'avatar',\n        image_url: user.imageData\n      },\n      email: user.email || user.username,\n      username: user.username,\n      firstName: user.firstName,\n      lastName: user.lastName,\n      createdAt: unix(toDate(user._ect)),\n      phone: user.telephone,\n      gender: user.gender,\n      device: user.device,\n      target: this.coreConfig.getFullAppName(),\n      company: user.company,\n      role: user.role,\n      tenant: user._tenant ? user._tenant.name : '',\n      hide_default_launcher: true //,\n      //logrocketURL: 'https://app.logrocket.com/' + this.coreConfig.getKey('logrocketId') + '+/sessions?u=' + user._id\n      //custom_launcher_selector: '#intercom_launcher'\n    };\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.update(traits);\n      this.webIntercom.onUnreadCountChange(unreadCount => {\n        this.unreadCount$.next(unreadCount);\n      });\n      // if (window.Intercom) {\n      //     window.Intercom('update', traits);\n      //     window.Intercom('onUnreadCountChange', (unreadCount) => {\n      //         this.unreadCount$.next(unreadCount);\n      //     });\n      // }\n    } else {\n      this.intercomNative.updateUser(traits);\n      this.intercomNative.unreadConversationCount().then(unreadCount => {\n        this.unreadCount$.next(unreadCount);\n      });\n    }\n  }\n\n  trackEvent(eventName: string, metaData: any) {\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.trackEvent(eventName, metaData);\n    } else {\n      this.intercomNative.logEvent(eventName, metaData);\n    }\n  }\n\n  update(metaData: any) {\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.update(metaData);\n    } else {\n      this.intercomNative.updateUser(metaData);\n    }\n  }\n\n  show() {\n    if (!this.isEnabled()) {\n      return;\n    }\n    if (!this.coreConfig.isCordova()) {\n      this.webIntercom.show();\n      // if (window.Intercom) {\n      //     window.Intercom('show');\n      // }\n    } else {\n      this.intercomNative.displayMessenger();\n    }\n  }\n}\n","/* tslint:disable:variable-name */\nimport { Injectable } from '@angular/core';\nimport { Broker, Requestor } from '@shared/data-core';\nimport { Message } from '../../interfaces/message/message.model';\nimport { Observable } from 'rxjs';\n\n@Injectable()\nexport class Messages {\n  constructor(private broker: Broker, private rq: Requestor) {}\n\n  getJsonMessage(message: Message) {\n    return {\n      to: message.to,\n      content: {\n        title: message.title,\n        body: message.body,\n        //footer: message.footer,\n        actionURL: message.actionURL,\n        actionText: message.actionText,\n        action: message.actionURL ? true : false,\n        thankyou: message.thankyou\n      }\n    };\n  }\n\n  sendMail(message: Message): any {\n    return this.rq.post(this.apiUrl + 'mail', this.getJsonMessage(message));\n  }\n\n  unblockEmails(emails: Array<string>): Observable<any> {\n    return this.rq.post(this.broker.getApiUrl() + 'businesslogic/unblockEmails', { emails });\n  }\n\n  private get apiUrl() {\n    return this.broker.getApiUrl() + 'Messages/';\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Network, CoreConfig, Log, LocalStorage, Colors } from '@shared/common';\nimport { User, Authentication, Session, Push, Config } from '@shared/data-core'; //, Requestor, Config\nimport { Intercom } from '../intercom/intercom.service';\nimport { merge } from 'lodash-es';\n//import { captureException, init, sessionURL, getSessionURL, identify } from 'logrocket';\n//const LogRocket = require('logrocket');\n@Injectable()\nexport class Track {\n  constructor(protected network: Network, protected push: Push, protected session: Session, protected localStorage: LocalStorage, protected authentication: Authentication, protected coreConfig: CoreConfig, protected config: Config, protected log: Log, protected injector: Injector, protected intercom: Intercom) {\n    this.loadAnalytics();\n    //this.loadLogRocket();\n    //this.loadSessionStack();\n  }\n\n  isEnabled(forceLoggedIn: boolean = true, ignoreE2E: boolean = false) {\n    if (this.network.isOffline()) {\n      return false;\n    }\n    if (this.coreConfig.isLocalhost() && !this.coreConfig.isCordova()) {\n      return false;\n    }\n    if (this.coreConfig.getMode() !== 'prod') {\n      return false;\n    }\n    if (this.config.isE2E && !ignoreE2E) {\n      return false;\n    }\n    if (forceLoggedIn && !this.authentication.isLoggedIn()) {\n      return false;\n    }\n    if (this.session.user && this.session.user.disableTracking) {\n      return false;\n    }\n    return true;\n  }\n\n  // loadLogRocket() {\n  //   if (this.isEnabled(false)) {\n  //     try {\n  //       LogRocket.init(this.coreConfig.getKey('logrocketId'), {\n  //         dom: {\n  //           baseHref: this.coreConfig.getCssPublicUrl()\n  //         }\n  //       });\n  //     } catch (error) { }\n  //   }\n  // }\n\n  loadSessionStack() {\n    return new Promise((resolve, reject) => {\n      try {\n        if (!window['SessionStack'] && this.isEnabled(false, true)) {\n          if (this.coreConfig.isIOS() && this.coreConfig.isCordova()) {\n            Object.defineProperty(window.document, 'cookie', {\n              enumerable: true,\n              configurable: true,\n              get: () => {\n                return this.localStorage.get('document-cookie');\n              },\n              set: cookieString => {\n                let cookie = this.localStorage.get('document-cookie');\n                if (cookie) {\n                  let cookies = cookie.split('; ');\n                  let name = cookieString.split('=')[0];\n                  cookies = cookies.filter(c => c.indexOf(name + '=') < 0);\n                  cookies.push(cookieString.trim());\n                  cookie = cookies.join('; ');\n                } else {\n                  cookie = cookieString;\n                }\n                this.localStorage.set('document-cookie', cookie);\n              }\n            });\n          }\n\n          window['SessionStackKey'] = 'SessionStack';\n          window['SessionStack'] = window['SessionStack'] || {\n            t: this.coreConfig.isIonic() ? this.coreConfig.getKey('sessionStackMobile') : this.coreConfig.getKey('sessionStackWeb'),\n            q: []\n          };\n          ['start', 'stop', 'identify', 'getSessionId', 'log', 'setOnDataCallback'].forEach(key => {\n            window['SessionStack'][key] =\n              window['SessionStack'][key] ||\n              function() {\n                window['SessionStack'].q.push([key].concat([].slice.call(arguments, 0)));\n              };\n          });\n          let f = document.createElement('script');\n          f.async = !0;\n          f.src = 'https://cdn.sessionstack.com/sessionstack.js';\n          f.onload = () => {\n            resolve(true);\n          };\n          f.onerror = err => {\n            reject(err);\n          };\n          let g = document.getElementsByTagName('script')[0];\n          g.parentNode.insertBefore(f, g);\n        } else {\n          resolve(false);\n        }\n      } catch (err) {\n        reject(err);\n      }\n    });\n  }\n\n  // sendLogRocketError(err) {\n  //   try {\n  //     if (this.isEnabled(false)) {\n  //       LogRocket.captureException(err);\n  //     }\n  //   } catch (err) { }\n  // }\n\n  // getLogRocketSessionUrl() {\n  //   try {\n  //     return LogRocket.sessionURL;\n  //   } catch (error) { }\n  //   return '';\n  // }\n\n  getSessionStackSession(): Promise<string> {\n    return new Promise(resolve => {\n      if (window['SessionStack']) {\n        window['SessionStack'].getSessionId(sessionId => {\n          this.log.log('SessionStack sessionid', sessionId);\n          resolve(sessionId);\n        });\n      } else {\n        resolve(null);\n      }\n    });\n  }\n\n  getSessionStackUrl(): any {\n    return 'https://app.sessionstack.com/player/#/sessions/';\n  }\n\n  sendSessionStackError(err) {\n    // try {\n    //   if (this.isEnabled(false) && window['SessionStack']) {\n    //     window['SessionStack'].log(err);\n    //   }\n    // } catch (err) { }\n  }\n\n  loadAnalytics() {\n    if (!this.isEnabled(false)) {\n      return;\n    }\n    let analytics = (window.analytics = window.analytics || []);\n    if (!analytics.initialize) {\n      if (analytics.invoked) {\n        this.log.error('Segment snippet included twice.');\n      } else {\n        analytics.invoked = !0;\n        analytics.methods = ['trackSubmit', 'trackClick', 'trackLink', 'trackForm', 'pageview', 'identify', 'reset', 'group', 'track', 'ready', 'alias', 'debug', 'page', 'once', 'off', 'on'];\n        analytics.factory = function(tt) {\n          return function() {\n            let e = Array.prototype.slice.call(arguments);\n            e.unshift(tt);\n            analytics.push(e);\n            return analytics;\n          };\n        };\n        for (let t = 0; t < analytics.methods.length; t++) {\n          let e = analytics.methods[t];\n          analytics[e] = analytics.factory(e);\n        }\n        analytics.load = function(t) {\n          let e = document.createElement('script');\n          e.type = 'text/javascript';\n          e.async = !0;\n          e.src = ('https:' === document.location.protocol ? 'https://' : 'http://') + 'cdn.segment.com/analytics.js/v1/' + t + '/analytics.min.js';\n          let n = document.getElementsByTagName('script')[0];\n          n.parentNode.insertBefore(e, n);\n        };\n        analytics.SNIPPET_VERSION = '4.0.0';\n        analytics.load(this.config.serverName === 'Production' ? this.coreConfig.getKey('segmentApiWriteKey') : this.coreConfig.getKey('segmentApiWriteKeyDev'));\n        analytics.page();\n\n        // LogRocket.getSessionURL(url => {\n        //   analytics.track('LogRocket', { sessionURL: url });\n        //   this.intercom.trackEvent('LogRocket', { sessionURL: url });\n        // });\n      }\n    }\n  }\n\n  track(event: string, properties?: Object): void {\n    if (!event || event === '') {\n      return;\n    }\n    event = event\n      .split(' ')\n      .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n      .join(' ');\n    if (this.session.debugEvent) {\n      this.log.log('EVENT', event, properties);\n    }\n    if (this.isEnabled() && window.analytics) {\n      try {\n        window.analytics.track(event, merge(this.globalTrackedProps(this.session.user), properties));\n      } catch (error) {}\n    }\n  }\n\n  page(name: string, category?: string, properties?: any) {\n    if (this.isEnabled() && window.analytics) {\n      try {\n        window.analytics.page(category, name, merge(this.globalTrackedProps(this.session.user), properties));\n      } catch (error) {}\n    }\n  }\n\n  identify(user: User) {\n    if (!user) {\n      return;\n    }\n    setTimeout(() => {\n      if (this.isEnabled()) {\n        // try {\n        // let traits = {\n        //   avatar: user.imageData || '',\n        //   email: user.email || user.username || '',\n        //   firstName: user.firstName || '',\n        //   lastName: user.lastName || '',\n        //   createdAt: user._ect || '',\n        //   phone: user.telephone || '',\n        //   gender: user.gender || '',\n        //   device: user.device || '',\n        //   target: this.coreConfig.getFullAppName(),\n        //   language: user.language || ''\n        // };\n        //   LogRocket.identify(user._id, traits);\n        // } catch (error) { }\n        if (window.analytics) {\n          try {\n            let segment_traits = {\n              user_id: user._id || '',\n              user_tags: user.tags || '',\n              email: user.email || user.username || '',\n              operating_system: this.coreConfig.getPlatform(),\n              avatar: user.imageData || '',\n              phone: user.telephone || '',\n              gender: user.gender || '',\n              target: this.coreConfig.getFullAppName(),\n              version: this.coreConfig.getAppVersion(),\n              is_dark_theme: Colors.isDarkTheme()\n            };\n            window.analytics.identify(user._id, merge(this.globalTrackedProps(user), segment_traits));\n          } catch (error) {}\n        }\n        // this.loadSessionStack().then(success => {\n        //   if (success && window['SessionStack']) {\n        //     //&& !(this.coreConfig.isIOS() && this.coreConfig.isCordova())\n        //     try {\n        //       this.log.log('SessionStack: identify');\n        //       window['SessionStack'].identify({\n        //         userId: user._id || '',\n        //         email: user.email || user.username || '',\n        //         displayName: User.getDisplayName(user),\n        //         // Add your own custom user variables here.\n        //         user_tags: user.tags || '',\n        //         operating_system: this.coreConfig.getPlatform(),\n        //         avatar: user.imageData || '',\n        //         phone: user.telephone || '',\n        //         gender: user.gender || '',\n        //         target: this.coreConfig.getFullAppName(),\n        //         version: this.coreConfig.getAppVersion();\n        //         is_dark_theme: Colors.isDarkTheme()\n        //       });\n        //       setTimeout(() => {\n        //         this.getSessionStackSession().then(sessionId => {\n        //           let sessionstackURL = this.getSessionStackUrl() + (sessionId || 'notfound');\n        //           this.log.log('SessionStack: link to intercom', sessionstackURL);\n        //           this.intercom.update({\n        //             sessionstackURL: sessionstackURL\n        //           });\n        //         });\n        //       }, 2000);\n        //     } catch (error) { }\n        //   }\n        // });\n      }\n      this.intercom.identify(user);\n      setTimeout(() => {\n        if (window && window['FS'] && window['FS'].getCurrentSessionURL) {\n          let fullstoryURL = window['FS'].getCurrentSessionURL();\n          this.intercom.update({\n            fullstoryURL: fullstoryURL\n          });\n        }\n      }, 2000);\n    }, 3000);\n  }\n\n  intercomRegisterForPush() {\n    this.intercom.registerForPush();\n  }\n\n  globalTrackedProps(user: User) {\n    let props = {\n      user_groups: this.authentication.isAdmin() ? [] : this.session.groups,\n      user_username: user.username || '',\n      user_firstname: user.firstName || '',\n      user_lastname: user.lastName || '',\n      user_language: user.language || '',\n      user_company_name: user.company || '',\n      user_tenant: user._tenant ? user._tenant.name : null,\n      user_role: user.role || '',\n      user_roles: this.session.roles || [],\n      user_environment: this.config.serverName.toUpperCase()\n    };\n    try {\n      let router: Router;\n      router = this.injector.get(Router);\n      props = merge(props, { page: router.url });\n    } catch (err) {}\n    return props;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Requestor, Config } from '@shared/data-core';\n\nimport { map } from 'rxjs/operators';\n\n@Injectable()\nexport class TwilioToken {\n  constructor(private rq: Requestor, private config: Config) {}\n\n  getToken(): any {\n    return this.rq.get(this.config.apiUrl + 'Twilio/getToken').pipe(\n      map(ret => {\n        return ret.TwilioVideoToken;\n      })\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Session, User } from '@shared/data-core';\nimport { Log, CoreConfig } from '@shared/common';\nimport { showAlert, closeModal } from '@shared/stencil';\nimport { VxtConferenceConfig, WebRTCConstraints, ScreenShareOptions } from '../../interfaces/voxeet/voxeet.interface';\nimport { Translate } from '@shared/translate';\n\nimport VoxeetSdk from '@voxeet/voxeet-web-sdk';\nimport { Pubnub } from '../pubnub/pubnub.service';\nimport { isFunction } from 'lodash-es';\n\n@Injectable()\nexport class VideoCall {\n  protected isInit: boolean;\n  private voxeet: VoxeetSdk;\n  private voxeetUserId: string;\n  private userInfo: any;\n  private videoModal: HTMLYooIonModalElement;\n  private videoToast: HTMLYooToastElement;\n  private constraints = {\n    audio: true,\n    video: {\n      width: { ideal: 4096 },\n      height: { ideal: 2160 }\n    }\n  };\n  constructor(protected session: Session, protected log: Log, protected coreConfig: CoreConfig, protected pubnub: Pubnub, protected translate: Translate) {}\n\n  useCordova() {\n    return this.coreConfig.isCordova() && window['Voxeet'];\n  }\n\n  init() {\n    if (!this.isInit) {\n      this.isInit = true;\n      this.onInitUserInfo();\n      if (this.useCordova() && window['Voxeet']) {\n        this.onInitCordova();\n      } else {\n        this.onInitWeb();\n      }\n    } else {\n      this.reconnect();\n    }\n    return Promise.resolve();\n  }\n\n  onInitUserInfo(): void {\n    if (this.session && this.session.user) {\n      this.userInfo = this.convertUserInfo(this.session.user);\n    } else {\n      this.userInfo = this.convertUserInfo();\n    }\n  }\n\n  convertUserInfo(\n    user?: User\n  ): {\n    name: string;\n    externalId: string;\n    avatarUrl: string;\n  } {\n    let userId = '';\n    let userName = '';\n    let imageData = '';\n    if (user) {\n      if (user._id) {\n        userId = user._id;\n      }\n      if (User.getDisplayName(user)) {\n        userName = User.getDisplayName(user);\n      }\n      if (user.imageData) {\n        imageData = user.imageData;\n      }\n    }\n    return {\n      name: userName,\n      externalId: userId,\n      avatarUrl: imageData\n    };\n  }\n\n  onInitCordova(): void {\n    this.voxeet = window['Voxeet'];\n    if (this.voxeet) {\n      this.voxeet\n        .initialize(this.coreConfig.getKey('voxeetKey'), this.coreConfig.getKey('voxeetSecret'))\n        .then(myUserId => {\n          this.voxeetUserId = myUserId;\n          this.log.log('voxeet is init for cordova:', this.voxeetUserId);\n          this.voxeet.appearMaximized(true);\n        })\n        .then(() => {\n          this.log.log('appearMaximized');\n          this.voxeet.defaultBuiltInSpeaker(true);\n        })\n        .then(() => {\n          this.log.log('defaultBuiltInSpeaker');\n          this.voxeet.defaultVideo(true);\n        })\n        .then(() => {\n          this.log.log('defaultVideo');\n          this.voxeet.connect(this.getUserInfo());\n        })\n        .then(() => {\n          this.log.log('voxeet connected');\n        });\n    }\n  }\n\n  onInitWeb(): void {\n    this.voxeet = new VoxeetSdk();\n    if (this.voxeet) {\n      return this.voxeet\n        .initialize(this.coreConfig.getKey('voxeetKey'), this.coreConfig.getKey('voxeetSecret'), this.getUserInfo())\n        .then(myUserId => {\n          this.voxeetUserId = myUserId;\n          this.log.log('voxeet is init for web:', this.voxeetUserId);\n        })\n        .catch(error => {\n          this.log.error(error);\n        });\n    }\n  }\n\n  getUserInfo(): any {\n    if (this.useCordova()) {\n      return new window['UserInfo'](this.userInfo.externalId, this.userInfo.name, this.userInfo.avatarUrl);\n    } else {\n      return this.userInfo;\n    }\n  }\n\n  createConference(alias: string) {\n    if (this.useCordova()) {\n      return this.voxeet.create({ conferenceAlias: alias, params: { videoCodec: 'H264' } });\n    } else {\n      return this.voxeet.createConference({ alias });\n    }\n  }\n\n  joinConference(conf: any, options?: VxtConferenceConfig) {\n    if (this.useCordova()) {\n      return this.voxeet.join(conf.conferenceId ? conf.conferenceId : conf);\n    } else {\n      return this.voxeet.joinConference(\n        conf.conferenceId ? conf.conferenceId : conf,\n        options || {\n          constraints: { video: true, audio: true },\n          user: {\n            name: User.getDisplayName(this.session.user),\n            externalId: this.session.userId,\n            avatarUrl: this.session.user.imageData\n          },\n          audio3D: true,\n          conference: { params: { videoCodec: 'H264', liveRecording: true } }\n        }\n      );\n    }\n  }\n\n  hasWebCam(): Promise<boolean> {\n    if (window && window.navigator) {\n      let mediaDevices = window.navigator.mediaDevices as any;\n      mediaDevices.getMedia = mediaDevices.getUserMedia || mediaDevices.webkitGetUserMedia || mediaDevices.mozGetUserMedia || mediaDevices.msGetUserMedia;\n      return new Promise<boolean>((resolve, reject) => {\n        mediaDevices.getMedia({ video: true }).then(\n          () => {\n            resolve(true);\n          },\n          () => resolve(false)\n        );\n      });\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  hasMicrophone(): Promise<boolean> {\n    if (window && window.navigator) {\n      let mediaDevices = window.navigator.mediaDevices as any;\n      mediaDevices.getMedia = mediaDevices.getUserMedia || mediaDevices.webkitGetUserMedia || mediaDevices.mozGetUserMedia || mediaDevices.msGetUserMedia;\n      return new Promise<boolean>((resolve, reject) => {\n        mediaDevices.getMedia({ audio: true }).then(\n          () => {\n            resolve(true);\n          },\n          () => resolve(false)\n        );\n      });\n    } else {\n      return Promise.resolve(false);\n    }\n  }\n\n  getConstraint(): { video: any; audio: any } {\n    let constraints: any = this.constraints;\n    let camPromise = this.hasWebCam();\n    let micPromise = this.hasMicrophone();\n    camPromise.then(hasCam => {\n      if (!hasCam) {\n        constraints.video = false;\n      }\n    });\n    micPromise.then(hasMic => {\n      if (!hasMic) {\n        constraints.audio = false;\n      }\n    });\n    return constraints;\n  }\n\n  inviteParticipants(conferenceId: string, externalIds: Array<User>): void {\n    if (this.useCordova()) {\n      return this.voxeet.invite(\n        conferenceId,\n        externalIds.map(user => {\n          let userInfo = this.convertUserInfo(user);\n          return new window['UserInfo'](userInfo.externalId, userInfo.name, userInfo.avatarUrl);\n        })\n      );\n    } else {\n      return this.voxeet.invite(conferenceId, externalIds.map(user => user._id));\n    }\n  }\n\n  leaveConference(leaveRoom: boolean = true) {\n    if (this.useCordova()) {\n      return this.voxeet.leave();\n    } else {\n      return this.voxeet.leaveConference(leaveRoom);\n    }\n  }\n\n  addListener(event: string, handler: Function) {\n    if (!this.useCordova() && event && handler) {\n      this.voxeet.on(event, handler);\n    }\n  }\n\n  removeListener(event: string, handler: Function) {\n    if (!this.useCordova() && event && handler) {\n      this.voxeet.removeListener(event, handler);\n    }\n  }\n\n  removeAllListeners(): Promise<any> {\n    if (this.voxeet && this.voxeet.removeAllListeners) {\n      return this.voxeet.removeAllListeners();\n    }\n    return Promise.resolve();\n  }\n\n  getUserId() {\n    return this.voxeetUserId;\n  }\n\n  startVideo(userId?: string, constraints?: WebRTCConstraints) {\n    if (!this.useCordova()) {\n      return this.voxeet.startVideoForUser(userId || this.getUserId(), constraints || this.constraints);\n    }\n  }\n\n  stopVideo(userId?: string) {\n    if (!this.useCordova()) {\n      return this.voxeet.stopVideoForUser(userId || this.getUserId());\n    }\n  }\n\n  startAudio(userId?: string) {\n    if (!this.useCordova()) {\n      return this.voxeet.startAudioForUser(userId || this.getUserId());\n    }\n  }\n\n  stopAudio(userId?: string) {\n    if (!this.useCordova()) {\n      return this.voxeet.stopAudioForUser(userId || this.getUserId());\n    }\n  }\n\n  muteUser(isMuted: boolean, userId?: string): void {\n    if (!this.useCordova()) {\n      return this.voxeet.muteUser(userId || this.getUserId(), isMuted);\n    }\n  }\n\n  toggleMute(userId?: string) {\n    if (!this.useCordova()) {\n      return this.voxeet.toggleMute(userId || this.getUserId());\n    }\n  }\n\n  setUserPosition(userId: string, x: number, y: number) {\n    if (!this.useCordova()) {\n      return this.voxeet.setUserPosition(userId, x, y);\n    }\n  }\n\n  getCurrentSession() {\n    if (!this.useCordova()) {\n      return this.voxeet;\n    } else {\n      return this.voxeet;\n    }\n  }\n\n  getEnumerateAudioDevices(option?: string): Promise<any> {\n    if (!this.useCordova()) {\n      return this.voxeet.enumerateAudioDevices(option);\n    } else {\n      return Promise.resolve(null);\n    }\n  }\n\n  getEnumerateVideoDevices(): Promise<any> {\n    if (!this.useCordova()) {\n      return this.voxeet.enumerateVideoDevices();\n    } else {\n      return Promise.resolve(null);\n    }\n  }\n\n  selectAudioInput(deviceId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.selectAudioInput(deviceId, constraints);\n  }\n\n  selectAudioOutput(deviceId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.selectAudioOutput(deviceId, constraints);\n  }\n\n  selectVideoInput(deviceId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.selectVideoInput(deviceId, constraints);\n  }\n\n  startVideoForUser(userId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.startVideoForUser(userId, constraints);\n  }\n\n  stopVideoForUser(userId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.stopVideoForUser(userId, constraints);\n  }\n\n  startAudioForUser(userId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.startAudioForUser(userId, constraints);\n  }\n\n  stopAudioForUser(userId: string, constraints?: {}): Promise<any> {\n    return this.voxeet.stopAudioForUser(userId, constraints);\n  }\n\n  startScreenShare(options: Array<ScreenShareOptions>): Promise<any> {\n    return this.voxeet.startScreenShare(options);\n  }\n\n  stopScreenShare(): Promise<any> {\n    return this.voxeet.stopScreenShare();\n  }\n\n  startRecording(): Promise<any> {\n    return this.voxeet.startRecording();\n  }\n\n  stopRecording(): Promise<any> {\n    return this.voxeet.stopRecording();\n  }\n\n  replayRecording(conferenceId: string, offset?: any): Promise<any> {\n    if (conferenceId && this.voxeet && this.voxeet.replayConference) {\n      return this.voxeet.replayConference(conferenceId, offset || 0);\n    } else {\n      return Promise.reject('ConferenceId is not provided');\n    }\n  }\n\n  shareVideo(url: string): Promise<any> {\n    return this.voxeet.videoPresentation.start(url);\n  }\n\n  updateMediaSettings(settings: { microphone: MediaDeviceInfo; video: MediaDeviceInfo }): Array<Promise<any>> {\n    let promises: any = [];\n    let microphone = settings.microphone;\n    let video = settings.video;\n    if (microphone && microphone.deviceId) {\n      promises.push(this.selectAudioInput(microphone.deviceId));\n    }\n    if (video && video.deviceId) {\n      promises.push(this.selectVideoInput(video.deviceId));\n    }\n    if (promises.length < 1) {\n      promises.push(Promise.resolve());\n    }\n    return promises;\n  }\n\n  sendChatMessage(users: Array<User>, roomName: string, conferenceId: string): void {\n    let others = users.filter(user => user._id !== this.session.userId);\n    if (others) {\n      this.inviteParticipants(conferenceId, others);\n      others\n        .map(user => user._id)\n        .forEach(userId => {\n          this.pubnub.sendChatMessage(userId, this.translate.get('VIDEOCALLCALLING', { user: User.getDisplayName(this.session.user) }), userId, null, null, null, 'videocall', { conferenceId, user: this.session.user, users });\n        });\n    }\n  }\n\n  disconnect(): void {\n    if (this.voxeet && isFunction(this.voxeet.disconnect)) {\n      this.isInit = false;\n      this.voxeet.disconnect().then(() => {\n        this.log.log('voxeet disconnected');\n      });\n    }\n  }\n\n  reconnect(): void {\n    if (this.useCordova()) {\n      this.voxeet.connect(this.getUserInfo());\n    }\n  }\n\n  sendRecordedConferenceId(currentMessage: string, channel) {\n    if (currentMessage && channel && channel.others && channel.others[0] && channel.others[0]._id) {\n      this.pubnub.sendChatMessage(channel.channel, currentMessage, channel.others[0]._id, null, <any>channel, {}, 'conference');\n    }\n  }\n\n  showNoWebCamAlert(): void {\n    showAlert(this.translate.get('NOWEBCAM'), [this.translate.get('OK')], null, '');\n  }\n\n  showFailedConnectAlert(): void {\n    showAlert(this.translate.get('CONFERENCEFAILED'), [this.translate.get('OK')], null, '');\n  }\n\n  showCallerLeftAlert(): Promise<any> {\n    return showAlert('', [this.translate.get('OK')], '', this.translate.get('CALLERLEFT'));\n  }\n\n  showRecieverLeft(): Promise<any> {\n    return showAlert('', [this.translate.get('OK')], '', this.translate.get('RECIEVERLEFT'));\n  }\n\n  showRecordCompleteAlert(): Promise<any> {\n    return showAlert('', [this.translate.get('OK')], '', this.translate.get('CALLRECORDED'));\n  }\n\n  setVideoToast(toast: HTMLYooToastElement): void {\n    this.videoToast = toast;\n  }\n\n  setVideoModal(modal: HTMLYooIonModalElement): void {\n    this.videoModal = modal;\n  }\n\n  closeVideoModal(): void {\n    if (this.videoModal) {\n      closeModal(this.videoModal);\n      this.videoModal = null;\n    }\n  }\n\n  dismissVideoToast(): void {\n    if (this.videoToast) {\n      this.videoToast.dismiss();\n      this.videoToast = null;\n    }\n  }\n\n  onSendDeclineMessage(data: any): void {\n    if (data && data.options && data.sender_id) {\n      this.pubnub.sendChatMessage(data.sender_id, this.translate.get('VIDEOCALLCANCEL', { user: User.getDisplayName(this.session.user) }), this.session.user._id, null, null, null, 'videocallcancel', { declineCall: true });\n    }\n  }\n\n  onSendCancelNotificationMessage(users: Array<User>, conferenceId: string): void {\n    let others = users.filter(user => user._id !== this.session.userId);\n    if (others) {\n      others\n        .map(user => user._id)\n        .forEach(userId => {\n          this.pubnub.sendChatMessage(userId, this.translate.get('VIDEOCALLCANCEL', { user: User.getDisplayName(this.session.user) }), userId, null, null, null, 'videocallcancel', { cancelCall: true });\n        });\n    }\n  }\n\n  onReceiveDeclineMessage(data: any) {\n    if (data && data.options && data.sender_id && this.session.user._id) {\n      if (data.options.declineCall && data.sender_id !== this.session.user._id) {\n        showAlert('', [this.translate.get('OK')], '', this.translate.get('USERDECLINECALL')).then(res => {\n          this.closeVideoModal();\n        });\n      } else if (data.options.cancelCall) {\n        this.dismissVideoToast();\n      }\n    }\n  }\n}\n","import { Injectable, NgZone, ErrorHandler } from '@angular/core';\nimport { Log, CoreConfig } from '@shared/common';\nimport { Config } from '@shared/data-core';\nimport { Track } from '../track/track.service';\n\nimport * as Sentry from '@sentry/browser';\n\n@Injectable()\nexport class SentryErrorHandler implements ErrorHandler {\n  public static disabledErrorMessages: Array<string> = [\"Cannot read property 'disconnect' of null\", 'PubNub call failed', 'PubNub call failed, check status for details', \"InvalidStateError: Failed to execute 'transaction'\", 'Loading chunk', \"You provided 'undefined' where a stream was expected\", \"Cannot read property 'value' of undefined\", 'Uncaught (in promise): OK', 'Uncaught (in promise): Error: Timeout', 'NS_ERROR_NOT_INITIALIZED', 'Error: No available storage method found'];\n\n  constructor(private log: Log, private zone: NgZone, private trackService: Track, protected coreConfig: CoreConfig, protected config: Config) {\n    if (this.isEnabled()) {\n      try {\n        let currentEnv = this.config.getCurrentConfig().initialSelection;\n        this.zone.runOutsideAngular(() => {\n          let options = {\n            dsn: this.coreConfig.getKey('sentryClientKey'),\n            release: this.coreConfig.getAppVersion(),\n            environment: (currentEnv ? currentEnv._id : '') || 'prod'\n          };\n          Sentry.init(options);\n        });\n      } catch (err) {\n        this.log.error(err);\n      }\n    }\n  }\n\n  isEnabled() {\n    return this.coreConfig.getMode() === 'prod' && this.coreConfig.getKey('sentryClientKey') && this.coreConfig.getKey('sentryClientKey').length > 0; //\n  }\n\n  handleError(err: any): void {\n    let disabled = false;\n    SentryErrorHandler.disabledErrorMessages.forEach(m => {\n      if (err && err.message && err.message.indexOf(m) >= 0) {\n        disabled = true;\n      }\n    });\n    if (disabled) {\n      return;\n    }\n    if (err && this.isEnabled()) {\n      try {\n        Sentry.captureException(err.originalError || err);\n      } catch (e) {}\n      //this.trackService.sendLogRocketError(err.originalError || err);\n      //this.trackService.sendSessionStackError(err.originalError || err);\n      this.trackService.track('App Crash', { error: err.originalError || err });\n      this.log.error(err.originalError || err);\n    } else if (err && this.coreConfig.getMode() === 'dev') {\n      this.log.error(err);\n    }\n  }\n\n  identify(id, email, username) {\n    if (this.isEnabled() && id) {\n      try {\n        this.trackService.getSessionStackSession().then(session_id => {\n          Sentry.configureScope(scope => {\n            scope.setUser({ email, username, id });\n            scope.addEventProcessor(async event => {\n              event.contexts = event.contexts || {};\n              event.contexts.sessionstack = {\n                session_id: session_id,\n                timestamp: new Date().getTime()\n              };\n              event.extra = event.extra || {};\n              //event.extra.sessionstackUrl = this.trackService.getSessionStackUrl() + session_id;\n              if (window && window['FS'] && window['FS'].getCurrentSessionURL) {\n                event.extra.fullstoryUrl = window['FS'].getCurrentSessionURL();\n              }\n              return event;\n            });\n          });\n        });\n      } catch (e) {}\n    }\n  }\n}\n","import { NgModule, ModuleWithProviders, Provider } from '@angular/core';\n\nimport { DataCoreModule } from '@shared/data-core';\n//import { DATA_LIVE_PROVIDERS } from './services';\nimport { Channel } from './services/channel/channel.service';\nimport { Intercom } from './services/intercom/intercom.service';\nimport { WebIntercom } from './services/intercom/web-intercom.service';\nimport { Messages } from './services/messages/messages.service';\nimport { Pubnub } from './services/pubnub/pubnub.service';\nimport { Track } from './services/track/track.service';\nimport { TwilioToken } from './services/twilio-token/twilio-token.service';\nimport { VideoCall } from './services/video-call/video-call.service';\nimport { SentryErrorHandler } from './services/sentry-error-handler/sentry-error-handler.service';\n\nimport { Intercom as IntercomNative } from '@ionic-native/intercom/ngx';\n\n@NgModule({\n  declarations: [],\n  imports: [DataCoreModule],\n  exports: [DataCoreModule]\n})\nexport class DataLiveModule {\n  static forRoot(configuredProviders: Array<Provider> = []): ModuleWithProviders {\n    return {\n      ngModule: DataLiveModule,\n      providers: [...configuredProviders, Channel, Intercom, IntercomNative, Messages, Pubnub, SentryErrorHandler, Track, TwilioToken, VideoCall, WebIntercom]\n    };\n  }\n}\n","import { Entity, IAcl, User, Model, Editable, Searchable, FORM_FILES_IMAGE_FILTER, getGroupsTransform } from '@shared/data-core';\nimport { FormFieldType } from '@shared/stencil';\n\n@Model({\n  className: 'Channels',\n  collectionName: 'channels',\n  fields: ['*'],\n  include: ['users']\n})\nexport class Channels extends Entity {\n  // export class Channels implements IEntity {\n  _id: string;\n  _acl: IAcl;\n  _lmt?: string;\n  _ect?: string;\n\n  channel: string;\n\n  @Editable('Channels', { required: true, type: FormFieldType.text })\n  @Searchable('Channels')\n  name: string;\n\n  @Editable('Channels', {\n    type: FormFieldType.autocomplete,\n    filters: FORM_FILES_IMAGE_FILTER,\n    forceModal: true,\n    hiddenFields: ['mimeType'],\n    mode: 'tile',\n    pageSize: 20,\n    fixedPosition: true,\n    collectionName: 'files',\n    title: 'BACKGROUND',\n    required: false,\n    columnDefinition: { name: '_downloadURL' }\n  })\n  background: any;\n\n  @Editable('Channels', {\n    title: 'GROUPS',\n    flex: 100,\n    required: true,\n    type: FormFieldType.autocomplete,\n    collectionName: 'groups',\n    filters: [[{ field: 'isRole', operator: { _id: 'neq' }, value: true }, { field: 'type', operator: { _id: 'nin' }, value: ['plan'] }]],\n    hiddenFields: ['isRole', 'type'],\n    idOnly: true,\n    mapTransform: getGroupsTransform,\n    multiple: true,\n    clearable: false\n  })\n  group: string;\n\n  @Editable('Channels', {\n    type: FormFieldType.autocomplete,\n    required: true,\n    collectionName: 'user',\n    clearable: true,\n    multiple: true,\n    columnDefinition: { name: 'username' }\n  })\n  users: Array<User>;\n\n  others: Array<User>;\n\n  lastMessage: any;\n  lastMessageAlternate: boolean;\n  lastMessageDate?: any;\n\n  deleteMessages: Array<any>;\n}\n","import { MessageInterface } from './message.interface';\nimport { Entity, IAcl, Model, Editable, Searchable } from '@shared/data-core';\nimport { FormFieldType } from '@shared/stencil';\n\n@Model({\n  className: 'Message',\n  collectionName: 'messages',\n  fields: ['*', 'from.imageData', 'from.username', 'from.email'],\n  include: ['from']\n})\nexport class Message extends Entity implements MessageInterface {\n  _id?: string;\n  _acl?: IAcl;\n  _lmt?: string;\n  _ect?: string;\n\n  @Editable('Message', {\n    title: 'TO',\n    type: FormFieldType.emailreport,\n    required: true,\n    showUsers: true\n  })\n  @Searchable('Message')\n  to: Array<string>;\n\n  @Editable('Message', { title: 'SUBJECT', required: true, type: FormFieldType.text })\n  @Searchable('Message')\n  title: string;\n\n  @Editable('Message', { title: 'BODY', required: true, type: FormFieldType.textarea })\n  body: string;\n\n  // @Editable('Message', { title: 'FOOTER', type: FormFieldType.textarea })\n  // footer: string;\n\n  actionURL: string;\n  actionText: string;\n\n  @Editable('Message', { title: 'THANKYOU', type: FormFieldType.text })\n  thankyou: string;\n}\n"],"names":["tslib_1.__decorate","Channel","Intercom","IntercomNative","Sentry.init","Sentry.captureException","Sentry.configureScope"],"mappings":"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"}
