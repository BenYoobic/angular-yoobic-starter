!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("big.js"),require("rxjs"),require("@angular/common"),require("@angular/router"),require("rxjs/operators"),require("@shared/translate"),require("@voxeet/voxeet-web-sdk"),require("lodash-es"),require("@angular/core"),require("@shared/common"),require("@sentry/browser"),require("@ionic-native/intercom/ngx"),require("@shared/data-core"),require("@shared/stencil")):"function"==typeof define&&define.amd?define("data-live",["exports","big.js","rxjs","@angular/common","@angular/router","rxjs/operators","@shared/translate","@voxeet/voxeet-web-sdk","lodash-es","@angular/core","@shared/common","@sentry/browser","@ionic-native/intercom/ngx","@shared/data-core","@shared/stencil"],t):t(e["data-live"]={},e.big.js,e.rxjs,e.ng.common,e.ng.router,e.rxjs.operators,e["@shared/translate"],e.VoxeetSdk,e["lodash-es"],e.ng.core,e["@shared/common"],e.Sentry,e.Intercom,e["@shared/data-core"],e.DesignSystem)}(this,function(e,i,a,s,r,u,t,n,d,c,l,p,o,h,f){"use strict";i=i&&i.hasOwnProperty("default")?i["default"]:i,n=n&&n.hasOwnProperty("default")?n["default"]:n;var g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function y(e,t){function n(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var m=function(){return(m=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function v(e,t,n,o){var i,r=arguments.length,s=r<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;0<=a;a--)(i=e[a])&&(s=(r<3?i(s):3<r?i(t,n,s):i(t,n))||s);return 3<r&&s&&Object.defineProperty(t,n,s),s}function b(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function w(o,i){var r,s,a,e,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,s&&(a=2&e[0]?s["return"]:e[0]?s["throw"]||((a=s["return"])&&a.call(s),0):s.next)&&!(a=a.call(s,e[1])).done)return a;switch(s=0,a&&(e=[2&e[0],a.value]),e[0]){case 0:case 1:a=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,s=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(a=0<(a=u.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3])){u.label=e[1];break}if(6===e[0]&&u.label<a[1]){u.label=a[1],a=e;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(e);break}a[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(o,u)}catch(t){e=[6,t],s=0}finally{r=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,i,r=n.call(e),s=[];try{for(;(void 0===t||0<t--)&&!(o=r.next()).done;)s.push(o.value)}catch(a){i={error:a}}finally{try{o&&!o.done&&(n=r["return"])&&n.call(r)}finally{if(i)throw i.error}}return s}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),v([h.Editable("Channel",{type:f.FormFieldType.autocomplete,collectionName:"user",multiple:!0,subQuery:{field:"usersRef",values:"_id",collectionName:"user"},subQueryOverride:{field:"usersRef",values:"_id",collectionName:"user"}}),b("design:type",Array)],t.prototype,"users",void 0),t=v([h.Model({className:"Channel",collectionName:"channel",fields:null,include:["users"],searchSubquery:{collectionName:"user",field:"usersRef",values:"_id"}})],t)}(h.Entity),S=function F(e,t,n,o){void 0===o&&(o="YOOBIC"),this.id=e,this.username=t,this.image=n,this.appTitle=o},x=function(){function e(e,t,n,o,i,r){this.authentication=e,this.session=t,this.translate=n,this.log=o,this.push=i,this.coreConfig=r,this.onlineUsers=new Map,this._supportId="53fb03c6546847ee0536386a",this._mainChannel="yoobicchannel",this._supportPrefix="support_",this._groupPrefix="group_",this._channels={},this._presenceSubject=new a.Subject,this._messageSubject=new a.Subject,this._statusSubject=new a.Subject,this._parentSubscription=new a.Subscription}return Object.defineProperty(e.prototype,"supportId",{get:function(){return this._supportId},enumerable:!0,configurable:!0}),e.prototype.changeState=function(e,t){return this.pubnub.setState({uuid:this.sender.id,channels:e,state:t}).then(function(e){return e.state})},e.prototype.setIsTyping=function(e,t){return this.changeState([e],{isTyping:t.toString()})},e.prototype.isOnline=function(e){return this.onlineUsers.has(e)},e.prototype.isPresent=function(e,t){return void 0===t&&(t=this._mainChannel),this.pubnub.whereNow({uuid:e}).then(function(e){return d.includes(e.channels,t)})["catch"](function(e){return!1})},e.prototype.getChannelId=function(e,t){return e<t?e+"_"+t:t+"_"+e},e.prototype.getSupportChannelId=function(e){return this._supportPrefix+this.supportId+"_"+e},e.prototype.isSupportChannel=function(e){return 0<=e.indexOf(this._supportPrefix)},e.prototype.parseSupportChannel=function(e){return e.replace(this._supportPrefix,"").replace(this._supportId+"_","")},e.prototype.getGroupChannelId=function(e){return this._groupPrefix+e},e.prototype.isGroupChannel=function(e){return 0===e.indexOf(this._groupPrefix)},e.prototype.parseGroupChannel=function(e){return e.replace(this._groupPrefix,"")},e.prototype.getHistory=function(e,t,n){return void 0===t&&(t=10),this.pubnub?a.from(this.pubnub.history({channel:e,count:t,reverse:!1,start:n})).pipe(u.map(function(e){var t=e.messages,n=e.startTimeToken,o=e.endTimeToken;return[t.map(function(e){return d.merge(e.entry,{timetoken:e.timetoken})}),n,o]})):a.of([])},e.prototype.deleteMessages=function(t,e){var n=this,o=e.map(function(e){return n.pubnub.deleteMessages({channel:t,start:Number(new i(e).minus(2)),end:Number(new i(e).plus(2))})});return Promise.all(o).then(function(e){return e})},e.prototype.getChannelTyping=function(e){return e&&this._channels[e]&&this._channels[e].typing?this._channels[e].typing:null},e.prototype.initChannelTyping=function(t,e){var n=this,o=new a.Subject,i=this._presenceSubject.pipe(u.filter(function(e){return e.channel===t&&e.uuid!==n.sender.id}),u.map(function(e){var t=e.uuid,n=e.action,o=e.state;switch(n){case"leave":case"timeout":return[t,!1];case"join":case"state-change":return[t,d.isObject(o)&&"true"===o.isTyping]}})).subscribe(o);return e.add(o),e.add(i),o},e.prototype.join=function(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=!1),!this._channels[t]||this._channels[t].subscription.closed){var o=new a.Subject;if(this._messageSubject){var i=this._messageSubject.pipe(u.filter(function(e){return e.channel===t}),u.map(function(e){return d.merge(e.message,{timetoken:e.timetoken})})).subscribe(o);i.add(o);var r=void 0;n&&(r=this.initChannelTyping(t,i)),this._parentSubscription.add(i),this._channels[t]={messages:o,subscription:i,typing:r}}this.pubnub&&this.pubnub.subscribe({channels:[t],withPresence:e||n})}return this._channels&&this._channels[t]&&this._channels[t].messages?this._channels[t].messages:new a.Subject},e.prototype.leave=function(e){e&&this._channels[e]&&this.pubnub&&(this._channels[e].subscription.unsubscribe(),this.pubnub.unsubscribe({channels:[e]}))},e.prototype.publish=function(e,t){this.pubnub.publish({channel:e,message:t})},e.prototype.sendChatMessage=function(e,t,n,o,i,r,s,a){var u=this;void 0===s&&(s="chat"),void 0===a&&(a={});var c=this.isGroupChannel(e),l="";0<=t.indexOf("ionic-chat-image")?l+=""+this.translate.get("SENDANEWPHOTO"):l+=t.substr(0,50)+"...";var p={channel:e,message:t,type:s,options:a,sender_id:this.sender.id,sender_username:this.sender.username,sender_photo:this.sender.image,receiver_id:n,receiver_username:o,isGroup:c,groupName:c?i.name:null,date_sent:new Date,photo:r?d.pick(r,["_id","value","edit","texts","title","name","missiondescriptionRef","missionRef","missiondataRef","userRef","userDisplayname","address"]):null};(c?i.others.map(function(e){return e._id}):[n]).forEach(function(t){(u.isOnline(t)?u.isPresent(t,e):Promise.resolve(!1)).then(function(e){e||(u.isOnline(t)?(u.publish(t,p),u.push.notifyUserById(t,{title:"SILENTNOTIFICATION",mode:"notification",pendingBadgePath:"pendingBadges._communicate"+(c?".team":".direct"),notificationOptions:{content_available:!0}}).subscribe(function(){})):u.push.notifyUserById(t,{title:(c?i.name+" - ":"")+u.sender.username,body:l,mode:"notification",pendingBadgePath:"pendingBadges._communicate"+(c?".team":".direct"),data:p}).subscribe(function(){}))},function(e){})}),this.publish(e,p)},e.prototype.safeMultiplexMessageObservable=function(e){var n=this;return new a.Observable(function(t){d.forEach(e,function(e){n._parentSubscription.add(n._channels[e].messages.subscribe(function(e){return t.next(e)}))})})},e.prototype.isAvailable=function(){var e=!0;try{PubNub||(e=!1)}catch(t){t instanceof ReferenceError&&(e=!1)}return e},e.prototype.init=function(e){var o=this;if(this.isAvailable()){this._presenceSubject=!this._presenceSubject||this._presenceSubject.closed?new a.Subject:this._presenceSubject,this._messageSubject=!this._messageSubject||this._messageSubject.closed?new a.Subject:this._messageSubject,this._statusSubject=!this._statusSubject||this._statusSubject.closed?new a.Subject:this._statusSubject,this._parentSubscription=!this._parentSubscription||this._parentSubscription.closed?new a.Subscription:this._parentSubscription,this.sender=new S(e._id,h.User.getDisplayName(e),e.imageData),this.pubnub=new PubNub({ssl:!0,keepAlive:!0,announceFailedHeartbeats:!1,heartbeatInterval:600,presenceTimeout:300,publishKey:this.coreConfig.getKey("pubnubPublishKey"),subscribeKey:this.coreConfig.getKey("pubnubSubscribeKey"),uuid:this.sender.id}),this._parentSubscription.add(this._presenceSubject),this._parentSubscription.add(this._messageSubject),this._parentSubscription.add(this._statusSubject),this.pubnub.addListener({presence:function(e){o._presenceSubject&&o._presenceSubject.next&&o._presenceSubject.next(e)},message:function(e){o._messageSubject&&o._messageSubject.next&&o._messageSubject.next(e)},status:function(e){o._statusSubject&&o._statusSubject.next&&(e.error?o._statusSubject.error(e.error):o._statusSubject.next(e))}});var t=this._presenceSubject.pipe(u.filter(function(e){var t=e.uuid,n=e.channel;return t!==o.sender.id&&n===o._mainChannel})).subscribe(function(e){switch(e.action){case"leave":o.onlineUsers["delete"](e.uuid);break;case"join":case"state-change":o.onlineUsers.set(e.uuid,e.state||{});break;case"timeout":o.onlineUsers.set(e.uuid,null);break;case"interval":d.each(e.join,function(e){o.onlineUsers.set(e,{})}),d.each(e.leave,function(e){o.onlineUsers["delete"](e)}),e.here_now_refresh&&e.channel===o._mainChannel&&o.updateOnlineUsers()}});this._parentSubscription.add(t);var n=[];return this.join(this._mainChannel,!0),this.updateOnlineUsers(),n.push(this._mainChannel),this.join(this.sender.id),n.push(this.sender.id),!this.authentication.isAdmin()&&this.session.groups&&this.session.groups.forEach(function(e){o.join(e),n.push(e)}),this.safeMultiplexMessageObservable(n)}},e.prototype.updateOnlineUsers=function(){var t=this;this.pubnub.hereNow({channels:[this._mainChannel],includeUUIDs:!0}).then(function(e){t.onlineUsers.clear(),e.channels[t._mainChannel].occupants.forEach(function(e){t.onlineUsers.set(e.uuid,e.state||{})})})},e.prototype.disconnect=function(){this.sender&&this.sender.id&&this.pubnub&&(this.pubnub.unsubscribeAll(),this.pubnub.removeAllListeners(),this._channels={},this.pubnub.stop()),this._parentSubscription&&this._parentSubscription.unsubscribe(),delete this._presenceSubject,delete this._messageSubject,delete this._statusSubject,delete this._parentSubscription},e.prototype.registerDevice=function(t,e,n){var o=this;this.pubnub.push.addChannels({device:t,channels:[e],pushGateway:n},function(e){e?o.log.log("pubnub registered error "+t,e):o.log.log("pubnub registered success "+t)})},e.prototype.unregisterDevice=function(t,e,n){var o=this;this.pubnub.push.removeChannels({device:t,channels:[e],pushGateway:n},function(e){e?o.log.log("pubnub unregistered error "+t,e):o.log.log("pubnub unregistered success "+t)})},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:h.Authentication},{type:h.Session},{type:t.Translate},{type:l.Log},{type:h.Push},{type:l.CoreConfig}]},e}(),U=function(){function e(e,t,n,o){this.broker=e,this.pubnub=t,this.session=n,this.translate=o}return e.prototype.createChannels=function(e){var o=this;return new a.Observable(function(n){o.broker.save("channels",e).subscribe(function(t){o.hydrateOthers(t,!0),o.updateChannels(t).subscribe(function(e){n.next(t),n.complete()})})})},e.prototype.getChannelsById=function(e){var n=this;return this.broker.getAll("channels",null,null,null,[[{field:"channel",operator:{_id:"eq"},value:e}]]).pipe(u.map(function(e){if(e&&e.data&&0<e.data.length){var t=e.data[0];return n.hydrateOthers(t,!0),t}return null}))},e.prototype.getChannelById=function(e){var n=this;return this.broker.getAll("channel",null,null,null,[[{field:"channel",operator:{_id:"eq"},value:e}]]).pipe(u.map(function(e){if(e&&e.data&&0<e.data.length){var t=e.data[0];return n.hydrateOthers(t,!1),t}return null}))},e.prototype.update=function(e){return delete(e=Object.assign({},e)).others,this.broker.save("channel",e)},e.prototype.deleteChannel=function(e){return this.broker["delete"]("channel",e._id)},e.prototype.updateChannels=function(e){return delete(e=Object.assign({},e)).others,this.broker.save("channels",e)},e.prototype.deleteChannels=function(e){return this.broker["delete"]("channels",e._id)},e.prototype.getFilter=function(e,t,n){var o=[{field:"usersRef",operator:{_id:"inq"},value:[{_id:e._id}]}];return t&&o.push({field:"usersRef",operator:{_id:"inq"},value:[{_id:t._id}]}),n||o.push({field:"usersRef",operator:{_id:"nin"},value:h.Users.adminIds}),C(o,[{field:"channel",operator:{_id:"like"},value:"_"},{field:"isSupport",operator:{_id:"eq"},value:!0===n}])},e.prototype.getChannelsFilter=function(e){return[{field:"usersRef",operator:{_id:"inq"},value:[{_id:e._id}]}]},e.prototype.hydrateOthers=function(e,t){var n=this;return void 0===t&&(t=!1),e&&e.users&&(e.others=e.users.filter(function(e){return e._id!==n.session.userId})),!t||e.channel&&e.channel.startsWith("group_")||(e.channel="group_"+e._id),e},e.prototype.getByUsers=function(o,i,r){var s=this;return new a.Observable(function(n){s.broker.getAll("channel",null,null,null,[s.getFilter(o,i,r)]).subscribe(function(e){var t;0<e.data.length?(t=e.data[0],s.hydrateOthers(t),n.next(t),n.complete()):(t={usersRef:r?[s.pubnub.supportId,o._id]:[o._id,i._id],channel:r?s.pubnub.getSupportChannelId(o._id):s.pubnub.getChannelId(o._id,i._id),isSupport:!0===r,isFavorite:!1,_tenantRef:i?i._tenantRef:o._tenantRef,users:r?[{_id:s.pubnub.supportId,username:"smartin@yoobic.com",firstName:"Sarah",lastName:"Martin",imageData:"http://res.cloudinary.com/www-yoobic-com/image/upload/a_exif/v1466421996/jv0vc0yizwqefj22iirh.png"},o]:[o,i]},s.broker.setAcl(t,null,null,null,i?[o._id,i._id]:[o._id]),s.update(t).subscribe(function(e){s.hydrateOthers(e),n.next(e),n.complete()}))})})},e.prototype.getSupportByUser=function(e){return this.getByUsers(e,null,!0)},e.prototype.getTransform=function(e,o){var i=this;return void 0===o&&(o=!1),function(n){var e=[];return new a.Observable(function(t){n.data&&n.data.map&&(o||(n.data=d.uniqBy(n.data,"channel")),e=n.data.map(function(e){return i.hydrateOthers(e,o),e.others&&0<e.others.length?(o||(e.isOnline=i.pubnub.isOnline(e.others[0]._id)),e):undefined}).filter(function(e){return e!==undefined})),0===e.length?(t.next({count:0,data:[]}),t.complete()):a.forkJoin(e.map(function(o){return i.pubnub.getHistory(o.channel,1).pipe(u.map(function(e){if(0<e.length){o.lastMessage=null,o.lastMessageAlternate=null,o.lastMessageDate="";var t=e[0];if(0<t.length){var n=t[0];(!o.deleteMessages||o.deleteMessages.indexOf(n.date_sent)<0)&&(o.lastMessage=n.message,o.lastMessageDate=n.date_sent,o.lastMessage&&0<o.lastMessage.indexOf("ionic-chat-image")&&(o.lastMessage=i.translate.get("PHOTO")),o.lastMessageAlternate=n.sender_id!==i.session.userId)}}return o}))})).subscribe(function(e){e=d.orderBy(e,["lastMessageDate"],["desc"]),t.next({count:n.count,data:e}),t.complete()})})}},e.prototype.getTransformChannel=function(e){return this.getTransform(e,!1)},e.prototype.getTransformChannels=function(e){return this.getTransform(e,!0)},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:h.Broker},{type:x},{type:h.Session},{type:t.Translate}]},e}(),j=function(){function e(e,t,n){this.platformId=e,this.rendererFactory=t,this.document=n,this.isInitialized=!1,s.isPlatformBrowser(this.platformId)&&(this.renderer2=this.rendererFactory.createRenderer(this.document,{id:"-1",encapsulation:c.ViewEncapsulation.None,styles:[],data:{}}))}return e.prototype.init=function(e){void 0===e&&(e={appId:""}),this.config=e,this.isInitialized||(this.isInitialized=!1)},e.prototype.boot=function(e){var n=this;void 0===e&&(e={});var t=e.app_id,o=function r(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(o=Object.getOwnPropertySymbols(e);i<o.length;i++)t.indexOf(o[i])<0&&(n[o[i]]=e[o[i]])}return n}(e,["app_id"]);s.isPlatformBrowser(this.platformId)&&(t!==this.config.appId&&(this.config.appId=t||this.config.appId,window.Intercom&&this.shutdown()),this.loadIntercom(this.config,function(e){var t=m({},o,{app_id:n.config.appId});return window.Intercom("boot",t)}))},e.prototype.shutdown=function(){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("shutdown")},e.prototype.update=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return e?window.Intercom("update",e):window.Intercom("update")},e.prototype.hide=function(){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("hide")},e.prototype.show=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return e?window.Intercom("show"):this.showNewMessage(e)},e.prototype.showMessages=function(){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("showMessages")},e.prototype.showNewMessage=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return e?window.Intercom("showNewMessage",e):window.Intercom("showNewMessage")},e.prototype.trackEvent=function(e,t){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return t?window.Intercom("trackEvent",e,t):window.Intercom("trackEvent",e)},e.prototype.getVisitorId=function(){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("getVisitorId")},Object.defineProperty(e.prototype,"visitorId",{get:function(){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("getVisitorId")},enumerable:!0,configurable:!0}),e.prototype.onShow=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("onShow",e)},e.prototype.onHide=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("onHide",e)},e.prototype.onUnreadCountChange=function(e){if(s.isPlatformBrowser(this.platformId)&&window.Intercom)return window.Intercom("onUnreadCountChange",e)},e.prototype.injectIntercomScript=function(e,t){var n=this.document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://widget.intercom.io/widget/"+this.id,n.attachEvent?n.attachEvent("onload",t):n.addEventListener("load",t,!1),this.renderer2&&this.renderer2.appendChild&&this.renderer2.appendChild(this.document.head,n),window.Intercom("update",e)},e.prototype.loadIntercom=function(e,t){this.id=e.appId;var n=window,o=n.Intercom;if("function"==typeof o)o("reattach_activator"),o("update",e);else{var i=function(){i.c(arguments)};i.q=[],i.c=function(e){i.q.push(e)},n.Intercom=i,this.injectIntercomScript(e,t)}},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:Object,decorators:[{type:c.Inject,args:[c.PLATFORM_ID]}]},{type:c.RendererFactory2},{type:undefined,decorators:[{type:c.Inject,args:[s.DOCUMENT]}]}]},e}(),E=function(){function e(e,t,n,o,i,r){var s=this;this.coreConfig=e,this.config=t,this.intercomNative=n,this.authentication=o,this.session=i,this.webIntercom=r,this.unreadCount$=new a.Subject,this.authentication.login$.subscribe(function(){return s.init()}),this.authentication.logout$.subscribe(function(){return s.logout()}),this.authentication.profileUpdated$.subscribe(function(e){return s.identify(e)})}return Object.defineProperty(e.prototype,"app_id",{get:function(){return"Production"===this.config.serverName?this.coreConfig.getKey("intercomIdProd"):this.coreConfig.getKey("intercomIdDev")},enumerable:!0,configurable:!0}),e.prototype.isEnabled=function(){return!this.config.isE2E&&!(this.coreConfig.isLocalhost()&&!this.coreConfig.isCordova())},e.prototype.init=function(){this.isEnabled()&&(this.coreConfig.isCordova()?this.authentication.isLoggedIn()&&this.session.userId&&(this.intercomNative.setLauncherVisibility("GONE"),this.intercomNative.registerIdentifiedUser({userId:this.session.userId})):(this.webIntercom.init({appId:this.app_id}),this.webIntercom.boot({app_id:this.app_id,hide_default_launcher:!0})))},e.prototype.registerForPush=function(){this.coreConfig.isCordova()&&this.intercomNative.registerForPush()},e.prototype.logout=function(){this.isEnabled()&&(this.coreConfig.isCordova()?this.intercomNative.reset():this.webIntercom.shutdown())},e.prototype.identify=function(e){var t=this;if(this.isEnabled()&&e){var n={user_id:e._id,language_override:e.language,avatar:{type:"avatar",image_url:e.imageData},email:e.email||e.username,username:e.username,firstName:e.firstName,lastName:e.lastName,createdAt:f.unix(f.toDate(e._ect)),phone:e.telephone,gender:e.gender,device:e.device,target:this.coreConfig.getFullAppName(),company:e.company,role:e.role,tenant:e._tenant?e._tenant.name:"",hide_default_launcher:!0};this.coreConfig.isCordova()?(this.intercomNative.updateUser(n),this.intercomNative.unreadConversationCount().then(function(e){t.unreadCount$.next(e)})):(this.webIntercom.update(n),this.webIntercom.onUnreadCountChange(function(e){t.unreadCount$.next(e)}))}},e.prototype.trackEvent=function(e,t){this.coreConfig.isCordova()?this.intercomNative.logEvent(e,t):this.webIntercom.trackEvent(e,t)},e.prototype.update=function(e){this.coreConfig.isCordova()?this.intercomNative.updateUser(e):this.webIntercom.update(e)},e.prototype.show=function(){this.isEnabled()&&(this.coreConfig.isCordova()?this.intercomNative.displayMessenger():this.webIntercom.show())},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:l.CoreConfig},{type:h.Config},{type:o.Intercom},{type:h.Authentication},{type:h.Session},{type:j}]},e}(),k=function(){function e(e,t){this.broker=e,this.rq=t}return e.prototype.getJsonMessage=function(e){return{to:e.to,content:{title:e.title,body:e.body,actionURL:e.actionURL,actionText:e.actionText,action:!!e.actionURL,thankyou:e.thankyou}}},e.prototype.sendMail=function(e){return this.rq.post(this.apiUrl+"mail",this.getJsonMessage(e))},e.prototype.unblockEmails=function(e){return this.rq.post(this.broker.getApiUrl()+"businesslogic/unblockEmails",{emails:e})},Object.defineProperty(e.prototype,"apiUrl",{get:function(){return this.broker.getApiUrl()+"Messages/"},enumerable:!0,configurable:!0}),e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:h.Broker},{type:h.Requestor}]},e}(),O=function(){function e(e,t,n,o,i,r,s,a,u,c){this.network=e,this.push=t,this.session=n,this.localStorage=o,this.authentication=i,this.coreConfig=r,this.config=s,this.log=a,this.injector=u,this.intercom=c,this.loadAnalytics()}return e.prototype.isEnabled=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!1),!this.network.isOffline()&&(!(this.coreConfig.isLocalhost()&&!this.coreConfig.isCordova())&&("prod"===this.coreConfig.getMode()&&(!(this.config.isE2E&&!t)&&(!(e&&!this.authentication.isLoggedIn())&&(!this.session.user||!this.session.user.disableTracking)))))},e.prototype.loadSessionStack=function(){var r=this;return new Promise(function(e,t){try{if(!window.SessionStack&&r.isEnabled(!1,!0)){r.coreConfig.isIOS()&&r.coreConfig.isCordova()&&Object.defineProperty(window.document,"cookie",{enumerable:!0,configurable:!0,get:function(){return r.localStorage.get("document-cookie")},set:function(e){var t=r.localStorage.get("document-cookie");if(t){var n=t.split("; "),o=e.split("=")[0];(n=n.filter(function(e){return e.indexOf(o+"=")<0})).push(e.trim()),t=n.join("; ")}else t=e;r.localStorage.set("document-cookie",t)}}),window.SessionStackKey="SessionStack",window.SessionStack=window.SessionStack||{t:r.coreConfig.isIonic()?r.coreConfig.getKey("sessionStackMobile"):r.coreConfig.getKey("sessionStackWeb"),q:[]},["start","stop","identify","getSessionId","log","setOnDataCallback"].forEach(function(e){window.SessionStack[e]=window.SessionStack[e]||function(){window.SessionStack.q.push([e].concat([].slice.call(arguments,0)))}});var n=document.createElement("script");n.async=!0,n.src="https://cdn.sessionstack.com/sessionstack.js",n.onload=function(){e(!0)},n.onerror=function(e){t(e)};var o=document.getElementsByTagName("script")[0];o.parentNode.insertBefore(n,o)}else e(!1)}catch(i){t(i)}})},e.prototype.getSessionStackSession=function(){var n=this;return new Promise(function(t){window.SessionStack?window.SessionStack.getSessionId(function(e){n.log.log("SessionStack sessionid",e),t(e)}):t(null)})},e.prototype.getSessionStackUrl=function(){return"https://app.sessionstack.com/player/#/sessions/"},e.prototype.sendSessionStackError=function(e){},e.prototype.loadAnalytics=function(){if(this.isEnabled(!1)){var n=window.analytics=window.analytics||[];if(!n.initialize)if(n.invoked)this.log.error("Segment snippet included twice.");else{n.invoked=!0,n.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","debug","page","once","off","on"],n.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);return e.unshift(t),n.push(e),n}};for(var e=0;e<n.methods.length;e++){var t=n.methods[e];n[t]=n.factory(t)}n.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n)},n.SNIPPET_VERSION="4.0.0",n.load("Production"===this.config.serverName?this.coreConfig.getKey("segmentApiWriteKey"):this.coreConfig.getKey("segmentApiWriteKeyDev")),n.page()}}},e.prototype.track=function(e,t){if(e&&""!==e&&(e=e.split(" ").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}).join(" "),this.session.debugEvent&&this.log.log("EVENT",e,t),this.isEnabled()&&window.analytics))try{window.analytics.track(e,d.merge(this.globalTrackedProps(this.session.user),t))}catch(n){}},e.prototype.page=function(e,t,n){if(this.isEnabled()&&window.analytics)try{window.analytics.page(t,e,d.merge(this.globalTrackedProps(this.session.user),n))}catch(o){}},e.prototype.identify=function(n){var o=this;n&&setTimeout(function(){if(o.isEnabled()&&window.analytics)try{var e={user_id:n._id||"",user_tags:n.tags||"",email:n.email||n.username||"",operating_system:o.coreConfig.getPlatform(),avatar:n.imageData||"",phone:n.telephone||"",gender:n.gender||"",target:o.coreConfig.getFullAppName(),version:o.coreConfig.getAppVersion(),is_dark_theme:l.Colors.isDarkTheme()};window.analytics.identify(n._id,d.merge(o.globalTrackedProps(n),e))}catch(t){}o.intercom.identify(n),setTimeout(function(){if(window&&window.FS&&window.FS.getCurrentSessionURL){var e=window.FS.getCurrentSessionURL();o.intercom.update({fullstoryURL:e})}},2e3)},3e3)},e.prototype.intercomRegisterForPush=function(){this.intercom.registerForPush()},e.prototype.globalTrackedProps=function(e){var t={user_groups:this.authentication.isAdmin()?[]:this.session.groups,user_username:e.username||"",user_firstname:e.firstName||"",user_lastname:e.lastName||"",user_language:e.language||"",user_company_name:e.company||"",user_tenant:e._tenant?e._tenant.name:null,user_role:e.role||"",user_roles:this.session.roles||[],user_environment:this.config.serverName.toUpperCase()};try{var n;n=this.injector.get(r.Router),t=d.merge(t,{page:n.url})}catch(o){}return t},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:l.Network},{type:h.Push},{type:h.Session},{type:l.LocalStorage},{type:h.Authentication},{type:l.CoreConfig},{type:h.Config},{type:l.Log},{type:c.Injector},{type:E}]},e}(),P=function(){function e(e,t){this.rq=e,this.config=t}return e.prototype.getToken=function(){return this.rq.get(this.config.apiUrl+"Twilio/getToken").pipe(u.map(function(e){return e.TwilioVideoToken}))},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:h.Requestor},{type:h.Config}]},e}(),M=function(){function e(e,t,n,o,i){this.session=e,this.log=t,this.coreConfig=n,this.pubnub=o,this.translate=i,this.constraints={audio:!0,video:{width:{ideal:4096},height:{ideal:2160}}}}return e.prototype.useCordova=function(){return this.coreConfig.isCordova()&&window.Voxeet},e.prototype.init=function(){return this.isInit?this.reconnect():(this.isInit=!0,this.onInitUserInfo(),this.useCordova()&&window.Voxeet?this.onInitCordova():this.onInitWeb()),Promise.resolve()},e.prototype.onInitUserInfo=function(){this.session&&this.session.user?this.userInfo=this.convertUserInfo(this.session.user):this.userInfo=this.convertUserInfo()},e.prototype.convertUserInfo=function(e){var t="",n="",o="";return e&&(e._id&&(t=e._id),h.User.getDisplayName(e)&&(n=h.User.getDisplayName(e)),e.imageData&&(o=e.imageData)),{name:n,externalId:t,avatarUrl:o}},e.prototype.onInitCordova=function(){var t=this;this.voxeet=window.Voxeet,this.voxeet&&this.voxeet.initialize(this.coreConfig.getKey("voxeetKey"),this.coreConfig.getKey("voxeetSecret")).then(function(e){t.voxeetUserId=e,t.log.log("voxeet is init for cordova:",t.voxeetUserId),t.voxeet.appearMaximized(!0)}).then(function(){t.log.log("appearMaximized"),t.voxeet.defaultBuiltInSpeaker(!0)}).then(function(){t.log.log("defaultBuiltInSpeaker"),t.voxeet.defaultVideo(!0)}).then(function(){t.log.log("defaultVideo"),t.voxeet.connect(t.getUserInfo())}).then(function(){t.log.log("voxeet connected")})},e.prototype.onInitWeb=function(){var t=this;if(this.voxeet=new n,this.voxeet)return this.voxeet.initialize(this.coreConfig.getKey("voxeetKey"),this.coreConfig.getKey("voxeetSecret"),this.getUserInfo()).then(function(e){t.voxeetUserId=e,t.log.log("voxeet is init for web:",t.voxeetUserId)})["catch"](function(e){t.log.error(e)})},e.prototype.getUserInfo=function(){return this.useCordova()?new window.UserInfo(this.userInfo.externalId,this.userInfo.name,this.userInfo.avatarUrl):this.userInfo},e.prototype.createConference=function(e){return this.useCordova()?this.voxeet.create({conferenceAlias:e,params:{videoCodec:"H264"}}):this.voxeet.createConference({alias:e})},e.prototype.joinConference=function(e,t){return this.useCordova()?this.voxeet.join(e.conferenceId?e.conferenceId:e):this.voxeet.joinConference(e.conferenceId?e.conferenceId:e,t||{constraints:{video:!0,audio:!0},user:{name:h.User.getDisplayName(this.session.user),externalId:this.session.userId,avatarUrl:this.session.user.imageData},audio3D:!0,conference:{params:{videoCodec:"H264",liveRecording:!0}}})},e.prototype.hasWebCam=function(){if(window&&window.navigator){var n=window.navigator.mediaDevices;return n.getMedia=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia,new Promise(function(e,t){n.getMedia({video:!0}).then(function(){e(!0)},function(){return e(!1)})})}return Promise.resolve(!1)},e.prototype.hasMicrophone=function(){if(window&&window.navigator){var n=window.navigator.mediaDevices;return n.getMedia=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia,new Promise(function(e,t){n.getMedia({audio:!0}).then(function(){e(!0)},function(){return e(!1)})})}return Promise.resolve(!1)},e.prototype.getConstraint=function(){var t=this.constraints,e=this.hasWebCam(),n=this.hasMicrophone();return e.then(function(e){e||(t.video=!1)}),n.then(function(e){e||(t.audio=!1)}),t},e.prototype.inviteParticipants=function(e,t){var n=this;return this.useCordova()?this.voxeet.invite(e,t.map(function(e){var t=n.convertUserInfo(e);return new window.UserInfo(t.externalId,t.name,t.avatarUrl)})):this.voxeet.invite(e,t.map(function(e){return e._id}))},e.prototype.leaveConference=function(e){return void 0===e&&(e=!0),this.useCordova()?this.voxeet.leave():this.voxeet.leaveConference(e)},e.prototype.addListener=function(e,t){!this.useCordova()&&e&&t&&this.voxeet.on(e,t)},e.prototype.removeListener=function(e,t){!this.useCordova()&&e&&t&&this.voxeet.removeListener(e,t)},e.prototype.removeAllListeners=function(){return this.voxeet&&this.voxeet.removeAllListeners?this.voxeet.removeAllListeners():Promise.resolve()},e.prototype.getUserId=function(){return this.voxeetUserId},e.prototype.startVideo=function(e,t){if(!this.useCordova())return this.voxeet.startVideoForUser(e||this.getUserId(),t||this.constraints)},e.prototype.stopVideo=function(e){if(!this.useCordova())return this.voxeet.stopVideoForUser(e||this.getUserId())},e.prototype.startAudio=function(e){if(!this.useCordova())return this.voxeet.startAudioForUser(e||this.getUserId())},e.prototype.stopAudio=function(e){if(!this.useCordova())return this.voxeet.stopAudioForUser(e||this.getUserId())},e.prototype.muteUser=function(e,t){if(!this.useCordova())return this.voxeet.muteUser(t||this.getUserId(),e)},e.prototype.toggleMute=function(e){if(!this.useCordova())return this.voxeet.toggleMute(e||this.getUserId())},e.prototype.setUserPosition=function(e,t,n){if(!this.useCordova())return this.voxeet.setUserPosition(e,t,n)},e.prototype.getCurrentSession=function(){return this.useCordova(),this.voxeet},e.prototype.getEnumerateAudioDevices=function(e){return this.useCordova()?Promise.resolve(null):this.voxeet.enumerateAudioDevices(e)},e.prototype.getEnumerateVideoDevices=function(){return this.useCordova()?Promise.resolve(null):this.voxeet.enumerateVideoDevices()},e.prototype.selectAudioInput=function(e,t){return this.voxeet.selectAudioInput(e,t)},e.prototype.selectAudioOutput=function(e,t){return this.voxeet.selectAudioOutput(e,t)},e.prototype.selectVideoInput=function(e,t){return this.voxeet.selectVideoInput(e,t)},e.prototype.startVideoForUser=function(e,t){return this.voxeet.startVideoForUser(e,t)},e.prototype.stopVideoForUser=function(e,t){return this.voxeet.stopVideoForUser(e,t)},e.prototype.startAudioForUser=function(e,t){return this.voxeet.startAudioForUser(e,t)},e.prototype.stopAudioForUser=function(e,t){return this.voxeet.stopAudioForUser(e,t)},e.prototype.startScreenShare=function(e){return this.voxeet.startScreenShare(e)},e.prototype.stopScreenShare=function(){return this.voxeet.stopScreenShare()},e.prototype.startRecording=function(){return this.voxeet.startRecording()},e.prototype.stopRecording=function(){return this.voxeet.stopRecording()},e.prototype.replayRecording=function(e,t){return e&&this.voxeet&&this.voxeet.replayConference?this.voxeet.replayConference(e,t||0):Promise.reject("ConferenceId is not provided")},e.prototype.shareVideo=function(e){return this.voxeet.videoPresentation.start(e)},e.prototype.updateMediaSettings=function(e){var t=[],n=e.microphone,o=e.video;return n&&n.deviceId&&t.push(this.selectAudioInput(n.deviceId)),o&&o.deviceId&&t.push(this.selectVideoInput(o.deviceId)),t.length<1&&t.push(Promise.resolve()),t},e.prototype.sendChatMessage=function(t,e,n){var o=this,i=t.filter(function(e){return e._id!==o.session.userId});i&&(this.inviteParticipants(n,i),i.map(function(e){return e._id}).forEach(function(e){o.pubnub.sendChatMessage(e,o.translate.get("VIDEOCALLCALLING",{user:h.User.getDisplayName(o.session.user)}),e,null,null,null,"videocall",{conferenceId:n,user:o.session.user,users:t})}))},e.prototype.disconnect=function(){var e=this;this.voxeet&&d.isFunction(this.voxeet.disconnect)&&(this.isInit=!1,this.voxeet.disconnect().then(function(){e.log.log("voxeet disconnected")}))},e.prototype.reconnect=function(){this.useCordova()&&this.voxeet.connect(this.getUserInfo())},e.prototype.sendRecordedConferenceId=function(e,t){e&&t&&t.others&&t.others[0]&&t.others[0]._id&&this.pubnub.sendChatMessage(t.channel,e,t.others[0]._id,null,t,{},"conference")},e.prototype.showNoWebCamAlert=function(){f.showAlert(this.translate.get("NOWEBCAM"),[this.translate.get("OK")],null,"")},e.prototype.showFailedConnectAlert=function(){f.showAlert(this.translate.get("CONFERENCEFAILED"),[this.translate.get("OK")],null,"")},e.prototype.showCallerLeftAlert=function(){return f.showAlert("",[this.translate.get("OK")],"",this.translate.get("CALLERLEFT"))},e.prototype.showRecieverLeft=function(){return f.showAlert("",[this.translate.get("OK")],"",this.translate.get("RECIEVERLEFT"))},e.prototype.showRecordCompleteAlert=function(){return f.showAlert("",[this.translate.get("OK")],"",this.translate.get("CALLRECORDED"))},e.prototype.setVideoToast=function(e){this.videoToast=e},e.prototype.setVideoModal=function(e){this.videoModal=e},e.prototype.closeVideoModal=function(){this.videoModal&&(f.closeModal(this.videoModal),this.videoModal=null)},e.prototype.dismissVideoToast=function(){this.videoToast&&(this.videoToast.dismiss(),this.videoToast=null)},e.prototype.onSendDeclineMessage=function(e){e&&e.options&&e.sender_id&&this.pubnub.sendChatMessage(e.sender_id,this.translate.get("VIDEOCALLCANCEL",{user:h.User.getDisplayName(this.session.user)}),this.session.user._id,null,null,null,"videocallcancel",{declineCall:!0})},e.prototype.onSendCancelNotificationMessage=function(e,t){var n=this,o=e.filter(function(e){return e._id!==n.session.userId});o&&o.map(function(e){return e._id}).forEach(function(e){n.pubnub.sendChatMessage(e,n.translate.get("VIDEOCALLCANCEL",{user:h.User.getDisplayName(n.session.user)}),e,null,null,null,"videocallcancel",{cancelCall:!0})})},e.prototype.onReceiveDeclineMessage=function(e){var t=this;e&&e.options&&e.sender_id&&this.session.user._id&&(e.options.declineCall&&e.sender_id!==this.session.user._id?f.showAlert("",[this.translate.get("OK")],"",this.translate.get("USERDECLINECALL")).then(function(e){t.closeVideoModal()}):e.options.cancelCall&&this.dismissVideoToast())},e.decorators=[{type:c.Injectable}],e.ctorParameters=function(){return[{type:h.Session},{type:l.Log},{type:l.CoreConfig},{type:x},{type:t.Translate}]},e}(),N=function(){function o(e,t,n,o,i){var r=this;if(this.log=e,this.zone=t,this.trackService=n,this.coreConfig=o,this.config=i,this.isEnabled())try{var s=this.config.getCurrentConfig().initialSelection;this.zone.runOutsideAngular(function(){var e={dsn:r.coreConfig.getKey("sentryClientKey"),release:r.coreConfig.getAppVersion(),environment:(s?s._id:"")||"prod"};p.init(e)})}catch(a){this.log.error(a)}}return o.prototype.isEnabled=function(){return"prod"===this.coreConfig.getMode()&&this.coreConfig.getKey("sentryClientKey")&&0<this.coreConfig.getKey("sentryClientKey").length},o.prototype.handleError=function(t){var n=!1;if(o.disabledErrorMessages.forEach(function(e){t&&t.message&&0<=t.message.indexOf(e)&&(n=!0)}),!n)if(t&&this.isEnabled()){try{p.captureException(t.originalError||t)}catch(e){}this.trackService.track("App Crash",{error:t.originalError||t}),this.log.error(t.originalError||t)}else t&&"dev"===this.coreConfig.getMode()&&this.log.error(t)},o.prototype.identify=function(t,o,i){var r=this;if(this.isEnabled()&&t)try{this.trackService.getSessionStackSession().then(function(n){p.configureScope(function(e){e.setUser({email:o,username:i,id:t}),e.addEventProcessor(function(t){return function e(t,s,a,u){return new(a||(a=Promise))(function(e,n){function o(e){try{r(u.next(e))}catch(t){n(t)}}function i(e){try{r(u["throw"](e))}catch(t){n(t)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(o,i)}r((u=u.apply(t,s||[])).next())})}(r,void 0,void 0,function(){return w(this,function(e){return t.contexts=t.contexts||{},t.contexts.sessionstack={session_id:n,timestamp:(new Date).getTime()},t.extra=t.extra||{},window&&window.FS&&window.FS.getCurrentSessionURL&&(t.extra.fullstoryUrl=window.FS.getCurrentSessionURL()),[2,t]})})})})})}catch(e){}},o.disabledErrorMessages=["Cannot read property 'disconnect' of null","PubNub call failed","PubNub call failed, check status for details","InvalidStateError: Failed to execute 'transaction'","Loading chunk","You provided 'undefined' where a stream was expected","Cannot read property 'value' of undefined","Uncaught (in promise): OK","Uncaught (in promise): Error: Timeout","NS_ERROR_NOT_INITIALIZED","Error: No available storage method found"],o.decorators=[{type:c.Injectable}],o.ctorParameters=function(){return[{type:l.Log},{type:c.NgZone},{type:O},{type:l.CoreConfig},{type:h.Config}]},o}(),A=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e=[]),{ngModule:t,providers:C(e,[U,E,o.Intercom,k,x,N,O,P,M,j])}},t.decorators=[{type:c.NgModule,args:[{declarations:[],imports:[h.DataCoreModule],exports:[h.DataCoreModule]}]}],t}(),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),v([h.Editable("Channels",{required:!0,type:f.FormFieldType.text}),h.Searchable("Channels"),b("design:type",String)],t.prototype,"name",void 0),v([h.Editable("Channels",{type:f.FormFieldType.autocomplete,filters:h.FORM_FILES_IMAGE_FILTER,forceModal:!0,hiddenFields:["mimeType"],mode:"tile",pageSize:20,fixedPosition:!0,collectionName:"files",title:"BACKGROUND",required:!1,columnDefinition:{name:"_downloadURL"}}),b("design:type",Object)],t.prototype,"background",void 0),v([h.Editable("Channels",{title:"GROUPS",flex:100,required:!0,type:f.FormFieldType.autocomplete,collectionName:"groups",filters:[[{field:"isRole",operator:{_id:"neq"},value:!0},{field:"type",operator:{_id:"nin"},value:["plan"]}]],hiddenFields:["isRole","type"],idOnly:!0,mapTransform:h.getGroupsTransform,multiple:!0,clearable:!1}),b("design:type",String)],t.prototype,"group",void 0),v([h.Editable("Channels",{type:f.FormFieldType.autocomplete,required:!0,collectionName:"user",clearable:!0,multiple:!0,columnDefinition:{name:"username"}}),b("design:type",Array)],t.prototype,"users",void 0),t=v([h.Model({className:"Channels",collectionName:"channels",fields:["*"],include:["users"]})],t)}(h.Entity),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return y(t,e),v([h.Editable("Message",{title:"TO",type:f.FormFieldType.emailreport,required:!0,showUsers:!0}),h.Searchable("Message"),b("design:type",Array)],t.prototype,"to",void 0),v([h.Editable("Message",{title:"SUBJECT",required:!0,type:f.FormFieldType.text}),h.Searchable("Message"),b("design:type",String)],t.prototype,"title",void 0),v([h.Editable("Message",{title:"BODY",required:!0,type:f.FormFieldType.textarea}),b("design:type",String)],t.prototype,"body",void 0),v([h.Editable("Message",{title:"THANKYOU",type:f.FormFieldType.text}),b("design:type",String)],t.prototype,"thankyou",void 0),t=v([h.Model({className:"Message",collectionName:"messages",fields:["*","from.imageData","from.username","from.email"],include:["from"]})],t)}(h.Entity);e.DataLiveModule=A,e.ChannelInterface=I,e.Channels=T,e.Message=R,e.Channel=U,e.Intercom=E,e.WebIntercom=j,e.Messages=k,e.PubnubSender=S,e.Pubnub=x,e.Track=O,e.TwilioToken=P,e.VideoCall=M,e.SentryErrorHandler=N,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=data-live.umd.min.js.map