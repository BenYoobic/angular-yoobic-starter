!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/forms"),require("@angular/common"),require("@shared/translate"),require("rxjs"),require("@angular/core"),require("@shared/common"),require("rxjs/operators"),require("lodash-es"),require("@shared/data-core"),require("@shared/stencil")):"function"==typeof define&&define.amd?define("data-form",["exports","@angular/forms","@angular/common","@shared/translate","rxjs","@angular/core","@shared/common","rxjs/operators","lodash-es","@shared/data-core","@shared/stencil"],t):t(e["data-form"]={},e.ng.forms,e.ng.common,e["@shared/translate"],e.rxjs,e.ng.core,e["@shared/common"],e.rxjs.operators,e["lodash-es"],e["@shared/data-core"],e.DesignSystem)}(this,function(e,o,s,i,d,r,p,c,F,b,v){"use strict";var a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function n(e,t){function o(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}function l(e,t,o,i){var r,a=arguments.length,n=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;0<=l;l--)(r=e[l])&&(n=(a<3?r(n):3<a?r(t,o,n):r(t,o))||n);return 3<a&&n&&Object.defineProperty(t,o,n),n}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function m(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var i,r,a=o.call(e),n=[];try{for(;(void 0===t||0<t--)&&!(i=a.next()).done;)n.push(i.value)}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=a["return"])&&o.call(a)}finally{if(r)throw r.error}}return n}var y=function(){function f(){}return f.getColor=function(t){return this.colors.find(function o(e){return e.name===t})},f.getColumnDefinition=function(e,t,o,i,r){var a=b.Models.getFieldName(e),n={headerName:b.Models.getFieldTitle(e,t),headerTooltip:b.Models.getFieldTitle(e,t),field:a,minWidth:e.columnDefinition&&e.columnDefinition.width?e.columnDefinition.width:40,width:e.columnDefinition&&e.columnDefinition.width?e.columnDefinition.width:100,hide:!1===e.visible||!!e.columnDefinition&&e.columnDefinition.hidden,sortable:!(e.columnDefinition&&e.columnDefinition.name&&e.columnDefinition&&0<e.columnDefinition.name.length),forceExport:e.forceExport,exportOrder:e.exportOrder,suppressExport:e.suppressExport,menuTabs:["filterMenuTab"]};if(e.type&&(n.type=e.type),o&&0<o.length&&(n.hide=o.indexOf(a)<0),i&&0<=i.indexOf({colId:n.field,sort:"asc"})&&(n.sort="asc"),i&&0<=i.indexOf({colId:n.field,sort:"desc"})&&(n.sort="desc"),n.headerName&&n.headerName.toUpperCase()===n.headerName&&(n.headerName=t.get(n.headerName)),b.Models.isBooleanField(e)?n.cellRenderer="booleanRenderer":b.Models.isVideoField(e)?n.cellRenderer="videoRenderer":b.Models.isPhotoField(e)?n.cellRenderer="photoRenderer":b.Models.isMultiPhotosField(e)?n.cellRenderer="multiphotoRenderer":!0===e.isDistanceField?(n.cellRenderer="distanceRenderer",n.sortable=!1,n.comparator="distanceComparator"):e.type===v.FormFieldType.number?n.cellRenderer="numberRenderer":e.type===v.FormFieldType.date?n.cellRenderer="dateRenderer":b.Models.isDateTimeField(e)?n.cellRenderer="dateTimeRenderer":e.type===v.FormFieldType.time?n.cellRenderer="timeRenderer":e.type===v.FormFieldType.address?n.cellRenderer="addressRenderer":e.type===v.FormFieldType.location?n.cellRenderer="locationRenderer":e.type===v.FormFieldType.starrating?(n.cellRenderer="starratingRenderer",n.cellRendererParams={max:e.max}):e.type===v.FormFieldType.todo?n.cellRenderer="todoRenderer":e.type===v.FormFieldType.timer?n.cellRenderer="timerRenderer":e.type===v.FormFieldType.checklist?n.cellRenderer="checklistRenderer":e.type===v.FormFieldType.autocomplete&&e.collectionName&&b.Models.getModelByCollectionName(e.collectionName)&&b.Models.getModelByCollectionName(e.collectionName).isCustom?n.cellRenderer="customModelRenderer":n.cellRenderer="defaultRenderer",e.columnDefinition&&e.columnDefinition.rendererType)switch(e.columnDefinition.rendererType){case"percentage":n.cellRenderer="percentageRenderer";break;case"duration":n.cellRenderer="durationRenderer";break;case"userfullname":n.cellRenderer="userFullNameRenderer"}return e.columnDefinition&&e.columnDefinition.cellRenderer&&(n.cellRenderer=e.columnDefinition.cellRenderer),n},f.getColumnTypes=function(){return{address:{},audio:{},autocomplete:{},barcode:{},"between-date":{},"between-number":{},button:{},catalog:{},checkbox:{},color:{},date:{},daterange:{},"datetime-local":{},document:{},documentuploader:{},email:{},emailreport:{},filter:{},grid:{},image:{},information:{},inttel:{},invite:{},json:{},location:{},missionfield:{},missionscore:{},number:{},password:{},multiphotos:{},photo:{},productcheck:{},range:{},ranking:{},select:{},selectbuttons:{},selectbuttonsmulti:{},selectimage:{},selectmulti:{},signature:{},starrating:{},string:{},stripecard:{},tel:{},text:{},textarea:{},time:{},timer:{},todo:{},toggle:{},video:{},knob:{},selectchat:{},missingword:{},swipeselect:{},checklist:{},formula:{},videoplayer:{}}},f.getConfig=function(e,t,o,i,r){return{rowHeight:52,rowStyle:{"line-height":"32px"},headerHeight:40,defaultColDef:{sortable:!0,resizable:!0},rowDeselection:!0,rowSelection:e?"multiple":"single",rowModelType:t||"serverSide",rowBuffer:0,maxConcurrentDatasourceRequests:1,infiniteInitialRowCount:i,cacheOverflowSize:2,pagination:!o,paginationPageSize:i,cacheBlockSize:i,suppressPropertyNamesCheck:!0,animateRows:!0,localeText:f.getTranslation(r),columnTypes:f.getColumnTypes()}},f.getPivotConfig=function(e){return{rowHeight:52,rowStyle:{"line-height":"32px"},headerHeight:40,defaultColDef:{sortable:!0,resizable:!0},filter:!0,suppressPreventDefaultOnMouseWheel:!1,suppressPropertyNamesCheck:!0,rememberGroupStateWhenNewData:!0,suppressAggFuncInHeader:!0,groupDefaultExpanded:0,groupSuppressGroupColumn:!0,suppressRowHoverClass:!0,autoGroupColumnDef:{headerName:e.get("GROUP"),cellRenderer:"agGroupCellRenderer",comparator:"defaultGroupComparator"},icons:{menu:'<yoo-icon class="yo-menu"></yoo-icon>',filter:'<yoo-icon class="yo-filter"></yoo-icon>',groupExpanded:'<yoo-icon class="yo-circle-minor"></yoo-icon>',groupContracted:'<yoo-icon class="yo-circle-plus"></yoo-icon>',columnGroupOpened:'<yoo-icon class="yo-nodata"></yoo-icon>',columnGroupClosed:'<yoo-icon class="yo-plus"></yoo-icon>',columnSelectOpen:'<yoo-icon class="yo-nodata"></yoo-icon>',columnSelectClosed:'<yoo-icon class="yo-plus"></yoo-icon>',checkboxChecked:'<yoo-icon class="yo-check"></yoo-icon>',checkboxUnchecked:'<yoo-icon class="yo-circle"></yoo-icon>',checkboxIndeterminate:'<yoo-icon class="yo-circle"></yoo-icon>',sortAscending:'<yoo-icon class="yo-up"></yoo-icon>',sortDescending:'<yoo-icon class="yo-down"></yoo-icon>',columnMoveGroup:'<yoo-icon class="yo-direction-select"></yoo-icon>',dropNotAllowed:'<yoo-icon class="yo-rejected2"></yoo-icon>'},columnTypes:f.getColumnTypes(),localeText:f.getTranslation(e),groupUseEntireRow:!1,groupRowInnerRenderer:"progressRenderer"}},f.getTranslation=function(e){return{next:'<i class="yo-right"></i>',previous:'<i class="yo-left"></i>',page:" ",of:"/",more:e.get("AGGRIDMORE"),to:" - ",loadingOoo:e.get("AGGRIDLOADINGOOO"),selectAll:e.get("AGGRIDSELECTALL"),searchOoo:e.get("AGGRIDSEARCHOOO"),blanks:e.get("AGGRIDBLANKS"),filterOoo:e.get("AGGRIDFILTEROOO"),applyFilter:e.get("AGGRIDAPPLYFILTER"),equals:e.get("AGGRIDEQUALS"),lessThan:e.get("AGGRIDLESSTHAN"),greaterThan:e.get("AGGRIDGREATERTHAN"),contains:e.get("AGGRIDCONTAINS"),startsWith:e.get("AGGRIDSTARTSWITH"),endsWith:e.get("AGGRIDENDSWITH"),group:e.get("AGGRIDGROUP"),columns:e.get("AGGRIDCOLUMNS"),rowGroupColumns:e.get("AGGRIDROWGROUPCOLUMNS"),rowGroupColumnsEmptyMessage:e.get("AGGRIDROWGROUPCOLUMNSEMPTYMESSAGE"),valueColumns:e.get("AGGRIDVALUECOLUMNS"),pivotMode:e.get("AGGRIDPIVOTMODE"),groups:e.get("AGGRIDGROUPS"),values:e.get("AGGRIDVALUES"),pivots:e.get("AGGRIDPIVOTS"),valueColumnsEmptyMessage:e.get("AGGRIDVALUECOLUMNSEMPTYMESSAGE"),pivotColumnsEmptyMessage:e.get("AGGRIDPIVOTCOLUMNSEMPTYMESSAGE"),noRowsToShow:e.get("AGGRIDNOROWSTOSHOW"),pinColumn:e.get("AGGRIDPINCOLUMN"),valueAggregation:e.get("AGGRIDVALUEAGGREGATION"),autosizeThiscolumn:e.get("AGGRIDAUTOSIZETHISCOLUMN"),autosizeAllColumns:e.get("AGGRIDAUTOSIZEALLCOLUMNS"),groupBy:e.get("AGGRIDGROUPBY"),ungroupBy:e.get("AGGRIDUNGROUPBY"),resetColumns:e.get("AGGRIDRESETCOLUMNS"),expandAll:e.get("AGGRIDEXPANDALL"),collapseAll:e.get("AGGRIDCOLLAPSEALL"),toolPanel:e.get("AGGRIDTOOLPANEL"),pinLeft:e.get("AGGRIDPINLEFT"),pinRight:e.get("AGGRIDPINRIGHT"),noPin:e.get("AGGRIDNOPIN"),sum:e.get("AGGRIDSUM"),min:e.get("AGGRIDMIN"),max:e.get("AGGRIDMAX"),none:e.get("AGGRIDNONE"),count:e.get("AGGRIDCOUNT"),average:e.get("AGGRIDAVERAGE"),avg:e.get("AGGRIDAVERAGE"),copy:e.get("AGGRIDCOPY"),ctrlC:e.get("AGGRIDCTRLC"),paste:e.get("AGGRIDPASTE"),ctrlV:e.get("AGGRIDCTRLV")}},f.createColumnDefs=function(e,a,t,o,i,r,n,l,s,d,p,c){var u=[];if(o&&0<o.length)u=F.cloneDeep(o);else{if(!e)return;var m=[],y=b.Models.getModelByCollectionName(e);y&&(m=y.formFields,t&&0<t.length&&((t=F.cloneDeep(t)).forEach(function(e){return e.name+=".value"}),m=F.concat(m,t))),u=[],m.forEach(function(e){var t,o=f.getColumnDefinition(e,a,s,d,p);if(0<l&&40===o.minWidth&&(o.minWidth=l),o.menuTabs=[],e.type===v.FormFieldType.catalog&&(o.cellRenderer="catalogRenderer",o.isCheck=e.check,o.isPresence=e.presence,o.isInventory=e.inventory),e.type===v.FormFieldType.multiphotos&&(o.suppressExport=!0),(!c||c.indexOf(o.field)<0)&&u.push(o),e.isImageRecognition&&e.type===v.FormFieldType.photo&&((t=F.cloneDeep(o)).hide=!0,t.headerName+=" - Markup",t.forceExport=!0,t.field=t.field.replace(".value",".edit"),u.push(t)),e.type===v.FormFieldType.multiphotos)for(var i=0;i<e.maxPhotos;i++){var r=F.cloneDeep(o);r.hide=!0,r.suppressExport=!1,r.headerName+=" "+i,r.forceExport=!0,r.field=r.field.replace(".value",".value["+i+"]"),u.push(r),e.isImageRecognition&&((t=F.cloneDeep(o)).hide=!0,t.suppressExport=!1,t.headerName+=" - Markup "+i,t.forceExport=!0,t.field=t.field.replace(".value",".extraData["+i+"].edit"),u.push(t))}})}if(i){var g={name:"distance",title:"Distance",type:v.FormFieldType.number,columnDefinition:{width:150},isDistanceField:!0},h=f.getColumnDefinition(g,a);u.push(h)}return!0===r&&u.unshift({headerName:"#",width:50,cellRenderer:function(e){return e.node.id+1}}),n&&0<n.length&&n.forEach(function(t){u.push({width:45,cellClass:"overflow",suppressExport:!0,sortable:!1,suppressFilter:!0,pinned:"right",menuTabs:["filterMenuTab"],context:{icon:t.icon,color:t.color,text:t.text},cellRenderer:"buttonRenderer",onCellClicked:function(e){return t.handler(e.data&&e.data.toJS?e.data.toJS():e.data),!1}})}),u},f.colors=[{name:"finished",value:p.Colors.black,"class":"black",index:0,textValue:p.Colors.light},{name:"booked",value:p.Colors.warning,"class":"warning",index:1,textValue:p.Colors.black},{name:"available",value:p.Colors.stable,"class":"stable",index:2,textValue:p.Colors.black},{name:"visited",value:p.Colors.black,"class":"black",index:3,textValue:p.Colors.light},{name:"notvisited",value:p.Colors.stable,"class":"stable",index:4,textValue:p.Colors.black},{name:"analyzed",value:p.Colors.success,"class":"success",index:5,textValue:p.Colors.black},{name:"validated",value:p.Colors.success,"class":"success",index:6,textValue:p.Colors.black},{name:"tobevalidated",value:p.Colors.stable,"class":"stable",index:7,textValue:p.Colors.light},{name:"rejected",value:p.Colors.danger,"class":"danger",index:8,textValue:p.Colors.light},{name:"progress",value:p.Colors.stable,"class":"stable",index:9,textValue:p.Colors.black},{name:"validationprogress",value:p.Colors.stable,"class":"stable",index:10,textValue:p.Colors.black},{name:"conformityprogress",value:p.Colors.stable,"class":"stable",index:11,textValue:p.Colors.black},{name:"conformityrelativeprogress",value:p.Colors.stable,"class":"stable",index:12,textValue:p.Colors.black},{name:"ontime",value:p.Colors.success,"class":"success",index:13,textValue:p.Colors.success},{name:"late",value:p.Colors.danger,"class":"danger",index:14,textValue:p.Colors.danger},{name:"satisfactory",value:p.Colors.success,"class":"success",index:15,textValue:p.Colors.success},{name:"unsatisfactory",value:p.Colors.danger,"class":"danger",index:16,textValue:p.Colors.danger},{name:"nonapplicable",value:p.Colors.black,"class":"black",index:17,textValue:p.Colors.light}],f.decorators=[{type:r.Injectable}],f}(),t=function(){function e(){}return e.prototype.generateConditionId=function(){return v.getUUID()},e.prototype.convertOperator=function(e){if(!e)return"in";var t;switch(e.toLowerCase().replace(/\s/g,"")){case"equals":case"==":case"===":case"égal":t="equals";break;case"notequals":case"!=":case"!==":case"différentde":t="notequals";break;case"greaterthan":case">=":case"plusgrandque":t="greaterthan";break;case"lessthan":case"<=":case"pluspetitque":t="lessthan";break;case"in":case"contient":case"contains":t="in";break;case"notin":case"necontientpas":case"notcontains":t="notin"}return t},e.prototype.convertType=function(e){if(e){var t;switch(e.toLowerCase().replace(/\s/g,"")){case"field":case"champ":t="field";break;case"tags":t="tags";break;case"groups":case"groupes":t="groups";break;default:t=""}return t}},e.prototype.convertField=function(e){if(e){var t={name:e.name,title:e.title,type:e.type};return e.values&&(t.values=e.values),t}},e.prototype.isValid=function(e){if(!e)return!1;var t=e.title&&!!e.title.replace(/\s/g,""),o=e.operator&&0<=b.CONDITION_ALL_OPERATORS.indexOf(e.operator),i=e.type&&0<=b.CONDITION_TYPES.indexOf(e.type),r="field"===e.type&&e.field,a="tags"===e.type&&e.tags&&F.isArray(e.tags)&&0<e.tags.length,n="groups"===e.type&&e.group&&F.isArray(e.group)&&0<e.group.length,l="field"===e.type&&r&&0<=b.SIMPLE_FIELD_TYPES.indexOf(e.field.type)&&e.value,s="field"===e.type&&r&&0<=b.WITH_VALUES_FIELD_TYPES.indexOf(e.field.type)&&e.values&&F.isArray(e.values)&&0<e.values.length;return t&&o&&i&&(n||a||r&&(l||s))},e.prototype.areEqual=function(e,t){return e._id&&t._id?e._id===t._id:e._id||t._id?e._id&&!t._id?F.isEqual(t,F.omit(e,"_id")):!e._id&&t._id?F.isEqual(e,F.omit(t,"_id")):void 0:F.isEqual(e,t)},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[]},e}(),g=function(){function e(e){this.translate=e}return e.prototype.generateFieldName=function(){return v.getUUID()},e.prototype.answerIsValid=function(e,t,o){return v.answerIsValid(e,t,o)},e.prototype.hasScoring=function(e){return!!(e&&e.scoring&&0<e.scoring.length)},e.prototype.calculateScoring=function(t,o){var n=this;1<t.description.scoring.length&&(t.extraScores={}),F.forEach(t.description.scoring,function(i){var r=i.initialValue||0,a=i.percentageBasis||0;F.forEach(o,function(e,o){if(e&&F.isArray(e.value))F.forEach(e.value,function(e){if(e&&F.isNumber(i[o+n.encodeScoringValue(e)])){var t=i[o+n.encodeScoringValue(e)];t<0&&-t%1337==0?a-=-t/1337:r+=t}});else if(e&&F.isNumber(i[o+n.encodeScoringValue(e.value)])){var t=i[o+n.encodeScoringValue(e.value)];t<0&&-t%1337==0?a-=-t/1337:r+=t}else e&&F.isNumber(e.value)&&F.isNumber(i[o])?r+=e.value*i[o]:F.isBoolean(e.value)&&i[o+"value"]&&(e.value&&F.isNumber(i[o+"value"].value)?r+=i[o+"value"].value:!e.value&&F.isNumber(i[o+"value"].novalue)&&(r+=i[o+"value"].novalue));e&&v.isPresent(e.value)&&i[o+"value"]&&F.isNumber(i[o+"value"].visible)&&(a+=i[o+"value"].visible)}),i.isPercentage&&0<a&&(r=Math.round(100*r/a));var e={value:r,isPercentage:i.isPercentage,title:i.title};i.isActive||1===t.description.scoring.length?(t.score=e,(i.minValue||0===i.minValue)&&r<i.minValue?t.validated=!1:(i.minValue||0===i.minValue)&&r>=i.minValue&&delete t.validated):t.extraScores[e.title]=e})},e.prototype.calculateScoringQuizz=function(e,t,o){var i=this,r={total:0,value:0},a=b.Models.getFieldsFromSlides(t);F.forEach(a,function(e){e.answer&&0<e.answer.length&&(r.total+=1),o[e.name]&&i.answerIsValid(o[e.name].value,e.answer,e)&&(r.value+=1)}),e.score=r},e.prototype.hasTabs=function(e){return e.some(function(e){return e.tab&&0<e.tab.length})},e.prototype.getSlides=function(e){var o=this,i=new Map;return i.set("GENERAL",{title:this.translate.get("GENERAL"),items:[],order:0}),e.forEach(function(e){var t=o.getTabName(e);e.tab?i.has(t)?(i.get(t).items.push(e),e.tabCondition&&(i.get(t).condition=e.tabCondition)):i.set(t,{title:t,items:[e],condition:e.tabCondition}):i.get("GENERAL").items.push(e)}),F.filter(F.sortBy(Array.from(i.values()),function(e){return e.title}),function(e){return 0<e.items.length})},e.prototype.updateDataFieldType=function(i,e){var r=this;i.nonapplicableCount=0,i.satisfactoryCount=0,i.unsatisfactoryCount=0,F.forEach(e,function(o){if(F.isObject(i[o.name])){if(i[o.name].fieldType=o.type,i[o.name].fieldTitle=o.title,i[o.name]&&i[o.name].value&&o.type===v.FormFieldType.photo&&o.values&&(!i[o.name].tags||i[o.name].tags.length<1)?i[o.name].tags=o.values:i[o.name]&&i[o.name].value&&o.type===v.FormFieldType.multiphotos&&o.values&&(i[o.name].extraData=i[o.name].extraData||{},i[o.name].value.forEach(function(e,t){i[o.name].extraData[t]=i[o.name].extraData[t]||{},(!i[o.name].extraData[t].tags||i[o.name].extraData[t].tags.length<1)&&(i[o.name].extraData[t].tags=o.values)})),o.shareToFeed&&(i[o.name].fieldShareToFeed=o.shareToFeed),o.answer&&(i[o.name].answer=o.answer,i[o.name].fieldValidity=r.answerIsValid(i[o.name].value,o.answer,o)),o.explanation&&(i[o.name].explanation=o.explanation),o.valuesType){var t=i[o.name].value,e=o.valuesType.find(function(e){return e.key===t});e&&(i[o.name].valueType=e.value)}if(o.valuesType&&i[o.name]&&i[o.name].value)[].concat(i[o.name].value).forEach(function(t){var e=o.valuesType.find(function(e){return e.key===t});e&&("satisfactory"===e.value?i.satisfactoryCount+=1:"unsatisfactory"===e.value?i.unsatisfactoryCount+=1:"nonapplicable"===e.value&&(i.nonapplicableCount+=1))})}})},e.prototype.getTabName=function(e){var t="";return e.tabIndex&&(t+=e.tabIndex+". "),e.tab&&(t+=this.translate.get(e.tab)),t},e.prototype.encodeScoringValue=function(e){return e&&e.toString?e.toString().replace(/\./,"_"):e},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:i.Translate}]},e}(),h=function(){function e(e,t,o,i,r,a,n){this.rq=e,this.googlemaps=t,this.broker=o,this.conditionsService=i,this.config=r,this.translate=a,this.xlsx=n,this._stringToArray=function(e){for(var t=e?F.trimEnd(F.trimStart(e,"["),"]").split(","):[],o=0;o<t.length;o++)/^\s/.test(t[o])&&(t[o]=t[o].substring(1));return t}}return e.prototype.getTotal=function(e){return e.document?this.xlsx.read(e.document).then(function(e){return e.length-1}):Promise.resolve(0)},e.prototype.convertMissionForExcelExport=function(e,t){var o=this.convertConditonsForExcelExport(t);return[this.convertSlidesForExcelExport(e),o]},e.prototype.convertSlidesForExcelExport=function(e){var o=[];return F.forEach(e,function(t){F.forEach(t.items,function(e){o.push({id:e.name,pageTitle:t.title,pageDescription:t.description,title:e.title,description:"information"===e.type?e.value:e.description,type:e.type,allowComments:e.allowComments,required:e.required,values:e.values,allowLibrary:e.allowLibrary,min:e.min,max:e.max,step:e.step,minDate:e.minDate,maxDate:e.maxDate,hideMobile:e.hideMobile,allowHistory:e.allowHistory,showOnLocation:e.showOnLocation,allowAnnotate:e.allowAnnotate,showUsers:e.showUsers,showService:e.showService,allowOther:e.allowOther,radius:e.radius,multiple:e.multiple,clearable:e.clearable,duration:e.duration,anwser:e.anwser,explanation:e.explanation,conditions:e.condition?e.condition.map(function(e){return e.title}):"",allowTime:e.allowTime,image:e.image})})}),{columns:[{name:"id"},{name:"pageTitle"},{name:"pageDescription"},{name:"title"},{name:"description"},{name:"type"},{name:"allowComments"},{name:"required"},{name:"values"},{name:"allowLibrary"},{name:"min"},{name:"max"},{name:"step"},{name:"minDate"},{name:"maxDate"},{name:"hideMobile"},{name:"allowHistory"},{name:"showOnLocation"},{name:"allowAnnotate"},{name:"showUsers"},{name:"showService"},{name:"allowOther"},{name:"radius"},{name:"multiple"},{name:"clearable"},{name:"duration"},{name:"anwser"},{name:"explanation"},{name:"conditions"},{name:"allowTime"},{name:"image"}],data:o,title:"Slides"}},e.prototype.convertConditonsForExcelExport=function(e){var t=[];return F.forEach(e,function(e){t.push({title:e.title,type:e.type,field:e.field?e.field.name:"",operator:e.operator,values:e.values||e.value||e.tags||e.group,id:e._id})}),{columns:[{name:"title"},{name:"type"},{name:"field"},{name:"operator"},{name:"values"},{name:"id"}],data:t,title:"Conditions"}},e.prototype.upload=function(e,t,o){var i=this,r=b.Models.getPublicCollectionName(t);return this.rq.postFile(this.config.publicApiUrl+r+"/import",e.document).toPromise().then(function(e){if(e._id)return d.timer(1e3,500).pipe(c.concatMap(function(){return i.rq.get(i.config.publicApiUrl+"jobs/"+e._id,!1,null).pipe(c.catchError(function(){return d.of({})}))})).pipe(c.filter(function(e){return o&&e&&e.progress&&o.emit(100*e.progress),e&&1===e.progress})).pipe(c.take(1)).toPromise().then(function(e){return F.get(e,"data.output.errors")||[]})})},e.prototype.convertTranslations=function(e){var i=this;e.shift();var r=[];return F.forEach(e,function(e,t){if(e[1]){var o={language:e[1],key:e[2],value:e[3],en:e[4],us:e[5],fr:e[6],es:e[7],pl:e[8],nl:e[9],de:e[10],it:e[11],ru:e[12],zhs:e[13],zht:e[14],pt:e[15],kr:e[16],ja:e[17],ua:e[18],he:e[19],ar:e[20],cz:e[21],th:e[22],tr:e[23],bg:e[24],el:e[25],sl:e[26],sk:e[27],ro:e[28],hu:e[29],et:e[30],br:e[31],isReject:i.isTrue(e[32]),group:i._stringToArray(e[33]),isPhotoAnnotation:i.isTrue(e[34])};e[0]&&(o._id=e[0]),r.push(o)}}),r},e.prototype.convertLocations=function(e,n,l){var s=this;e.shift(),n.total=e.length;var t=[];return e.forEach(function(e){t.indexOf(e[2])<0&&t.push(e[2])}),this.broker.getAll("locationtypes",null,null,null,[[{field:"name",operator:{_id:"inq"},value:t}]]).pipe(c.map(function(e){return e.data}),c.mergeMap(function(r){var a=[];return e.forEach(function(t,e){if(t[0]&&t[1]){var o=new b.Location;if(o.title=t[0],o.address=t[1],o.placesearch=t[4]?t[4]:o.title,o.contactname=t[5],o.contactemail=t[6],o.contactphone=t[7],o.info=t[8],o.tags=s._stringToArray(t[9]),o.notificationemail=t[10],o.clientid=t[11],t[12]?o._id=t[12]:o._id="mapping_"+e,t[13]&&(o.vip=s.isTrue(t[13])),o.type=r.find(function(e){return e.name===t[2]}),t[14]&&(o.missiondescriptionsRef=s._stringToArray(t[14])),t[3])o._geoloc=JSON.parse(t[3]),o.status="file",n.count+=1,l.markForCheck(),a.push(d.of(o));else{var i=s.googlemaps.resolveAddressLocation(o.address,s.translate.getCurrentLanguage(),o.placesearch).pipe(c.map(function(e){return e&&e.coords?(o.status=e.source,o._geoloc=[e.coords.lng,e.coords.lat]):o.status="error",n.count+=1,l.markForCheck(),o}));a.push(i)}}}),d.forkJoin(a)}))},e.prototype.convertFormAndConditions=function(e,r){var a=this,o=[],n=[],l=[],t=this.removeEmptyRows(e[0]),i=2<=e.length?this.removeEmptyRows(e[1]):[];t.shift(),i.shift();var s={},d=new Map,p=new Map;return t.forEach(function(e){if(e[1]&&s.title!==e[1]&&(s={title:e[1],description:e[2],items:[]},n.push(s)),s&&e[5]){var t=a.createField(e,r);if(e[28]){var o=a._stringToArray(e[28]);if(0<o.length){var i={conditions:o,slideId:n.length-1};p.set(t.name,i)}}s.items.push(t),d.set(e[0],t)}}),i.forEach(function(e){var t=a.createCondition(e,d);a.conditionsService.isValid(t)?l.push(t):o.push("CONVERTCONDITIONERROR : "+e[0])}),p.forEach(function(o,t){var i=F.findIndex(n[o.slideId].items,function(e){return e.name===t});0<=i&&(n[o.slideId].items[i].condition=[],o.conditions.forEach(function(t){var e=F.find(l,function(e){return e.title===t});e&&n[o.slideId].items[i].condition.push(e)}))}),{slides:n,conditions:l,errors:o}},e.prototype.createField=function(e,t){var o={name:e[0]||t.generateFieldName(),type:e[5].toLowerCase(),title:e[3],description:e[4],allowComments:this.isTrue(e[6]),required:this.isTrue(e[7]),values:this._stringToArray(e[8]),allowLibrary:this.isTrue(e[9]),min:e[10],max:e[11],step:e[12],minDate:e[13],maxDate:e[14],hideMobile:this.isTrue(e[15]),allowHistory:this.isTrue(e[16]),showOnLocation:this.isTrue(e[17]),allowAnnotate:this.isTrue(e[18]),showUsers:this.isTrue(e[19]),showService:this.isTrue(e[20]),allowOther:this.isTrue(e[21]),radius:e[22],multiple:this.isTrue(e[23]),clearable:this.isTrue(e[24]),duration:e[25],anwser:this._stringToArray(e[26]),explanation:e[27],allowTime:this.isTrue(e[29])};return e[30]&&"image"===o.type&&(o.image={_downloadURL:e[30]}),"information"===o.type&&(o.value=o.description,delete o.description),o},e.prototype.createCondition=function(e,t){var o={title:e[0]};if(o.operator=this.conditionsService.convertOperator(e[3]),o.type=this.conditionsService.convertType(e[1]),e[5]&&(o._id=e[5]),"field"===o.type){if(o.field=this.conditionsService.convertField(t.get(e[2])),!o.field)return;0<=F.indexOf(b.SIMPLE_FIELD_TYPES,o.field.type)?o.value=e[4]:o.values=this._stringToArray(e[4])}else if("tags"===o.type)o.tags=this._stringToArray(e[4]);else{if("groups"!==o.type)return;o.group=this._stringToArray(e[4])}return o},e.prototype.removeEmptyRows=function(e){return F.filter(e,function(e){return 0<F.filter(e,function(e){return e&&!!e.replace(/\s/g,"")}).length})},e.prototype.isTrue=function(e){return"TRUE"===e||"VRAI"===e||"true"===e||"vrai"===e},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:b.Requestor},{type:b.Googlemaps},{type:b.Broker},{type:t},{type:b.Config},{type:i.Translate},{type:b.Xlsx}]},e}(),f=function(){function e(e,t,o,i,r,a,n,l){this.broker=e,this.dashboard=t,this.rq=o,this.translate=i,this.localForage=r,this.coreConfig=a,this.utils=n,this.cache=l,this.PDF_ROW_WIDTH=1200,this.PDF_ROW_HEIGHT=800,this.palette0=["#04CC99","#FF625F","#1FB6FF","#FC459E","#FF6402","#FED05B","#ADADAD","#845CFF","#FC459E","#000000","#D0D0D0","#ADADAD"],this.palette1=["#04CC99","#FF625F",,"#1FB6FF","#FC459E","#FF6402","#FED05B","#ADADAD","#845CFF","#FC459E","#000000","#D0D0D0","#ADADAD"],this.palette2=["#04CC99","#FF625F",,"#1FB6FF","#FC459E","#FF6402","#FED05B","#ADADAD","#845CFF","#FC459E","#000000","#D0D0D0","#ADADAD"],this.palette3=["#04CC99","#FF625F",,"#1FB6FF","#FC459E","#FF6402","#FED05B","#ADADAD","#845CFF","#FC459E","#000000","#D0D0D0","#ADADAD"],this.paletteBoost=["#F46885","#FCAE49","#1FB6FF","#FC459E","#FF6402","#FED05B","#ADADAD","#845CFF","#FC459E","#000000","#D0D0D0","#ADADAD"],this.textStyle={fontFamily:"Lato",color:p.Colors.black,fontWeight:"300",fontSize:"13px",whiteSpace:"normal",textShadow:!1},this.lineColor="#E1E8EE",this.gridLineColor="#F4F8FC",this.decimalPipe=new s.DecimalPipe(this.translate.getCurrentAngularLocale())}return e.prototype.getFilenameSuffix=function(){return this.rq.getFilenameSuffix()},e.prototype.encodeChart=function(e){if(e.aggregateOptions&&!F.isString(e.aggregateOptions)&&(e.aggregateOptions=JSON.stringify(e.aggregateOptions)),e.kpiFormValues&&e.kpiFormValues.campaigns&&(e.kpiFormValues.campaigns=e.kpiFormValues.campaigns.map(function(e){return F.pick(e,["title","_id","scoring"])})),e.kpiFormValues&&e.kpiFormValues.missionscores&&(e.kpiFormValues.missionscores.selectedDescription&&(e.kpiFormValues.missionscores.selectedDescription=F.pick(e.kpiFormValues.missionscores.selectedDescription,["title","_id","scoring"])),e.kpiFormValues.missionscores.scores)){var t=e.kpiFormValues.missionscores.scores;F.isArray(t)&&0<t.length&&(t=t[0]),e.kpiFormValues.missionscores.scores=F.pick(t,["title","isActive"])}},e.prototype.decodeChart=function(e){e.aggregateOptions&&F.isString(e.aggregateOptions)&&(e.aggregateOptions=JSON.parse(e.aggregateOptions)),e.aggregateData&&F.isString(e.aggregateData)&&(e.aggregateData=JSON.parse(e.aggregateData)),e._id||(e._id=v.getUUID())},e.prototype.encode=function(e){var t=this;if(!e)return e;var o=F.cloneDeep(e);return F.forEach(o.tabs,function(e){e&&e.items&&F.forEach(e.items,function(e){e&&e.definition&&t.encodeChart(e.definition)})}),o.tabs&&0<o.tabs.length&&o.tabs[0].items&&0<o.tabs[0].items.length&&o.tabs[0].items[0].definition&&o.tabs[0].items[0].definition.kpiType&&(o.icon=this.getKpiIcon(o.tabs[0].items[0].definition.kpiType)),o},e.prototype.decode=function(e){var t=this;return F.forEach(e.tabs,function(e){F.forEach(e.items,function(e){e&&e.definition&&t.decodeChart(e.definition)})}),e},e.prototype.clone=function(e){var t=F.cloneDeep(e);return t._id=v.getUUID(),t},e.prototype.saveDashboard=function(e){var t=this,o=this.encode(e);return this.broker.upsert("dashboards",o).pipe(c.map(function(e){return t.decode(e)}))},e.prototype.deleteDashboard=function(e){return this.broker["delete"]("dashboards",e)},e.prototype.getData=function(e,t,o,i,r){return void 0===o&&(o=!1),void 0===i&&(i=0),void 0===r&&(r=!1),this.getDataObservable(e,t,o,i,r).pipe(c.catchError(function(e){return d.throwError("error")}))},e.prototype.getAggregateQuery=function(t,o,i,r,a){var n=this;return void 0===a&&(a=!1),d.from(this.getDataFromCache(t)).pipe(c.mergeMap(function(e){return e&&!0!==a?d.of(e):n.broker.aggregateQuery(o,i,r)}),c.mergeMap(function(e){return d.from(n.addDataToCache(t,e))}))},e.prototype.getChartCache=function(e){return this.cache.get(b.CACHE_KEYS.chart,e).toPromise()},e.prototype.setChartCache=function(e,t){return this.cache.add(b.CACHE_KEYS.chart,e,t)},e.prototype.clearChartCache=function(e){return this.cache.remove(b.CACHE_KEYS.chart,e)},e.prototype.getDataFromCache=function(e){return e._id?this.getChartCache(e._id).then(function(e){return e&&v.toMinutes(v.dateDiff(new Date,v.toDate(e.date)))<15?e.data:null}):Promise.resolve(null)},e.prototype.addDataToCache=function(t,o){var i=this;return t._id?this.getChartCache(t._id).then(function(e){return e={date:new Date,data:F.cloneDeep(o)},i.setChartCache(t._id,e)}).then(function(){return o}):Promise.resolve(o)},e.prototype.getKpiData=function(t,o,e,i){var r=this;void 0===e&&(e=!1),void 0===i&&(i=!1);var a=this.getKpiClass(t.kpiType);if(a.getChartDefinition(t.kpiFormValues,t,this.translate),t&&"ChartIOKpi"===t.kpiType)return d.of([]);var n=a.getAggregate(t.kpiFormValues,this.translate,i);return t.kpiFormValues.pointPadding&&(t.pointPadding=t.kpiFormValues.pointPadding),t.kpiFormValues.numberPrecision&&(t.numberPrecision=t.kpiFormValues.numberPrecision),n.mapTransform&&n.mapTransformAsync?this.getAggregateQuery(t,n.collectionName,n.filters,n.aggregateOptions,e).pipe(c.mergeMap(function(e){return n.mapTransform(e,t,r.broker,o)})):this.getAggregateQuery(t,n.collectionName,n.filters,n.aggregateOptions,e).pipe(c.map(function(e){return n.mapTransform?n.mapTransform(e,t,r.broker,o):e}))},e.prototype.getKpiClass=function(e){return null},e.prototype.getKpiIcon=function(e){return null},e.prototype.getKpiIconByType=function(e){return null},e.prototype.getDataObservable=function(t,o,e,i,r){var a=this;if(void 0===e&&(e=!1),void 0===i&&(i=0),void 0===r&&(r=!1),this.decodeChart(t),t.data)return d.of(t.data);if(t.kpi)return this.getKpiData(t,o,e,r);if(t.groupByDate){this.dashboard.setTimescale(t.filters,t.timescale,t.dateField||"finishedDate",t.endDate);var n=b.BaseKpi.getDateFormat(t.dateGrouping);if(t.aggregateOptions&&0<t.aggregateOptions.length)return this.getAggregateQuery(t,t.collectionName,t.filters,t.aggregateOptions,e).pipe(c.map(function(e){return t.mapTransform?t.mapTransform(e,t,a.broker,o):e}));var l=[];if(t.groupByCampaign)l.push({$project:{_id:1,title:"$title",date:{$dateToString:{format:n,date:"$"+(t.dateField||"finishedDate")}}}}),l.push({$group:{_id:{date:"$date",title:"$title"},value:{$sum:1},keys:{$addToSet:"$_id"}}});else{var s={};s[t.dateField||"finishedDate"]={$type:9},l.push({$match:s}),l.push({$group:{_id:{$dateToString:{format:n,date:"$"+(t.dateField||"finishedDate")}},value:{$sum:1},keys:{$addToSet:"$_id"}}})}return this.getAggregateQuery(t,t.collectionName,t.filters,l,e)}return t.aggregateOptions&&0<t.aggregateOptions.length||t.filters&&0<t.filters.length?this.getAggregateQuery(t,t.collectionName,t.filters,t.aggregateOptions,e).pipe(c.map(function(e){return t.mapTransform?t.mapTransform(e,t,a.broker,o):e})):d.of([])},e.prototype.getChartConfig=function(e,t){return this.getHCChartConfig(e,t)},e.prototype.getGridConfig=function(l,e){var s=this;if("CampaignsPivotTableKpi"===l.kpiType)return{columnDefs:l.kpiColumns,rowData:e};var d=this.getHCChartConfig(l,e),t=[{headerName:l.groupByDate?this.translate.get("DATE"):this.translate.get("CATEGORY"),field:"key"}];l.groupByDate&&(t[0].comparator="dateComparator");var p=new Map;return d.series.forEach(function(e,n){"Regression"!==e.name&&(t.push({headerName:e.name,field:"serie"+n,headerTooltip:e.name,minWidth:40}),"scatter"===l.type&&t.push({headerName:e.name,field:"seriex"+n,headerTooltip:e.name+": x",minWidth:40}),l.showDelta&&(F.last(t).cellRenderer="deltaRenderer"),F.forEach(e.data,function(e,t){var o,i,r;if(F.isArray(e)?(o=v.dateFormat(v.toDate(e[0]),"L"),i=e[1]):F.isObject(e)&&e.name?(o=e.name,i=e.y,"scatter"===l.type&&(r=e.x)):F.isObject(e)&&e.x?(o=v.dateFormat(v.toDate(e.x),"L"),i=e.y):d.xAxis&&d.xAxis.categories&&0<d.xAxis.categories.length&&(o=d.xAxis.categories[t],i=e),o){var a=p.get(o)||{key:o};a["serie"+n]=F.isNumber(i)?s.decimalPipe.transform(i,s.getNumberFormat(l)):i&&i.toString?i.toString():i,"scatter"===l.type&&(a["seriex"+n]=r),p.set(o,a)}}))}),{columnDefs:t,rowData:Array.from(p.values())}},e.prototype.getMapConfig=function(e,t){return null},e.prototype.getMicroConfig=function(e,t){var o,i;return F.isArray(t)?o=Math.round(t&&0<t.length?t[0].value:0):(o=t.value,i=t.delta),{title:e.title,value:o,delta:i,info:e.microInfo}},e.prototype.getPivotTableConfig=function(e,t){var o=this.getGridConfig(e,t),i={rowHeight:52,rowStyle:{"line-height":"32px"},headerHeight:40,defaultColDef:{sortable:!0,resizable:!0},suppressTouch:!0};return F.assign(i,{filter:!0,pivotPanelShow:!1,rowSelection:"single",columnDefs:o.columnDefs,rowData:o.rowData}),"CampaignsPivotTableKpi"===e.kpiType&&(F.assign(i,y.getPivotConfig(this.translate)),F.assign(i,{pivotMode:e.gridPivotMode}),o.rows=this.campaignsPivotTableKpiSortRows(e,o.rows)),i},e.prototype.campaignsPivotTableKpiSortRows=function(e,t){for(var o=[],i=1;i<=5;i++){var r="tagGroup"+i;e.kpiFormValues[r]&&o.push(r)}return 0<o.length?F.sortBy(t,o):t},e.prototype.getCalendarData=function(e,i){if(void 0===e&&(e=null),null===e)return{};var t=e.amount-1,o=e.timescale,r=[],a=[];if(i&&0<i.length)for(var n=v.toDate(i[0]._id),l=v.endOf(v.dateAdd(v.toDate(i[0]._id),o,t),o),s=0,d=[0,6,5,4,3,2,1],p=function(){var t=v.dateFormat(v.toDate(n),"YYYY-MM-dd"),e={_id:t,x:s,y:d[v.day(v.toDate(n))],value:0,keys:null,date:t},o=F.find(i,function(e){return e._id===t});o&&(e.keys=o.keys,e.value=o.value),r.push(e),1===v.getDateOfMonth(v.toDate(n))&&a.push(v.dateFormat(v.toDate(n),"MMM")),v.getDateOfMonth(v.toDate(n))===v.daysInMonth(v.toDate(n))?(s++,a.push(""),s++):e.y<=0&&(s++,a.push("")),n=v.dateAdd(v.toDate(n),"days",1)};n<=l;)p();return{data:r,xAxis:a}},e.prototype.getCalendarConfig=function(e,t){var o=this.setHCChartType(e),i=this.getCalendarData(e.kpiFormValues.dates,t);return o.chart.marginTop=-8,o.chart.marginLeft=10,o.chart.marginBottom=0,o.chart.spacing=[0,-2,10,0],o.legend=Object.assign(o.legend,{enabled:!0,align:"right",layout:"vertical",margin:0,verticalAlign:"top",symbolHeight:100,itemMarginTop:20}),o.yAxis={visible:!1,min:0,max:6,labels:{fontSize:"13px"}},o.xAxis={visible:!0,categories:i.xAxis,opposite:!0,lineWidth:0,tickWidth:0,min:0,max:17,labels:{align:"center",autoRotation:!1,y:20,fontSize:"13px"}},o.plotOptions.series=Object.assign(o.plotOptions.series,{borderColor:"#FFFFFF",borderRadius:6,borderWidth:4,maxPointWidth:15,pointWidth:15}),o.colorAxis={min:0,stops:[[0,"#f1f1f1"],[.001,"#c6e6df"],[.2,"#a9ded3"],[.4,"#8cd6c8"],[.6,"#6fcebc"],[.8,"#44C3AA"]]},o.tooltip.formatter=function(){return v.dateFormat(v.toDate(this.point.date),"MMM DD, YYYY dddd")+"<br><br>"+this.point.value+" users"},o.series=[{data:i.data}],o},e.prototype.getHCChartConfig=function(i,e){this.textStyle={fontFamily:"Lato",color:p.Colors.black,fontWeight:"300",fontSize:"13px",whiteSpace:"normal",textShadow:!1};var r=this.setHCChartType(i),o=e;if(F.isArray(e)){if(i.groupByDate&&"pie"!==i.type)if(this.setHCUseDates(r),i.groupByCampaign){var a=new Map;e.forEach(function(e){var t=a.get(e._id.title)||{name:e._id.title,data:[]},o=b.BaseKpi.fixDates(i,e._id.date);t.data.push({x:o,y:e.value,color:e.color,keys:e.keys}),a.set(e._id.title,t)}),r.series=Array.from(a.values()),r.series.forEach(function(e){return e.data=F.sortBy(e.data,function(e){return e.x})})}else r.series=[{name:i.title,data:F.sortBy(e.map(function(e){return{x:b.BaseKpi.fixDates(i,e._id),y:e.value,color:e.color,keys:e.keys}}),function(e){return e.x})}];else if("treemap"===i.type)F.isArray(e)&&(r.series=[{layoutAlgorithm:"squarified",data:F.map(e,function(e){return{name:e._id,value:e.value,colorValue:e.value}})}]);else if("scatter"===i.type)r.series=[{name:i.title,data:e}],i.hideRegression||this.addCorelationLine(e,r);else{var n=new Map,l=new Set;F.isArray(e)&&0<e.length&&(e[0].serie||0===e[0].serie)?(F.forEach(e,function(e){var t=n.get(e.serie)||{};t[e._id]={y:e.value,keys:e.keys},l.add(e._id),n.set(e.serie,t)}),r.xAxis=Object.assign(r.xAxis||{},{categories:F.sortBy(Array.from(l.values()),function(e){return e}),crosshair:!0})):(F.isArray(e)?e=e.reduce(function(e,t){return e[t._id]={y:t.value,keys:t.keys},e},{}):delete e.value,r.xAxis=Object.assign(r.xAxis||{},{categories:F.map(e,function(e,t){return t}),crosshair:!0}),n.set(i.title,e)),r.series=[];var s=100/n.size;n.forEach(function(t,e){var o=r.series.length+1;r.xAxis&&r.xAxis.categories&&r.xAxis.categories.forEach(function(e){t[e]||(t[e]=null)}),r.series.push({name:e,size:(.7*s).toString()+"%",center:[(s*o-s/2).toString()+"%",null],data:"radar"===i.type?F.map(r.xAxis.categories,function(e){return t[e]}):F.sortBy(F.map(t,function(e,t){return F.assign({name:t},e)}),function(e){return r.xAxis.categories.map(function(e){return e.toString()}).indexOf(e.name)})})})}return r.series.forEach(function(t){if(o.forEach(function(o){t.name!==o.serie&&t.name!==o._id||(t.color=o.color,o.textColor&&(t.dataLabels=t.dataLabels||{},t.dataLabels.color=o.textColor),t.index=t.index||0,t.index=-o.index,t.legendIndex=o.index),i.colors&&F.keys(i.colors).forEach(function(e){t.name&&t.name.toString()===e.toString()&&(t.color=i.colors[e])}),F.isArray(t.data)&&t.data.forEach(function(t,e){!t||t.name!==o.serie&&(o.serie||t.name!==o._id)||t.color||(t.color=o.color,t.index=t.index||0,t.index=-o.index,t.legendIndex=o.index),i.colors&&F.keys(i.colors).forEach(function(e){t.name&&t.name.toString()===e.toString()&&(t.color=i.colors[e])})})}),i.showCumulate)for(var e=1;e<t.data.length;e++)t.data[e].y+=t.data[e-1].y||0;t.name&&0<=t.name.indexOf("N-1")&&(t.color=p.Colors.stable)}),this.applyAreaSplineGradients(i,r),this.applySubtitleSum(r),this.applyLegendState(r,i),r}},e.prototype.isChartEmpty=function(e){return!e.series||!(1!==e.series.length||e.series[0].data&&0!==e.series[0].data.length)},e.prototype.getChartEmptyImage=function(e){var t="./images/empty-states/speedometer.svg";if(e&&e.chart&&e.chart.type)switch(e.chart.type){case"line":t="../kpi/lines.svg";break;case"spline":t="../kpi/splines.svg";break;case"area":case"areaspline":t="../kpi/splineroyal.svg";break;case"column":case"bar":t="../kpi/column.svg";break;case"radar":case"treemap":case"pie":case"doughnut":default:t="../kpi/pie.svg"}return t},e.prototype.getURL=function(e,t,o,i){var r=this,a="image/png",n={filename:i?i.filename:null,type:a,async:!0,scale:2,width:2*t,height:2*o,svg:e},l="https://export.highcharts.com/";return this.rq.postMultiPart(l,n).pipe(c.mergeMap(function(e){var t=l+e;return r.rq.getBinaryContent(t)}),c.mergeMap(function(e){var t=new Blob([e],{type:a});return d.from(r.broker.upload(t))}),c.map(function(e){return e}))},e.prototype.formatSVGs=function(e,t,o){var i;return void 0===o&&(o=1200),1===(e=[].concat(e)).length?i=e[0]:(i='<svg height="'+t+'" width="'+o+'" version="1.1" xmlns="http://www.w3.org/2000/svg">',i+=e.join(""),i+="</svg>"),i.replace(/visby/gi,"Lato").replace(/text-shadow/gi,"ttext-shadow").replace(/class="highcharts-text-outline" fill="#000000" stroke="#000000" stroke-width="2px"/gi,'class="highcharts-text-outline" fill="#7F8FA4" stroke="#7F8FA4" stroke-width="1px"')},e.prototype.exportAll=function(t,e,o,i){var r=this;void 0===i&&(i=1200);var a=this.formatSVGs(e,o);t=F.merge({type:"image/png",url:"https://export.highcharts.com/",printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:[{textKey:"printChart"},{separator:!0},{textKey:"downloadPNG"},{textKey:"downloadJPEG"},{textKey:"downloadSVG"},{textKey:"downloadPDF"}]}},libURL:"https://code.highcharts.com/5.0.10/lib/"},t),this.rq.postRaw("https://export.highcharts.com",{filename:t.filename||"chart",type:t.type,scale:1,width:i,svg:a},!0).subscribe(function(e){e&&e.body&&r.rq.saveArrayBuffer(e.body,(t.filename||"chart")+".pdf")})},e.prototype.getChartIOUrl=function(e,t){var o=this.broker.getApiUrl()+"dashboards/getToken";return this.rq.post(o,{dashboardId:e,env:t||{}}).pipe(c.map(function(e){return e}))},e.prototype.getTableauUrl=function(e,t){var o=this.broker.getApiUrl()+"tableau/getViewUrl";return this.rq.post(o,{path:e}).pipe(c.map(function(e){return e}))},e.prototype.applyAreaSplineGradients=function(e,t){if(t.chart&&"areaspline"===t.chart.type){var n=this.getPalette(e);t.series.forEach(function(e,t){var o=m(n[t].match(/\w\w/g).map(function(e){return parseInt(e,16)}),3),i=o[0],r=o[1],a=o[2];e.fillColor="rgba("+i+","+r+","+a+",0.15)",e.dataLabels=e.dataLabels||{},e.dataLabels.color=p.Colors.black})}},e.prototype.applySubtitleSum=function(e){if(e.chart&&"areaspline"===e.chart.type&&1===e.series.length){var t=F.sumBy(e.series[0].data,function(e){return e[1]});t&&(e.subtitle={text:t.toLocaleString(),style:F.defaultsDeep({fontSize:"18px",fontWeight:300,color:p.Colors.black},this.textStyle),align:"right"})}},e.prototype.applyLegendState=function(e,o){o.chartLegendState&&F.forEach(e.series,function(e){e&&!1===e.name&&(e.visible=!1),F.isArray(e.data)&&e.data.forEach(function(e,t){e&&!1===o.chartLegendState[e.name]&&(e.visible=!1)})})},e.prototype.addCorelationLine=function(e,t){var o=e.length,i=F.sum(e.map(function(e){return e.x})),r=F.sum(e.map(function(e){return e.y})),a=(o*F.sum(e.map(function(e){return e.x*e.y}))-i*r)/(o*F.sum(e.map(function(e){return e.x*e.x}))-i*i),n=(r-a*i)/o,l=F.min(e.map(function(e){return e.x})),s=F.max(e.map(function(e){return e.x}));t.series.push({type:"line",name:"Regression",color:p.Colors.black,data:[[l,a*l+n],[s,a*s+n]],marker:{enabled:!1},enableMouseTracking:!1})},e.prototype.setHCChartType=function(e){var t=this.getHCDefaultConfig(e);switch(e.type){case"line":t=F.merge(t,this.getHCDefaultLine(e));break;case"spline":t=F.merge(t,this.getHCDefaultSpline(e));break;case"area":t=F.merge(t,this.getHCDefaultArea(e));break;case"areaspline":t=F.merge(t,this.getHCDefaultAreaSpline(e));break;case"bar":t=F.merge(t,this.getHCDefaultBar(e));break;case"column":t=F.merge(t,this.getHCDefaultColumn(e));break;case"heatmap":t=F.merge(t,this.getHCDefaultHeatmap(e));break;case"doughnut":t=F.merge(t,this.getHCDefaultDoughnut(e));break;case"pie":t=F.merge(t,this.getHCDefaultPie(e));break;case"radar":t=F.merge(t,this.getHCDefaultRadar(e));break;case"treemap":t=F.merge(t,this.getHCDefaultTreemap(e));break;case"scatter":t=F.merge(t,this.getHCDefaultScatter(e))}return t.legend.enabled=!0===e.showLegend,e.marginBottom&&(t.chart.marginBottom=e.marginBottom),e.legendVerticalAlign&&(t.legend.verticalAlign=e.legendVerticalAlign),e.legendAlign&&(t.legend.align=e.legendAlign),e.legendWidth&&(t.legend.width=e.legendWidth,t.legend.itemMarginBottom=5),delete t.chart.margin,delete t.chart.marginTop,delete t.chart.marginLeft,delete t.chart.marginRight,delete t.chart.marginBottom,!1===e.showLabelsY&&t.yAxis&&t.yAxis.labels&&(t.yAxis.labels.enabled=!1),t},e.prototype.setHCUseDates=function(e){e.xAxis=e.xAxis||{},e.chart.zoomType="x",e.chart.panning=!0,e.chart.panKey="shift",e.xAxis.type="datetime"},e.prototype.getPalette=function(e){return e&&e.palette&&this[e.palette]?this[e.palette]:this.palette0},e.prototype.getNumberFormat=function(e){return e.numberPrecision&&1<=e.numberPrecision?"1.0-"+(Math.floor(e.numberPrecision)||0):"1.0-0"},e.prototype.getDateTimeIntervalByGroupingDate=function(e,t){void 0===t&&(t="");var o={hour:36e5,day:864e5,week:6048e5,month:2592e6};return t&&"3months"===t?o.month:o[e]},e.prototype.getDateTimeFormat=function(e,t){void 0===t&&(t="");var o={hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b"};return t&&"3months"===t?"{value:"+o.month+"}":"{value:"+o[e]+"}"},e.prototype.getHCDefaultConfig=function(o){var i=this,e=o.kpiFormValues&&o.kpiFormValues.groupBySlider,t=o.kpiType&&"SalesDatasKpi"===o.kpiType;return{title:{text:o.title,style:F.defaultsDeep({fontSize:"14px",fontWeight:400,color:p.Colors.black},this.textStyle),align:"right"},chart:{style:{fontFamily:"Lato"},backgroundColor:null,resetZoomButton:{theme:{fill:"white",stroke:p.Colors.black,style:this.textStyle}}},xAxis:"radar"===o.type?{labels:{style:F.defaultsDeep({color:p.Colors.black},this.textStyle)}}:{visible:!o.hideAxis,lineWidth:o.hideAxis?0:1,lineColor:this.lineColor,gridLineWidth:0,gridLineColor:this.gridLineColor,labels:{autoRotation:[-90],padding:10,style:F.defaultsDeep({color:p.Colors.black},this.textStyle),format:t?this.getDateTimeFormat(o.dateGrouping,e):null},max:o.maxX,tickInterval:t?this.getDateTimeIntervalByGroupingDate(o.dateGrouping,e):null},yAxis:"radar"===o.type?{labels:{style:F.defaultsDeep({color:p.Colors.black},this.textStyle)}}:{visible:!o.hideAxis,title:"",lineWidth:o.hideAxis?0:1,lineColor:this.lineColor,gridLineWidth:o.hideAxis?0:1,gridLineColor:this.gridLineColor,labels:{style:F.defaultsDeep({color:p.Colors.black},this.textStyle)},endOnTick:!1,maxPadding:.2,max:o.maxY},colors:this.getPalette(o),legend:{enabled:!1,itemStyle:F.defaultsDeep({fontSize:"14px",lineHeight:"14px",fontWeight:400,color:p.Colors.black},this.textStyle),labelFormatter:function(){var e="";if(this.yData&&0<this.yData.length){var t=0;o.showCumulate?t=F.max(this.yData):o.legendValue&&"sum"!==o.legendValue?"avg"===o.legendValue?t=F.sum(this.yData)/this.yData.length:"min"===o.legendValue?t=F.min(this.yData):"max"===o.legendValue&&(t=F.max(this.yData)):t=F.sum(this.yData),e=this.name+": "+i.decimalPipe.transform(t,i.getNumberFormat(o))}else e=this.y?this.name+": "+i.decimalPipe.transform(this.y,i.getNumberFormat(o)):this.name;return o.unit&&(e+=" "+o.unit),e}},plotOptions:{series:{turboThreshold:0,groupPadding:0,pointPadding:o.pointPadding||(o.colorByPoint?0:.1),stacking:o.stacked,allowPointSelect:o.allowPointSelect||!1,marker:{enabled:!0,states:{select:{fillColor:p.Colors.success}}},states:{select:{color:p.Colors.success}},animation:!this.coreConfig.isWeb(),dataLabels:{color:p.Colors.black}}},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{followTouchMove:!1,style:F.defaultsDeep({},this.textStyle),backgroundColor:p.Colors.stable,borderRadius:0,shadow:!1,borderColor:this.lineColor,useHTML:!1,formatter:function(){var e=(this.series?this.series.name:"")||"";e&&" "!==e&&(e+="<br/>");var t=e+(this.x?(o.groupByDate?v.dateFormat(v.toDate(this.x),"L"):this.x)+": ":this.key+": "||"")+i.decimalPipe.transform(this.y,i.getNumberFormat(o));return"percent"===o.stacked?t+="<br/>"+Math.round(this.percentage)+" %":o.unit&&(t+=" "+o.unit),"scatter"===o.type&&(t+="<br/>"+this.point.name),t}}}},e.prototype.getDataLabelFormatter=function(i){var r=this;return function(){var t=this;if("percent"===i.stacked&&0<this.percentage||"percent"!==i.stacked&&0<=Math.abs(this.y)){var e="percent"===i.stacked?Math.round(this.percentage)+" %":r.decimalPipe.transform(this.y,r.getNumberFormat(i));if(i.unit&&e&&(e+=" "+i.unit),e||(e=""),i.showDelta&&this.series&&F.isArray(this.series.data)){var o=F.findIndex(this.series.data,function(e){return e.x===t.x});if(0<o&&0<Math.abs(this.series.data[o-1].y))e+="<br/><g>("+Math.round(100*(this.series.data[o].y-this.series.data[o-1].y)/this.series.data[o-1].y)+"%)</g>"}return e}return""}},e.prototype.useContrast=function(e){return!0},e.prototype.getDataLabels=function(e){return{enabled:!1!==e.showValues,useHTML:!1,style:F.defaultsDeep({color:p.Colors.black,textOutline:"none"},this.textStyle),formatter:this.getDataLabelFormatter(e)}},e.prototype.getHCDefaultLine=function(e){return{chart:{type:"line",marginTop:10},plotOptions:{line:{dataLabels:this.getDataLabels(e)}}}},e.prototype.getHCDefaultSpline=function(e){return{chart:{type:"spline",marginTop:10},plotOptions:{spline:{dataLabels:this.getDataLabels(e)},series:{marker:{enabled:!0,fillOpacity:.5,fillColor:p.Colors.light,lineWidth:2,lineColor:null}}}}},e.prototype.getHCDefaultArea=function(e){return{chart:{type:"area",marginTop:10},plotOptions:{area:{connectNulls:!1,dataLabels:this.getDataLabels(e)}}}},e.prototype.getHCDefaultAreaSpline=function(e){return{chart:{type:"areaspline",marginTop:30},plotOptions:{areaspline:{connectNulls:!1,dataLabels:this.getDataLabels(e)}}}},e.prototype.getHCDefaultColumn=function(e){return{chart:{type:"column",marginTop:10,marginBottom:(e.showLegend,30)},plotOptions:{column:{borderRadius:0,borderWidth:0,colorByPoint:e.colorByPoint,shadow:!1,dataLabels:this.getDataLabels(e)}}}},e.prototype.getHCDefaultHeatmap=function(e){return{chart:{type:"heatmap",marginTop:10}}},e.prototype.getHCDefaultBar=function(e){return{chart:{type:"bar",marginTop:10},plotOptions:{bar:{borderRadius:0,borderWidth:0,colorByPoint:e.colorByPoint,shadow:!1,dataLabels:this.getDataLabels(e)}}}},e.prototype.getHCDefaultPie=function(e){return{title:{style:{color:"transparent"}},chart:{type:"pie",spacingBottom:10,spacingTop:-20},plotOptions:{pie:{cursor:"pointer",borderWidth:0,dataLabels:{enabled:!1!==e.showValues,useHTML:!1,style:F.defaultsDeep({},this.textStyle),format:"{point.y:.0f} ({point.percentage:.0f} %)",distance:5},showInLegend:!0}}}},e.prototype.getHCDefaultDoughnut=function(e){return F.defaultsDeep({plotOptions:{pie:{startAngle:-90,endAngle:90,center:["50%","75%"],innerSize:"90%"}}},this.getHCDefaultPie(e))},e.prototype.getHCDefaultRadar=function(e){return{chart:{polar:!0,type:"area"},pane:{size:"70%"},yAxis:{gridLineInterpolation:"polygon",labels:{enabled:!1},lineWidth:0},xAxis:{tickmarkPlacement:"on",lineWidth:0}}},e.prototype.getHCDefaultTreemap=function(e){return{chart:{type:"treemap"},colorAxis:{minColor:p.Colors.light,maxColor:this.getPalette(e)[0]}}},e.prototype.getHCDefaultScatter=function(e){return{chart:{type:"scatter",zoomType:"xy"},xAxis:{gridLineWidth:1},plotOptions:{series:{marker:{enabled:!0,fillOpacity:.5}}}}},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:b.Broker},{type:b.DashboardCore},{type:b.Requestor},{type:i.Translate},{type:p.LocalForageService},{type:p.CoreConfig},{type:p.Utils},{type:b.Cache}]},e}(),x="allowInventory == 1",C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),l([b.Editable("CustomModel",{type:v.FormFieldType.text,visible:!1}),u("design:type",String)],t.prototype,"_id",void 0),l([b.Editable("CustomModel",{required:!0,type:v.FormFieldType.text}),b.Searchable("CustomModel"),u("design:type",String)],t.prototype,"title",void 0),l([b.Editable("CustomModel",{required:!0,type:v.FormFieldType.text}),b.Searchable("CustomModel"),u("design:type",String)],t.prototype,"name",void 0),l([b.Editable("CustomModel",{required:!1,type:v.FormFieldType.textarea}),b.Searchable("CustomModel"),u("design:type",String)],t.prototype,"shortDescription",void 0),l([b.Editable("CustomModel",{required:!0,flex:100,type:v.FormFieldType.autocomplete,collectionName:"groups",filters:[[{field:"isRole",operator:{_id:"neq"},value:!0},{field:"type",operator:{_id:"nin"},value:["plan"]}]],hiddenFields:["isRole","type"],idOnly:!0,mapTransform:b.getGroupsTransform,multiple:!0,clearable:!1}),u("design:type",Array)],t.prototype,"group",void 0),l([b.Editable("CustomModel",{type:v.FormFieldType.checkbox,flex:100,title:"INVENTORY",columnDefinition:{width:80}}),u("design:type",Boolean)],t.prototype,"allowInventory",void 0),l([b.Editable("CustomModel",{type:v.FormFieldType.autocomplete,required:!0,condition:x,filters:b.FORM_FILES_IMAGE_FILTER,forceModal:!0,hiddenFields:["mimeType"],mode:"tile",pageSize:20,fixedPosition:!0,maxWidth:750,maxHeight:240,crop:"square",collectionName:"files",title:"BACKGROUND",columnDefinition:{name:"_downloadURL"},filterable:!1,sortable:!1}),u("design:type",Object)],t.prototype,"background",void 0),t=l([b.Model({className:"CustomModel",collectionName:"custommodels",fields:["*"]})],t)}(v.ICustomModel),D=function(){function e(e,t,o,i){this.config=e,this.rq=t,this.broker=o,this.network=i}return e.prototype.registerModel=function(e,t){var o=this,i=t.fields.map(function(e){var t={};return t[e.name]={type:"string"},t});return i.unshift({_id:{type:"string",id:!0,generated:!0}}),t.properties=i,t.permissions="private",this.broker.upsert("custommodels",t).pipe(c.map(function(){o.registerModelForClient(t)}))},e.prototype.registerModelForClient=function(t){if(b.Models.clearCollectionName(t.name),b.Models.setCollectionName(t.name,t.name,["*"],[],null,t.feathersService,C,!0),t.fields&&t.fields.forEach(function(e){e&&(b.Models.addFormField(t.name,e),e.searchable&&b.Models.addSearchableField(t.name,e.name))}),t.appearance)for(var e in t.appearance)t.appearance.hasOwnProperty(e)&&b.Models.addAppearance(t.name,e,t.appearance[e])},e.prototype.registerModelsForClient=function(){var t=this;this.network.isOffline()?this.customModels&&this.customModels.forEach(function(e){t.registerModelForClient(e)}):this.broker.getAll("custommodels",null,null,null,null,null,null,1e4).subscribe(function(e){e.data&&(t.customModels=e.data,e.data.forEach(function(e){t.registerModelForClient(e)}))})},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:b.Config},{type:b.Requestor},{type:b.Broker},{type:p.Network}]},l([p.Persistent("custommodels.offline",!1,null,!0),u("design:type",Array)],e.prototype,"customModels",void 0),e}(),T=[y,t,g,h,f,D],E=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e=[]),{ngModule:t,providers:function o(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}(T,e)}},t.decorators=[{type:r.NgModule,args:[{declarations:[],entryComponents:[],imports:[o.FormsModule,o.ReactiveFormsModule,b.DataCoreModule,i.TranslateModule,p.CommonModule],exports:[o.FormsModule,o.ReactiveFormsModule,b.DataCoreModule,i.TranslateModule,p.CommonModule]}]}],t}(),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),l([b.Editable("CustomFormField",{type:v.FormFieldType.text,required:!0}),u("design:type",String)],t.prototype,"title",void 0),l([b.Editable("CustomFormField",{type:v.FormFieldType.textarea}),u("design:type",String)],t.prototype,"description",void 0),l([b.Editable("CustomFormField",{type:v.FormFieldType.autocomplete,multiple:!0,required:!0,idAttributeName:"name",displayType:"formfield"}),u("design:type",Array)],t.prototype,"fields",void 0),l([b.Editable("CustomFormField",{title:"GROUPS",type:v.FormFieldType.autocomplete,collectionName:"groups",filters:[[{field:"isRole",operator:{_id:"neq"},value:!0},{field:"type",operator:{_id:"nin"},value:["plan"]}]],hiddenFields:["isRole","type"],idOnly:!0,mapTransform:b.getGroupsTransform,multiple:!0,clearable:!1,required:!0,allowCustomTag:!0,tag:!1}),u("design:type",String)],t.prototype,"group",void 0),t=l([b.Model({className:"CustomFormField",collectionName:"customFormFields",fields:["*"],include:[]})],t)}(b.Entity),O={isNotInformation:'type!="information"',isNotInformationOrTask:'type!="information" and type!="task"',isNotInformationOrDocumentOrImage:'type!="information" and type!="image" and type!="document"',isInformation:'type=="information"',isVideoplayer:'type=="videoplayer"',isAutocomplete:'type=="autocomplete"',isCatalog:'type=="catalog"',isImage:'type=="image"',isDocument:'type=="document"',isPhoto:'type=="photo" or type=="multiphotos"',isMultiPhotos:'type=="multiphotos"',isImageRecognition:"isImageRecognition==1",hasAllowLibrary:'type=="photo" or type=="video" or type=="multiphotos" or type=="todo"',isPhotoOrVideo:'type=="photo" or type=="video" or type=="multiphotos"',isEmailReport:'type=="emailreport"',isSelect:'type=="select"',isSelectImage:'type=="selectimage"',isAdress:'type=="address"',isNumber:'type=="number"',isDate:'type=="date"',isTodo:'type=="todo"',isNumberOrRange:'type=="number" or type=="range" or type=="knob"',isNumberOrRangeOrStarrating:'type=="number" or type=="range" or type=="starrating"or type=="knob"',isStarRating:'type=="starrating"',isAudioOrVideo:'type=="audio" or type=="video"',isConnect:'type == "connect"',isGame:'type == "game"',isFormula:'type=="formula"',hasValues:'type=="todo" or type=="photo" or type=="multiphotos" or type=="ranking" or type=="select" or type=="selectmulti" or type=="selectbuttons" or type=="selectchat" or type=="selectbuttonsmulti" or type=="autocomplete" or type=="emailreport" or type=="selectimage" or type=="missingword" or type=="swipeselect" or type=="game"',missionIsQuizz:{type:"missionDescriptionAttribute",key:"quizz",value:!0},hasSentence:'type=="missingword" or type=="swipeselect" or type=="selectchat"',hasMultiple:'type=="autocomplete" or type=="selectchat" or type=="selectimage" ',isReadOnly:"readonly == 1"},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),l([b.Editable("FormField",{type:v.FormFieldType.text,visible:!1}),u("design:type",String)],t.prototype,"name",void 0),l([b.Editable("FormField",{type:v.FormFieldType.text,required:!0}),u("design:type",String)],t.prototype,"title",void 0),l([b.Editable("FormField",{title:"INSTRUCTIONS",type:v.FormFieldType.textarea,condition:O.isNotInformation,language:"html"}),u("design:type",String)],t.prototype,"description",void 0),l([b.Editable("FormField",{title:"VALUE",required:!0,type:v.FormFieldType.textarea,condition:O.isInformation,language:"html"}),u("design:type",Object)],t.prototype,"value",void 0),l([b.Editable("FormField",{title:"URL",required:!0,type:v.FormFieldType.text,condition:O.isVideoplayer}),u("design:type",Object)],t.prototype,"url",void 0),l([b.Editable("FormField",{title:"SENTENCE",type:v.FormFieldType.textarea,condition:O.hasSentence}),u("design:type",Object)],t.prototype,"sentence",void 0),l([b.Editable("FormField",{title:"FORMULA",type:v.FormFieldType.textarea,condition:O.isFormula}),u("design:type",Object)],t.prototype,"formula",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,required:!0,values:F.map(v.MOBILE_FORM_FIELDS_ALL,"type"),translate:!0}),u("design:type",String)],t.prototype,"type",void 0),l([b.Editable("FormField",{title:"GAME",type:v.FormFieldType.autocomplete,values:["runner-game","memory-card-game"],translate:!0,condition:O.isGame,required:!0}),u("design:type",String)],t.prototype,"game",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,required:!0,collectionName:"catalogs",idOnly:!0,condition:O.isCatalog}),u("design:type",String)],t.prototype,"catalog",void 0),l([b.Editable("FormField",{type:v.FormFieldType.checkbox,condition:[O.isCatalog,"presence != 1"],advanced:!0}),u("design:type",Boolean)],t.prototype,"inventory",void 0),l([b.Editable("FormField",{type:v.FormFieldType.checkbox,condition:[O.isCatalog,"inventory != 1"],advanced:!0}),u("design:type",Boolean)],t.prototype,"presence",void 0),l([b.Editable("FormField",{title:"CUSTOMMODEL",type:v.FormFieldType.autocomplete,collectionName:"custommodels",idAttributeName:"name",idOnly:!0,condition:O.isAutocomplete,advanced:!0}),u("design:type",String)],t.prototype,"collectionName",void 0),l([b.Editable("FormField",{type:v.FormFieldType.toggle,condition:O.isAutocomplete,advanced:!0}),u("design:type",Boolean)],t.prototype,"filterByLocation",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.hasValues}),u("design:type",Array)],t.prototype,"values",void 0),l([b.Editable("FormField",{title:"MODE",type:v.FormFieldType.autocomplete,values:["dragndrop","drawing"],translate:!0,condition:O.isConnect,required:!0}),u("design:type",String)],t.prototype,"connectMode",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.isConnect}),u("design:type",Array)],t.prototype,"leftValues",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.isConnect}),u("design:type",Array)],t.prototype,"rightValues",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.isGame}),u("design:type",Array)],t.prototype,"correctValues",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.isGame}),u("design:type",Array)],t.prototype,"wrongValues",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,collectionName:"user",multiple:!0,required:!1,tag:!0,condition:[O.isTodo],advanced:!0}),u("design:type",Array)],t.prototype,"userTags",void 0),l([b.Editable("FormField",{title:"IMAGE",type:v.FormFieldType.autocomplete,filters:b.FORM_FILES_IMAGE_FILTER,forceModal:!0,hiddenFields:["mimeType"],mode:"tile",pageSize:20,fixedPosition:!0,collectionName:"files",condition:O.isImage,columnDefinition:{name:"_filename"}}),u("design:type",Object)],t.prototype,"image",void 0),l([b.Editable("FormField",{title:"IMAGE",type:v.FormFieldType.autocomplete,multiple:!0,filters:b.FORM_FILES_IMAGE_FILTER,forceModal:!0,hiddenFields:["mimeType"],mode:"tile",pageSize:20,fixedPosition:!0,collectionName:"files",condition:O.isSelectImage,columnDefinition:{name:"_filename"}}),u("design:type",Object)],t.prototype,"images",void 0),l([b.Editable("FormField",{title:"DOCUMENT",type:v.FormFieldType.autocomplete,collectionName:"files",condition:O.isDocument,columnDefinition:{name:"_filename"}}),u("design:type",Object)],t.prototype,"document",void 0),l([b.Editable("FormField",{type:v.FormFieldType.checkbox,condition:O.hasMultiple}),u("design:type",Boolean)],t.prototype,"multiple",void 0),l([b.Editable("FormField",{title:"BUTTONS",type:v.FormFieldType.checkbox,condition:O.isStarRating}),u("design:type",Boolean)],t.prototype,"useButtons",void 0),l([b.Editable("FormField",{title:"MODE",type:v.FormFieldType.autocomplete,values:["youtube","url"],translate:!0,condition:O.isVideoplayer,required:!0}),u("design:type",String)],t.prototype,"mode",void 0),l([b.Editable("FormField",{visible:!1,type:v.FormFieldType.autocomplete,tag:!0,multiple:!0,allowCustomTag:!0,condition:O.missionIsQuizz,dynamicValues:"values"}),u("design:type",Array)],t.prototype,"answer",void 0),l([b.Editable("FormField",{visible:!1,type:v.FormFieldType.textarea,condition:O.missionIsQuizz}),u("design:type",String)],t.prototype,"explanation",void 0),l([b.Editable("FormField",{title:"EXPLANATIONDOCUMENT",type:v.FormFieldType.autocomplete,collectionName:"files",condition:O.missionIsQuizz,columnDefinition:{name:"_filename"}}),u("design:type",Object)],t.prototype,"explanationDocument",void 0),l([b.Editable("FormField",{type:v.FormFieldType.number,condition:[O.isMultiPhotos],flex:50,externalValidators:[{externalFieldName:"maxPhotos",rule:"lower"}]}),u("design:type",Number)],t.prototype,"minPhotos",void 0),l([b.Editable("FormField",{type:v.FormFieldType.number,condition:[O.isMultiPhotos],flex:50,required:!0,externalValidators:[{externalFieldName:"minPhotos",rule:"higher"}]}),u("design:type",Number)],t.prototype,"maxPhotos",void 0),l([b.Editable("FormField",{title:"MANDATORY",type:v.FormFieldType.checkbox,condition:O.isNotInformationOrDocumentOrImage,flex:50}),u("design:type",Boolean)],t.prototype,"required",void 0),l([b.Editable("FormField",{title:"ALLOWCOMMENTS",type:v.FormFieldType.checkbox,condition:O.isNotInformation,flex:50}),u("design:type",Boolean)],t.prototype,"allowComments",void 0),l([b.Editable("FormField",{title:"AUTORELOAD",type:v.FormFieldType.checkbox,condition:O.isNotInformation,flex:50}),u("design:type",Boolean)],t.prototype,"autoreload",void 0),l([b.Editable("FormField",{title:"ALLOWTASK",type:v.FormFieldType.checkbox,condition:[O.isNotInformationOrTask,b.ROLES_CONDITIONS.hasTodo],flex:50}),u("design:type",Boolean)],t.prototype,"allowTask",void 0),l([b.Editable("FormField",{title:"SHARETOFEED",type:v.FormFieldType.checkbox,flex:50,condition:[O.isPhoto]}),u("design:type",Boolean)],t.prototype,"shareToFeed",void 0),l([b.Editable("FormField",{title:"ALLPHOTOSREQUIRED",type:v.FormFieldType.checkbox,flex:100,condition:[O.isTodo]}),u("design:type",Boolean)],t.prototype,"allPhotosRequired",void 0),l([b.Editable("FormField",{type:v.FormFieldType.checkbox,condition:O.isAutocomplete,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"clearable",void 0),l([b.Editable("FormField",{title:"ALLOWTIME",type:v.FormFieldType.checkbox,condition:[O.isNotInformation],flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"allowTime",void 0),l([b.Editable("FormField",{title:"ALLOWLIBRARY",type:v.FormFieldType.checkbox,condition:O.hasAllowLibrary,flex:100}),u("design:type",Boolean)],t.prototype,"allowLibrary",void 0),l([b.Editable("FormField",{title:"GEOLOC",type:v.FormFieldType.checkbox,condition:O.isPhotoOrVideo,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"saveGeoloc",void 0),l([b.Editable("FormField",{title:"ALLOWHISTORY",type:v.FormFieldType.checkbox,condition:[b.ROLES_CONDITIONS.hasTodoOrScore],flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"allowHistory",void 0),l([b.Editable("FormField",{title:"ALLOWOPENDETAILS",type:v.FormFieldType.checkbox,flex:100,condition:O.isSelectImage,advanced:!0}),u("design:type",Boolean)],t.prototype,"allowOpenDetails",void 0),l([b.Editable("FormField",{title:"LINKTOPREVIOUSQUESTION",type:v.FormFieldType.checkbox,flex:100,condition:[O.isTodo],advanced:!0}),u("design:type",Boolean)],t.prototype,"linked",void 0),l([b.Editable("FormField",{title:"ALLOWANNOTATE",type:v.FormFieldType.checkbox,condition:[O.isPhoto],flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"allowAnnotate",void 0),l([b.Editable("FormField",{title:"SHOWUSERSEMAIL",type:v.FormFieldType.checkbox,condition:O.isEmailReport,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"showUsers",void 0),l([b.Editable("FormField",{title:"HIDEMOBILE",type:v.FormFieldType.checkbox,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"hideMobile",void 0),l([b.Editable("FormField",{title:"OTHER1",type:v.FormFieldType.checkbox,condition:O.isSelect,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"allowOther",void 0),l([b.Editable("FormField",{type:v.FormFieldType.checkbox,flex:100,advanced:!0}),u("design:type",Boolean)],t.prototype,"readonly",void 0),l([b.Editable("FormField",{title:"RADIUS",type:v.FormFieldType.number,condition:O.isAdress,flex:100,advanced:!0}),u("design:type",Number)],t.prototype,"radius",void 0),l([b.Editable("FormField",{title:"MIN",type:v.FormFieldType.number,condition:O.isNumberOrRange,flex:100,advanced:!1,externalValidators:[{externalFieldName:"max",rule:"lower"}]}),u("design:type",Number)],t.prototype,"min",void 0),l([b.Editable("FormField",{title:"MAX",type:v.FormFieldType.number,condition:O.isNumberOrRangeOrStarrating,flex:100,advanced:!1,externalValidators:[{externalFieldName:"min",rule:"higher"}]}),u("design:type",Number)],t.prototype,"max",void 0),l([b.Editable("FormField",{title:"STEP",type:v.FormFieldType.number,condition:O.isNumber,flex:100,advanced:!0}),u("design:type",Number)],t.prototype,"step",void 0),l([b.Editable("FormField",{title:"MIN",type:v.FormFieldType.date,condition:O.isDate,flex:100,advanced:!0}),u("design:type",Date)],t.prototype,"minDate",void 0),l([b.Editable("FormField",{title:"MAX",type:v.FormFieldType.date,condition:O.isDate,flex:100,advanced:!0}),u("design:type",Date)],t.prototype,"maxDate",void 0),l([b.Editable("FormField",{title:"SHOWSERVICE",type:v.FormFieldType.checkbox,flex:100,condition:b.ROLES_CONDITIONS.hasService,advanced:!0}),u("design:type",Boolean)],t.prototype,"showService",void 0),l([b.Editable("FormField",{type:v.FormFieldType.number,condition:[O.isPhoto],flex:100,advanced:!0}),u("design:type",Number)],t.prototype,"maxWidth",void 0),l([b.Editable("FormField",{type:v.FormFieldType.number,condition:[O.isPhoto],flex:100,advanced:!0}),u("design:type",Number)],t.prototype,"maxHeight",void 0),l([b.Editable("FormField",{type:v.FormFieldType.toggle,condition:[O.isPhoto,b.ROLES_CONDITIONS.isAdmin],flex:100,title:"PHOTOLIVECOUNTER",advanced:!0}),u("design:type",Boolean)],t.prototype,"isImageRecognition",void 0),l([b.Editable("FormField",{type:v.FormFieldType.toggle,condition:[O.isImageRecognition,b.ROLES_CONDITIONS.isAdmin],flex:100,title:"BACKGROUNDPROCESS",advanced:!0,translate:!0}),u("design:type",Boolean)],t.prototype,"isBackgroundProcess",void 0),l([b.Editable("FormField",{title:"DONTSAVEIFHIDDEN",type:v.FormFieldType.checkbox,flex:100,advanced:!0,condition:O.isReadOnly}),u("design:type",Boolean)],t.prototype,"dontSaveIfHidden",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,required:!0,collectionName:"algorithm",condition:O.isImageRecognition,flex:100,title:"ALGORITHM",advanced:!0}),u("design:type",Object)],t.prototype,"imageRecognitionAlgorithm",void 0),l([b.Editable("FormField",{type:v.FormFieldType.json,title:"DISPLAY",condition:O.isImageRecognition,filterable:!1,sortable:!1,suppressExport:!0,advanced:!0}),u("design:type",Object)],t.prototype,"imageRecognitionDisplay",void 0),l([b.Editable("FormField",{title:"DURATIONMAX",type:v.FormFieldType.number,condition:O.isAudioOrVideo,flex:100,max:60}),u("design:type",Number)],t.prototype,"duration",void 0),l([b.Editable("FormField",{type:v.FormFieldType.autocomplete,multiple:!0,clearable:!0,advanced:!0}),u("design:type",Array)],t.prototype,"condition",void 0),l([b.Editable("FormField",{title:"FLEX",type:v.FormFieldType.number,flex:100,min:0,max:100,advanced:!0}),u("design:type",Number)],t.prototype,"flex",void 0),l([b.Editable("FormField",{title:"LEGEND",type:v.FormFieldType.textarea,condition:O.isNotInformation,advanced:!0}),u("design:type",String)],t.prototype,"caption",void 0),l([b.Editable("FormField",{title:"REPORTORDER",type:v.FormFieldType.number,condition:[b.ROLES_CONDITIONS.hasTodoOrScore],flex:100,min:0,advanced:!0}),u("design:type",Number)],t.prototype,"reportOrder",void 0),t=l([b.Model({className:"FormField"})],t)}(b.Entity),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),l([b.Editable("GridState",{required:!0,type:v.FormFieldType.text}),b.Searchable("GridState"),u("design:type",String)],t.prototype,"title",void 0),l([b.Editable("GridState",{required:!0,title:"DESCRIPTION",type:v.FormFieldType.textarea}),b.Searchable("GridState"),u("design:type",String)],t.prototype,"description",void 0),l([b.Editable("GridState",{title:"GROUPS",type:v.FormFieldType.autocomplete,collectionName:"groups",filters:[[{field:"isRole",operator:{_id:"neq"},value:!0},{field:"type",operator:{_id:"nin"},value:["plan"]}]],hiddenFields:["isRole","type"],idOnly:!0,mapTransform:b.getGroupsTransform,multiple:!0}),u("design:type",Object)],t.prototype,"group",void 0),t=l([b.Model({className:"GridState",collectionName:"gridstate",fields:["*"],include:[]})],t)}(b.Entity);e.DataFormModule=E,e.CustomFormField=A,e.FormField=S,e.GridState=R,e.CustomModel=C,e.CellRenderer=y,e.Chart=f,e.FormDynamicBuilder=g,e.Conditions=t,e.Mapping=h,e.CustomModels=D,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=data-form.umd.min.js.map